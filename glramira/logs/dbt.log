[0m17:00:40.508773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67919a8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67918961d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67916e9590>]}


============================== 17:00:40.513407 | ba8ca7b2-9897-4a1f-b426-a698a0b7ce8c ==============================
[0m17:00:40.513407 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:40.514255 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt ', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False'}
[0m17:00:40.673904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba8ca7b2-9897-4a1f-b426-a698a0b7ce8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6791cd0390>]}
[0m17:00:40.717608 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:40.718881 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:40.720485 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.29399908, "process_in_blocks": "328", "process_kernel_time": 0.371886, "process_mem_max_rss": "102352", "process_out_blocks": "232", "process_user_time": 2.247825}
[0m17:00:40.721284 [debug] [MainThread]: Command `cli deps` succeeded at 17:00:40.721093 after 0.30 seconds
[0m17:00:40.721853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67919a8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6795a1d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6795a1d150>]}
[0m17:00:40.722447 [debug] [MainThread]: Flushing usage events
[0m17:00:40.948952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:04.650292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc28fd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbfd3f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbfce2a90>]}


============================== 17:11:04.654807 | be9d4073-55dd-47fd-a17b-b8e9dd4cf569 ==============================
[0m17:11:04.654807 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:04.655715 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'debug': 'False'}
[0m17:11:04.667226 [info ] [MainThread]: dbt version: 1.10.13
[0m17:11:04.668042 [info ] [MainThread]: python version: 3.11.2
[0m17:11:04.668607 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m17:11:04.669159 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m17:11:07.912835 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m17:11:07.913870 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m17:11:07.914346 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m17:11:07.914818 [info ] [MainThread]: adapter type: bigquery
[0m17:11:07.915261 [info ] [MainThread]: adapter version: 1.10.2
[0m17:11:08.066590 [info ] [MainThread]: Configuration:
[0m17:11:08.067346 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:11:08.067889 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:11:08.068387 [info ] [MainThread]: Required dependencies:
[0m17:11:08.068856 [debug] [MainThread]: Executing "git --help"
[0m17:11:08.071571 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:11:08.072281 [debug] [MainThread]: STDERR: "b''"
[0m17:11:08.072750 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:11:08.073244 [info ] [MainThread]: Connection:
[0m17:11:08.074010 [info ] [MainThread]:   method: service-account
[0m17:11:08.074643 [info ] [MainThread]:   database: project-data-engineer-469310
[0m17:11:08.075205 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m17:11:08.075689 [info ] [MainThread]:   schema: dbt_glramira
[0m17:11:08.076147 [info ] [MainThread]:   location: US
[0m17:11:08.076639 [info ] [MainThread]:   priority: interactive
[0m17:11:08.077106 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:11:08.077552 [info ] [MainThread]:   impersonate_service_account: None
[0m17:11:08.078094 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:11:08.078532 [info ] [MainThread]:   job_retries: 1
[0m17:11:08.079036 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:11:08.079636 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:11:08.080148 [info ] [MainThread]:   timeout_seconds: 300
[0m17:11:08.080587 [info ] [MainThread]:   client_id: None
[0m17:11:08.081052 [info ] [MainThread]:   token_uri: None
[0m17:11:08.081485 [info ] [MainThread]:   compute_region: None
[0m17:11:08.081932 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:11:08.082359 [info ] [MainThread]:   gcs_bucket: None
[0m17:11:08.082777 [info ] [MainThread]:   dataproc_batch: None
[0m17:11:08.083520 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:11:08.297915 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:11:08.298608 [debug] [MainThread]: On debug: select 1 as id
[0m17:11:08.299206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:08.299846 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/home/quakinh943/dbt_glamira_prod project-data-engineer-469310-98e0c9323b28.json''
[0m17:11:08.300445 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m17:11:08.300932 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/home/quakinh943/dbt_glamira_prod project-data-engineer-469310-98e0c9323b28.json'
[0m17:11:08.301438 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:11:08.301993 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:11:08.302496 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:11:08.303857 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 3.7277398, "process_in_blocks": "0", "process_kernel_time": 0.63373, "process_mem_max_rss": "380704", "process_out_blocks": "24", "process_user_time": 5.417096}
[0m17:11:08.304861 [debug] [MainThread]: Command `dbt debug` failed at 17:11:08.304706 after 3.73 seconds
[0m17:11:08.305432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbfd3f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbfd3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc24d3e90>]}
[0m17:11:08.305991 [debug] [MainThread]: Flushing usage events
[0m17:11:08.504715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:19.919656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fbe1cdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fbe1cd4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fbe1cda50>]}


============================== 17:29:19.924147 | fd31f679-7ffa-4ce7-88bc-e808c16e4a49 ==============================
[0m17:29:19.924147 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:19.925041 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'fail_fast': 'False', 'empty': 'None', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True'}
[0m17:29:19.936355 [info ] [MainThread]: dbt version: 1.10.13
[0m17:29:19.937030 [info ] [MainThread]: python version: 3.11.2
[0m17:29:19.937562 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m17:29:19.938024 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m17:29:23.218240 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m17:29:23.219231 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m17:29:23.219777 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m17:29:23.220297 [info ] [MainThread]: adapter type: bigquery
[0m17:29:23.220767 [info ] [MainThread]: adapter version: 1.10.2
[0m17:29:23.369342 [info ] [MainThread]: Configuration:
[0m17:29:23.370039 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:29:23.370562 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:29:23.371043 [info ] [MainThread]: Required dependencies:
[0m17:29:23.371640 [debug] [MainThread]: Executing "git --help"
[0m17:29:23.374400 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:29:23.375046 [debug] [MainThread]: STDERR: "b''"
[0m17:29:23.375557 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:29:23.376076 [info ] [MainThread]: Connection:
[0m17:29:23.376724 [info ] [MainThread]:   method: service-account
[0m17:29:23.377302 [info ] [MainThread]:   database: project-data-engineer-469310
[0m17:29:23.378067 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m17:29:23.378579 [info ] [MainThread]:   schema: dbt_glramira
[0m17:29:23.379082 [info ] [MainThread]:   location: US
[0m17:29:23.379652 [info ] [MainThread]:   priority: interactive
[0m17:29:23.380186 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:29:23.380717 [info ] [MainThread]:   impersonate_service_account: None
[0m17:29:23.381296 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:29:23.381836 [info ] [MainThread]:   job_retries: 1
[0m17:29:23.382456 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:29:23.383030 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:29:23.383640 [info ] [MainThread]:   timeout_seconds: 300
[0m17:29:23.384199 [info ] [MainThread]:   client_id: None
[0m17:29:23.384797 [info ] [MainThread]:   token_uri: None
[0m17:29:23.385382 [info ] [MainThread]:   compute_region: None
[0m17:29:23.386012 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:29:23.386589 [info ] [MainThread]:   gcs_bucket: None
[0m17:29:23.387092 [info ] [MainThread]:   dataproc_batch: None
[0m17:29:23.387916 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:29:23.639801 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:29:23.640542 [debug] [MainThread]: On debug: select 1 as id
[0m17:29:23.641045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:23.641624 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/home/quakinh943/dbt_glamira_prod project-data-engineer-469310-98e0c9323b28.json''
[0m17:29:23.642164 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m17:29:23.642577 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/home/quakinh943/dbt_glamira_prod project-data-engineer-469310-98e0c9323b28.json'
[0m17:29:23.643008 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:29:23.643494 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:29:23.643934 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:29:23.645323 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 3.8018367, "process_in_blocks": "0", "process_kernel_time": 0.742876, "process_mem_max_rss": "380756", "process_out_blocks": "24", "process_user_time": 5.407659}
[0m17:29:23.646365 [debug] [MainThread]: Command `dbt debug` failed at 17:29:23.646168 after 3.80 seconds
[0m17:29:23.646967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fbe1cd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9e9c4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fbe78e7d0>]}
[0m17:29:23.647624 [debug] [MainThread]: Flushing usage events
[0m17:29:23.843826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:57.723392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f95e29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f963d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f963ea10>]}


============================== 17:30:57.728035 | 9ce9d34d-0ad2-4333-ae43-1b9580d56b54 ==============================
[0m17:30:57.728035 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:30:57.728867 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True'}
[0m17:30:57.740049 [info ] [MainThread]: dbt version: 1.10.13
[0m17:30:57.740770 [info ] [MainThread]: python version: 3.11.2
[0m17:30:57.741352 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m17:30:57.741958 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m17:31:00.993461 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m17:31:00.994479 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m17:31:00.995070 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m17:31:00.995623 [info ] [MainThread]: adapter type: bigquery
[0m17:31:00.996132 [info ] [MainThread]: adapter version: 1.10.2
[0m17:31:01.150642 [info ] [MainThread]: Configuration:
[0m17:31:01.151426 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:01.151982 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:01.152459 [info ] [MainThread]: Required dependencies:
[0m17:31:01.152964 [debug] [MainThread]: Executing "git --help"
[0m17:31:01.155647 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:31:01.156340 [debug] [MainThread]: STDERR: "b''"
[0m17:31:01.156797 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:31:01.157300 [info ] [MainThread]: Connection:
[0m17:31:01.157898 [info ] [MainThread]:   method: service-account
[0m17:31:01.158381 [info ] [MainThread]:   database: project-data-engineer-469310
[0m17:31:01.158893 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m17:31:01.159461 [info ] [MainThread]:   schema: dbt_glramira
[0m17:31:01.159932 [info ] [MainThread]:   location: US
[0m17:31:01.160430 [info ] [MainThread]:   priority: interactive
[0m17:31:01.160881 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:31:01.161331 [info ] [MainThread]:   impersonate_service_account: None
[0m17:31:01.161785 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:31:01.162262 [info ] [MainThread]:   job_retries: 1
[0m17:31:01.162719 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:31:01.163198 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:31:01.163765 [info ] [MainThread]:   timeout_seconds: 300
[0m17:31:01.164241 [info ] [MainThread]:   client_id: None
[0m17:31:01.164701 [info ] [MainThread]:   token_uri: None
[0m17:31:01.165165 [info ] [MainThread]:   compute_region: None
[0m17:31:01.165690 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:31:01.166157 [info ] [MainThread]:   gcs_bucket: None
[0m17:31:01.166675 [info ] [MainThread]:   dataproc_batch: None
[0m17:31:01.167393 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:31:01.397621 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:31:01.398300 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:01.398917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:02.484117 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:c8760c8f-2ac8-4073-93c7-761abfcbb840&page=queryresults
[0m17:31:02.955437 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:31:02.956263 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:31:02.957791 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.307279, "process_in_blocks": "1640", "process_kernel_time": 0.791322, "process_mem_max_rss": "389464", "process_out_blocks": "280", "process_user_time": 5.551516}
[0m17:31:02.958552 [debug] [MainThread]: Command `dbt debug` succeeded at 17:31:02.958358 after 5.31 seconds
[0m17:31:02.959077 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:02.959683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f95e1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d9bae9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f95da590>]}
[0m17:31:02.960546 [debug] [MainThread]: Flushing usage events
[0m17:31:03.167700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:44.546537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31750fa010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31750fa050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31750f9f10>]}


============================== 17:32:44.550933 | cf73d7b3-8f81-43af-996a-64719de68ef9 ==============================
[0m17:32:44.550933 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:32:44.551773 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt debug'}
[0m17:32:44.563061 [info ] [MainThread]: dbt version: 1.10.13
[0m17:32:44.563787 [info ] [MainThread]: python version: 3.11.2
[0m17:32:44.564313 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m17:32:44.564765 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m17:32:47.962436 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m17:32:47.963484 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m17:32:47.964060 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m17:32:47.964580 [info ] [MainThread]: adapter type: bigquery
[0m17:32:47.965074 [info ] [MainThread]: adapter version: 1.10.2
[0m17:32:48.112503 [info ] [MainThread]: Configuration:
[0m17:32:48.113269 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:32:48.113846 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:32:48.114380 [info ] [MainThread]: Required dependencies:
[0m17:32:48.114949 [debug] [MainThread]: Executing "git --help"
[0m17:32:48.117815 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:32:48.118545 [debug] [MainThread]: STDERR: "b''"
[0m17:32:48.119042 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:32:48.119759 [info ] [MainThread]: Connection:
[0m17:32:48.120440 [info ] [MainThread]:   method: service-account
[0m17:32:48.120970 [info ] [MainThread]:   database: project-data-engineer-469310
[0m17:32:48.121483 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m17:32:48.122024 [info ] [MainThread]:   schema: dbt_glramira
[0m17:32:48.122534 [info ] [MainThread]:   location: US
[0m17:32:48.123050 [info ] [MainThread]:   priority: interactive
[0m17:32:48.123586 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:32:48.124103 [info ] [MainThread]:   impersonate_service_account: None
[0m17:32:48.124640 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:32:48.125164 [info ] [MainThread]:   job_retries: 1
[0m17:32:48.125659 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:32:48.126282 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:32:48.126854 [info ] [MainThread]:   timeout_seconds: 300
[0m17:32:48.127302 [info ] [MainThread]:   client_id: None
[0m17:32:48.127783 [info ] [MainThread]:   token_uri: None
[0m17:32:48.128238 [info ] [MainThread]:   compute_region: None
[0m17:32:48.128703 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:32:48.129163 [info ] [MainThread]:   gcs_bucket: None
[0m17:32:48.129587 [info ] [MainThread]:   dataproc_batch: None
[0m17:32:48.130286 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:32:48.345376 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:32:48.346058 [debug] [MainThread]: On debug: select 1 as id
[0m17:32:48.346553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:48.799484 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:c4073d73-ab23-4697-9b8a-b781cf848319&page=queryresults
[0m17:32:49.128316 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:32:49.129083 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:32:49.130583 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.6576943, "process_in_blocks": "0", "process_kernel_time": 0.842765, "process_mem_max_rss": "386888", "process_out_blocks": "32", "process_user_time": 5.614834}
[0m17:32:49.131331 [debug] [MainThread]: Command `dbt debug` succeeded at 17:32:49.131156 after 4.66 seconds
[0m17:32:49.131894 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:32:49.132485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31792f7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31750fab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315567f090>]}
[0m17:32:49.133103 [debug] [MainThread]: Flushing usage events
[0m17:32:49.334832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:28.794149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9804eae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9804ebe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9804ead90>]}


============================== 17:33:28.798500 | 98f13769-b4ac-4101-9c58-0dcf99d25eb6 ==============================
[0m17:33:28.798500 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:33:28.799417 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None'}
[0m17:33:32.240538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa960a04a10>]}
[0m17:33:32.327097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9830c1450>]}
[0m17:33:32.328283 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:33:32.565264 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:33:32.566392 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:33:32.567069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa960a7d250>]}
[0m17:33:34.274536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9606614d0>]}
[0m17:33:34.382212 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:33:34.384964 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:33:34.415555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95bc22150>]}
[0m17:33:34.416363 [info ] [MainThread]: Found 2 models, 4 data tests, 495 macros
[0m17:33:34.417079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa960512dd0>]}
[0m17:33:34.419440 [info ] [MainThread]: 
[0m17:33:34.419962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:34.420411 [info ] [MainThread]: 
[0m17:33:34.421194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:34.427856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:33:34.428701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:34.914978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now create_project-data-engineer-469310_dbt_glramira)
[0m17:33:34.916052 [debug] [ThreadPool]: Creating schema "database: "project-data-engineer-469310"
schema: "dbt_glramira"
"
[0m17:33:34.928775 [debug] [ThreadPool]: On create_project-data-engineer-469310_dbt_glramira: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "connection_name": "create_project-data-engineer-469310_dbt_glramira"} */
create schema if not exists `project-data-engineer-469310`.`dbt_glramira`
  
[0m17:33:34.929470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:35.376438 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:19fae716-a136-478e-bcc6-e549369ec22f&page=queryresults
[0m17:33:36.241840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m17:33:36.242667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:36.543074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95bc0c810>]}
[0m17:33:36.544042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:36.552445 [debug] [Thread-1 (]: Began running node model.glramira.my_first_dbt_model
[0m17:33:36.553363 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_glramira.my_first_dbt_model .................... [RUN]
[0m17:33:36.554239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.my_first_dbt_model)
[0m17:33:36.554789 [debug] [Thread-1 (]: Began compiling node model.glramira.my_first_dbt_model
[0m17:33:36.564739 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.my_first_dbt_model"
[0m17:33:36.565860 [debug] [Thread-1 (]: Began executing node model.glramira.my_first_dbt_model
[0m17:33:36.601878 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.my_first_dbt_model"
[0m17:33:36.603602 [debug] [Thread-1 (]: On model.glramira.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_first_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`my_first_dbt_model`
  OPTIONS()
  as select 1 as id, 'hello_dbt' as message;


[0m17:33:36.604554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:37.023803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:492a6eab-fa3c-4c22-95a5-2f87f26a432e&page=queryresults
[0m17:33:37.366128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa960bded50>]}
[0m17:33:37.367420 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_glramira.my_first_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m17:33:37.368453 [debug] [Thread-1 (]: Finished running node model.glramira.my_first_dbt_model
[0m17:33:37.369657 [debug] [Thread-3 (]: Began running node model.glramira.my_second_dbt_model
[0m17:33:37.370496 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_glramira.my_second_dbt_model ................... [RUN]
[0m17:33:37.371766 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.glramira.my_second_dbt_model'
[0m17:33:37.372333 [debug] [Thread-3 (]: Began compiling node model.glramira.my_second_dbt_model
[0m17:33:37.377197 [debug] [Thread-3 (]: Writing injected SQL for node "model.glramira.my_second_dbt_model"
[0m17:33:37.378069 [debug] [Thread-3 (]: Began executing node model.glramira.my_second_dbt_model
[0m17:33:37.382617 [debug] [Thread-3 (]: Writing runtime sql for node "model.glramira.my_second_dbt_model"
[0m17:33:37.383681 [debug] [Thread-3 (]: On model.glramira.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_second_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `project-data-engineer-469310`.`dbt_glramira`.`my_first_dbt_model`
where id = 1;


[0m17:33:37.384407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:33:37.868296 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:c4a44e46-bee3-4b78-a9bc-31a459b0f6d2&page=queryresults
[0m17:33:38.183402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f13769-b4ac-4101-9c58-0dcf99d25eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa960527290>]}
[0m17:33:38.184676 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_glramira.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m17:33:38.185626 [debug] [Thread-3 (]: Finished running node model.glramira.my_second_dbt_model
[0m17:33:38.188180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:38.190827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:38.191418 [debug] [MainThread]: Connection 'create_project-data-engineer-469310_dbt_glramira' was properly closed.
[0m17:33:38.191912 [debug] [MainThread]: Connection 'model.glramira.my_first_dbt_model' was properly closed.
[0m17:33:38.192470 [debug] [MainThread]: Connection 'model.glramira.my_second_dbt_model' was properly closed.
[0m17:33:38.193144 [info ] [MainThread]: 
[0m17:33:38.193731 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m17:33:38.194922 [debug] [MainThread]: Command end result
[0m17:33:38.228143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:33:38.230833 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:33:38.238636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:33:38.239241 [info ] [MainThread]: 
[0m17:33:38.239865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:38.240419 [info ] [MainThread]: 
[0m17:33:38.240963 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:33:38.242451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.539999, "process_in_blocks": "2320", "process_kernel_time": 0.831903, "process_mem_max_rss": "406284", "process_out_blocks": "3232", "process_user_time": 8.013318}
[0m17:33:38.243117 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:38.242953 after 9.54 seconds
[0m17:33:38.243682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa98054b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa980549a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9846c2f50>]}
[0m17:33:38.244235 [debug] [MainThread]: Flushing usage events
[0m17:33:38.409042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:39.004108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aeed7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17afd56090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aeed7090>]}


============================== 17:48:39.008617 | bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec ==============================
[0m17:48:39.008617 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:48:39.009662 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'static_parser': 'True'}
[0m17:48:42.659611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17afd55650>]}
[0m17:48:42.746073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b1b49390>]}
[0m17:48:42.747275 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:48:42.998678 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:48:43.161325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:48:43.162284 [debug] [MainThread]: Partial parsing: added file: glramira://models/staging/stg_order.sql
[0m17:48:43.162963 [debug] [MainThread]: Partial parsing: added file: glramira://models/staging/source.yml
[0m17:48:43.711825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178f075150>]}
[0m17:48:43.821539 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:48:43.824321 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:48:43.843661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e521e90>]}
[0m17:48:43.844542 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m17:48:43.845184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e781290>]}
[0m17:48:43.847922 [info ] [MainThread]: 
[0m17:48:43.848563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:43.849098 [info ] [MainThread]: 
[0m17:48:43.849962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:43.856127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:48:43.857331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:44.375736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:48:44.376601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:44.701117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e615250>]}
[0m17:48:44.701989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:44.709908 [debug] [Thread-1 (]: Began running node model.glramira.my_first_dbt_model
[0m17:48:44.710702 [debug] [Thread-2 (]: Began running node model.glramira.stg_order
[0m17:48:44.711608 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_glramira.my_first_dbt_model .................... [RUN]
[0m17:48:44.712553 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_glramira.stg_order ............................. [RUN]
[0m17:48:44.713415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.my_first_dbt_model)
[0m17:48:44.714236 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.glramira.stg_order'
[0m17:48:44.714870 [debug] [Thread-1 (]: Began compiling node model.glramira.my_first_dbt_model
[0m17:48:44.715493 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_order
[0m17:48:44.725046 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.my_first_dbt_model"
[0m17:48:44.729859 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m17:48:44.731210 [debug] [Thread-1 (]: Began executing node model.glramira.my_first_dbt_model
[0m17:48:44.731913 [debug] [Thread-2 (]: Began executing node model.glramira.stg_order
[0m17:48:44.798784 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m17:48:44.800788 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.my_first_dbt_model"
[0m17:48:44.802219 [debug] [Thread-2 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_order`
  OPTIONS()
  as select
  ip
from `project-data-engineer-469310`.`product_info`.`event`;


[0m17:48:44.802881 [debug] [Thread-1 (]: On model.glramira.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_first_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`my_first_dbt_model`
  OPTIONS()
  as select 1 as id, 'hello_dbt' as message;


[0m17:48:44.803648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:44.804395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:45.351238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:ca0367af-8e9c-4347-98c4-2057fe795a71&page=queryresults
[0m17:48:45.595642 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:742443f7-967a-4d49-8c97-413b724e4ca8&page=queryresults
[0m17:48:45.596836 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:742443f7-967a-4d49-8c97-413b724e4ca8&page=queryresults
[0m17:48:45.608282 [debug] [Thread-2 (]: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m17:48:45.610803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e5a1bd0>]}
[0m17:48:45.611924 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_glramira.stg_order .................... [[31mERROR[0m in 0.90s]
[0m17:48:45.612729 [debug] [Thread-2 (]: Finished running node model.glramira.stg_order
[0m17:48:45.613547 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_order' to be skipped because of status 'error'.  Reason: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_order.sql.
[0m17:48:45.714436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e664a50>]}
[0m17:48:45.715722 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_glramira.my_first_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m17:48:45.716602 [debug] [Thread-1 (]: Finished running node model.glramira.my_first_dbt_model
[0m17:48:45.718187 [debug] [Thread-4 (]: Began running node model.glramira.my_second_dbt_model
[0m17:48:45.719140 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_glramira.my_second_dbt_model ................... [RUN]
[0m17:48:45.720142 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.glramira.my_second_dbt_model'
[0m17:48:45.720735 [debug] [Thread-4 (]: Began compiling node model.glramira.my_second_dbt_model
[0m17:48:45.726003 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.my_second_dbt_model"
[0m17:48:45.727022 [debug] [Thread-4 (]: Began executing node model.glramira.my_second_dbt_model
[0m17:48:45.731997 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.my_second_dbt_model"
[0m17:48:45.733034 [debug] [Thread-4 (]: On model.glramira.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_second_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `project-data-engineer-469310`.`dbt_glramira`.`my_first_dbt_model`
where id = 1;


[0m17:48:45.733695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:46.212087 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:0ac95e78-2f51-43bf-8f42-0da130746d1c&page=queryresults
[0m17:48:46.536875 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe4cf83-8a16-4b69-9b13-0b9e8c22b3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178f074750>]}
[0m17:48:46.538092 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_glramira.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m17:48:46.539163 [debug] [Thread-4 (]: Finished running node model.glramira.my_second_dbt_model
[0m17:48:46.541574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:46.543872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:46.544451 [debug] [MainThread]: Connection 'model.glramira.my_first_dbt_model' was properly closed.
[0m17:48:46.544933 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m17:48:46.545383 [debug] [MainThread]: Connection 'model.glramira.my_second_dbt_model' was properly closed.
[0m17:48:46.546025 [info ] [MainThread]: 
[0m17:48:46.546663 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m17:48:46.548052 [debug] [MainThread]: Command end result
[0m17:48:46.582185 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:48:46.584636 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:48:46.592479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:48:46.593013 [info ] [MainThread]: 
[0m17:48:46.593638 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:48:46.594198 [info ] [MainThread]: 
[0m17:48:46.594950 [error] [MainThread]: [31mFailure in model stg_order (models/staging/stg_order.sql)[0m
[0m17:48:46.595607 [error] [MainThread]:   Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m17:48:46.596795 [info ] [MainThread]: 
[0m17:48:46.597504 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_order.sql
[0m17:48:46.598035 [info ] [MainThread]: 
[0m17:48:46.598651 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:48:46.600253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.6740193, "process_in_blocks": "56", "process_kernel_time": 1.140655, "process_mem_max_rss": "409388", "process_out_blocks": "3168", "process_user_time": 7.261498}
[0m17:48:46.600998 [debug] [MainThread]: Command `dbt run` failed at 17:48:46.600843 after 7.68 seconds
[0m17:48:46.601536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af089d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b312f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b312efd0>]}
[0m17:48:46.602067 [debug] [MainThread]: Flushing usage events
[0m17:48:46.813153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:33.278297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32b65350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32d36190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32b65890>]}


============================== 17:53:33.282731 | 47012eee-c14e-4806-aaf9-59d84eac32b9 ==============================
[0m17:53:33.282731 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:53:33.283630 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:53:36.737430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1349ba90>]}
[0m17:53:36.820059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed35918890>]}
[0m17:53:36.821136 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:53:37.051180 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:53:37.184586 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:53:37.185366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed33cce910>]}
[0m17:53:38.828941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1269d510>]}
[0m17:53:38.937243 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:53:38.940235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:53:38.959153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed13189010>]}
[0m17:53:38.960070 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m17:53:38.960723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed126cd8d0>]}
[0m17:53:38.963402 [info ] [MainThread]: 
[0m17:53:38.963997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:38.964498 [info ] [MainThread]: 
[0m17:53:38.965304 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:38.971999 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:53:38.972731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:39.464296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_product_info)
[0m17:53:39.465179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:39.933601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed12792110>]}
[0m17:53:39.934491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:39.942310 [debug] [Thread-1 (]: Began running node model.glramira.my_first_dbt_model
[0m17:53:39.943123 [debug] [Thread-2 (]: Began running node model.glramira.stg_order
[0m17:53:39.944034 [info ] [Thread-1 (]: 1 of 3 START sql view model product_info.my_first_dbt_model .................... [RUN]
[0m17:53:39.945051 [info ] [Thread-2 (]: 2 of 3 START sql view model product_info.stg_order ............................. [RUN]
[0m17:53:39.945940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_product_info, now model.glramira.my_first_dbt_model)
[0m17:53:39.946795 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.glramira.stg_order'
[0m17:53:39.947476 [debug] [Thread-1 (]: Began compiling node model.glramira.my_first_dbt_model
[0m17:53:39.948147 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_order
[0m17:53:39.957297 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.my_first_dbt_model"
[0m17:53:39.961928 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m17:53:39.963133 [debug] [Thread-1 (]: Began executing node model.glramira.my_first_dbt_model
[0m17:53:39.963803 [debug] [Thread-2 (]: Began executing node model.glramira.stg_order
[0m17:53:40.029208 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.my_first_dbt_model"
[0m17:53:40.030272 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m17:53:40.031574 [debug] [Thread-1 (]: On model.glramira.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_first_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`product_info`.`my_first_dbt_model`
  OPTIONS()
  as select 1 as id, 'hello_dbt' as message;


[0m17:53:40.032269 [debug] [Thread-2 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`product_info`.`stg_order`
  OPTIONS()
  as select
  ip
from `project-data-engineer-469310`.`product_info`.`event`;


[0m17:53:40.033002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:40.033671 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:53:42.512879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bcb2d847-6a5d-4721-8d35-33f9ec7e8301&page=queryresults
[0m17:53:42.616542 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7c9d9072-025a-4da6-ad07-7a65601bf823&page=queryresults
[0m17:53:43.259918 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed12609dd0>]}
[0m17:53:43.261072 [info ] [Thread-2 (]: 2 of 3 OK created sql view model product_info.stg_order ........................ [[32mCREATE VIEW (0 processed)[0m in 3.31s]
[0m17:53:43.262059 [debug] [Thread-2 (]: Finished running node model.glramira.stg_order
[0m17:53:43.756798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed12416b90>]}
[0m17:53:43.757933 [info ] [Thread-1 (]: 1 of 3 OK created sql view model product_info.my_first_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 3.81s]
[0m17:53:43.758992 [debug] [Thread-1 (]: Finished running node model.glramira.my_first_dbt_model
[0m17:53:43.760230 [debug] [Thread-4 (]: Began running node model.glramira.my_second_dbt_model
[0m17:53:43.761452 [info ] [Thread-4 (]: 3 of 3 START sql view model product_info.my_second_dbt_model ................... [RUN]
[0m17:53:43.762370 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.glramira.my_second_dbt_model'
[0m17:53:43.762898 [debug] [Thread-4 (]: Began compiling node model.glramira.my_second_dbt_model
[0m17:53:43.768003 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.my_second_dbt_model"
[0m17:53:43.768887 [debug] [Thread-4 (]: Began executing node model.glramira.my_second_dbt_model
[0m17:53:43.774055 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.my_second_dbt_model"
[0m17:53:43.774996 [debug] [Thread-4 (]: On model.glramira.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.my_second_dbt_model"} */


  create or replace view `project-data-engineer-469310`.`product_info`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `project-data-engineer-469310`.`product_info`.`my_first_dbt_model`
where id = 1;


[0m17:53:43.775655 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:53:45.976448 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:397e630b-a9aa-49b0-aea0-3481e0331702&page=queryresults
[0m17:53:46.543000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47012eee-c14e-4806-aaf9-59d84eac32b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0af241d0>]}
[0m17:53:46.544643 [info ] [Thread-4 (]: 3 of 3 OK created sql view model product_info.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 2.78s]
[0m17:53:46.546020 [debug] [Thread-4 (]: Finished running node model.glramira.my_second_dbt_model
[0m17:53:46.548714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:46.552088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:46.552793 [debug] [MainThread]: Connection 'model.glramira.my_first_dbt_model' was properly closed.
[0m17:53:46.553427 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m17:53:46.554031 [debug] [MainThread]: Connection 'model.glramira.my_second_dbt_model' was properly closed.
[0m17:53:46.554993 [info ] [MainThread]: 
[0m17:53:46.555779 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m17:53:46.557766 [debug] [MainThread]: Command end result
[0m17:53:46.587807 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:53:46.590493 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:53:46.599078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:53:46.599747 [info ] [MainThread]: 
[0m17:53:46.600400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:46.600882 [info ] [MainThread]: 
[0m17:53:46.601412 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:53:46.602815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.396833, "process_in_blocks": "0", "process_kernel_time": 0.88219, "process_mem_max_rss": "410600", "process_out_blocks": "3168", "process_user_time": 8.280631}
[0m17:53:46.603531 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:46.603339 after 13.40 seconds
[0m17:53:46.604081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32b65d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32d36090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed36fc4150>]}
[0m17:53:46.604680 [debug] [MainThread]: Flushing usage events
[0m17:53:46.831427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:44.659764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0883fdfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0883fe5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0884191a10>]}


============================== 17:54:44.665000 | 6ef18f1e-62e7-449f-ab0d-0fab777be3e7 ==============================
[0m17:54:44.665000 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:54:44.665927 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'empty': 'False', 'invocation_command': 'dbt run -m stg_order', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None'}
[0m17:54:44.666592 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:54:44.667253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0886b23350>]}
[0m17:54:48.067715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088401b750>]}
[0m17:54:48.152835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0864592410>]}
[0m17:54:48.153907 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:54:48.380526 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:54:48.538223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:48.538894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:48.605047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08640e85d0>]}
[0m17:54:48.717052 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:54:48.719747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:54:48.736909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08645556d0>]}
[0m17:54:48.737815 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m17:54:48.738478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0863fdded0>]}
[0m17:54:48.740547 [info ] [MainThread]: 
[0m17:54:48.741131 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:48.741638 [info ] [MainThread]: 
[0m17:54:48.742559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:48.744059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:54:48.745070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.252911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_product_info)
[0m17:54:49.253829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:49.701238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0883ebc7d0>]}
[0m17:54:49.702155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:49.709402 [debug] [Thread-1 (]: Began running node model.glramira.stg_order
[0m17:54:49.710335 [info ] [Thread-1 (]: 1 of 1 START sql view model product_info.stg_order ............................. [RUN]
[0m17:54:49.711169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_product_info, now model.glramira.stg_order)
[0m17:54:49.711777 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_order
[0m17:54:49.724633 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m17:54:49.725743 [debug] [Thread-1 (]: Began executing node model.glramira.stg_order
[0m17:54:49.768798 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m17:54:49.770147 [debug] [Thread-1 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`product_info`.`stg_order`
  OPTIONS()
  as select
  ip
from `project-data-engineer-469310`.`product_info`.`event`;


[0m17:54:49.770956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.472613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bae90724-e9b8-4e1d-a789-ecfc90f6f087&page=queryresults
[0m17:54:51.894231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ef18f1e-62e7-449f-ab0d-0fab777be3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0863fe1910>]}
[0m17:54:51.895463 [info ] [Thread-1 (]: 1 of 1 OK created sql view model product_info.stg_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.18s]
[0m17:54:51.896550 [debug] [Thread-1 (]: Finished running node model.glramira.stg_order
[0m17:54:51.898972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:51.901922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:51.902417 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m17:54:51.903009 [info ] [MainThread]: 
[0m17:54:51.904064 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m17:54:51.905116 [debug] [MainThread]: Command end result
[0m17:54:51.941231 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:54:51.944718 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:54:51.954573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:54:51.955398 [info ] [MainThread]: 
[0m17:54:51.956362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:51.956972 [info ] [MainThread]: 
[0m17:54:51.957628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:51.958561 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:54:51.960154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.387342, "process_in_blocks": "0", "process_kernel_time": 0.80415, "process_mem_max_rss": "395256", "process_out_blocks": "2104", "process_user_time": 6.331167}
[0m17:54:51.960877 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:51.960696 after 7.39 seconds
[0m17:54:51.961587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0884191d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08842a06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088818f090>]}
[0m17:54:51.962305 [debug] [MainThread]: Flushing usage events
[0m17:54:52.163741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:57.111258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce371b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce385db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce3961d90>]}


============================== 17:56:57.117494 | 5e9f92a6-b6cf-476e-9aa4-312eafaa949d ==============================
[0m17:56:57.117494 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:56:57.118397 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'empty': 'False', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run -m stg_order', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs'}
[0m17:56:57.119068 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:56:57.119735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce385e450>]}
[0m17:57:01.602070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce45d2550>]}
[0m17:57:01.691651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce62c1b50>]}
[0m17:57:01.692783 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:57:01.934078 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:57:02.111908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:02.112904 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_order.sql
[0m17:57:02.499463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc37aee50>]}
[0m17:57:02.612395 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:57:02.615259 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:57:02.634469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc2e43590>]}
[0m17:57:02.635285 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m17:57:02.635949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc38ac510>]}
[0m17:57:02.638117 [info ] [MainThread]: 
[0m17:57:02.638699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:02.639185 [info ] [MainThread]: 
[0m17:57:02.639991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:02.641505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:57:02.642296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:03.145136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_product_info)
[0m17:57:03.145907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:03.591415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc38d4ed0>]}
[0m17:57:03.592252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:03.602615 [debug] [Thread-1 (]: Began running node model.glramira.stg_order
[0m17:57:03.603785 [info ] [Thread-1 (]: 1 of 1 START sql view model product_info.stg_order ............................. [RUN]
[0m17:57:03.604717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_product_info, now model.glramira.stg_order)
[0m17:57:03.605418 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_order
[0m17:57:03.616687 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m17:57:03.617794 [debug] [Thread-1 (]: Began executing node model.glramira.stg_order
[0m17:57:03.660505 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m17:57:03.661663 [debug] [Thread-1 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`product_info`.`stg_order`
  OPTIONS()
  as select
  _id,
  time_stamp,
  ip,
  user_agent,
  resolution,
  user_id_db,
  device_id,
  api_version,
  store_id,
  local_time
from `project-data-engineer-469310`.`product_info`.`event`;


[0m17:57:03.662411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:05.543911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b2279ccf-37fd-45c3-9a1f-e40d58d86a0f&page=queryresults
[0m17:57:06.436526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e9f92a6-b6cf-476e-9aa4-312eafaa949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc2e41b10>]}
[0m17:57:06.437760 [info ] [Thread-1 (]: 1 of 1 OK created sql view model product_info.stg_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.83s]
[0m17:57:06.438815 [debug] [Thread-1 (]: Finished running node model.glramira.stg_order
[0m17:57:06.441192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:06.443747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:06.444630 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m17:57:06.445407 [info ] [MainThread]: 
[0m17:57:06.446069 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m17:57:06.447259 [debug] [MainThread]: Command end result
[0m17:57:06.490008 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:57:06.493655 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:57:06.503348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:57:06.504164 [info ] [MainThread]: 
[0m17:57:06.504865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:06.505320 [info ] [MainThread]: 
[0m17:57:06.505766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:57:06.506483 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:06.508482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.476637, "process_in_blocks": "9864", "process_kernel_time": 1.757708, "process_mem_max_rss": "400356", "process_out_blocks": "3128", "process_user_time": 7.026639}
[0m17:57:06.509178 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:06.509023 after 9.48 seconds
[0m17:57:06.509696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce3961d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce371add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce796c1d0>]}
[0m17:57:06.510278 [debug] [MainThread]: Flushing usage events
[0m17:57:06.694045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:47.639547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73d658d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d740b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d740b6450>]}


============================== 18:01:47.643960 | 23e0f48e-f357-43f0-b147-22f0fc9e1814 ==============================
[0m18:01:47.643960 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:01:47.644761 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_order', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:01:47.645462 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:01:47.646089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73d67e90>]}
[0m18:01:51.156243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d744c97d0>]}
[0m18:01:51.240180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76b196d0>]}
[0m18:01:51.241292 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:01:51.478133 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:01:51.637325 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:01:51.638108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d74ec6750>]}
[0m18:01:53.282385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5386f550>]}
[0m18:01:53.391763 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:01:53.394499 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:01:53.412267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5370cb10>]}
[0m18:01:53.413129 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m18:01:53.413742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5370ce50>]}
[0m18:01:53.416090 [info ] [MainThread]: 
[0m18:01:53.416776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:53.417361 [info ] [MainThread]: 
[0m18:01:53.418205 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:53.420574 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:01:53.421337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:53.918642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:01:53.919553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:54.180816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5396f010>]}
[0m18:01:54.181732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:54.188933 [debug] [Thread-1 (]: Began running node model.glramira.stg_order
[0m18:01:54.189905 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_order ............................. [RUN]
[0m18:01:54.190741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_order)
[0m18:01:54.191423 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_order
[0m18:01:54.201821 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m18:01:54.202938 [debug] [Thread-1 (]: Began executing node model.glramira.stg_order
[0m18:01:54.243334 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m18:01:54.244497 [debug] [Thread-1 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_order`
  OPTIONS()
  as select
  _id,
  time_stamp,
  ip,
  user_agent,
  resolution,
  user_id_db,
  device_id,
  api_version,
  store_id,
  local_time
from `project-data-engineer-469310`.`product_info`.`event`;


[0m18:01:54.245187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:55.042774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:47f5eb75-796d-40b8-beb6-c7d4b96711f6&page=queryresults
[0m18:01:55.043745 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:47f5eb75-796d-40b8-beb6-c7d4b96711f6&page=queryresults
[0m18:01:55.053706 [debug] [Thread-1 (]: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m18:01:55.056164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e0f48e-f357-43f0-b147-22f0fc9e1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d542fb7d0>]}
[0m18:01:55.057306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_order .................... [[31mERROR[0m in 0.86s]
[0m18:01:55.058241 [debug] [Thread-1 (]: Finished running node model.glramira.stg_order
[0m18:01:55.059286 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_order' to be skipped because of status 'error'.  Reason: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql.
[0m18:01:55.062306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:55.064836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:55.065421 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m18:01:55.065938 [info ] [MainThread]: 
[0m18:01:55.066460 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m18:01:55.067497 [debug] [MainThread]: Command end result
[0m18:01:55.099630 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:01:55.102196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:01:55.109544 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:01:55.110097 [info ] [MainThread]: 
[0m18:01:55.110764 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:01:55.111343 [info ] [MainThread]: 
[0m18:01:55.112031 [error] [MainThread]: [31mFailure in model stg_order (models/staging/stg_order.sql)[0m
[0m18:01:55.112628 [error] [MainThread]:   Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m18:01:55.113097 [info ] [MainThread]: 
[0m18:01:55.113712 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_order.sql
[0m18:01:55.114294 [info ] [MainThread]: 
[0m18:01:55.114842 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:55.115695 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:55.117118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.549558, "process_in_blocks": "0", "process_kernel_time": 0.816985, "process_mem_max_rss": "401580", "process_out_blocks": "3120", "process_user_time": 7.923218}
[0m18:01:55.117838 [debug] [MainThread]: Command `dbt run` failed at 18:01:55.117639 after 7.55 seconds
[0m18:01:55.118442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d74e1e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d547c0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d741c4950>]}
[0m18:01:55.119005 [debug] [MainThread]: Flushing usage events
[0m18:01:55.313504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:14.499800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760d4c67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760d4bd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760d669a10>]}


============================== 18:03:14.504417 | c5881fb1-cc93-46b5-a8b1-256e8a8d7947 ==============================
[0m18:03:14.504417 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:03:14.505274 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run -m stg_order', 'indirect_selection': 'eager', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'static_parser': 'True'}
[0m18:03:14.505897 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:03:14.506533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760d669d10>]}
[0m18:03:17.961654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760fb85c50>]}
[0m18:03:18.048407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7610024c50>]}
[0m18:03:18.049483 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:03:18.280668 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:03:18.439599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:18.440279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:18.505009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed7ccad0>]}
[0m18:03:18.622908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:03:18.626576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:03:18.647875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed728990>]}
[0m18:03:18.649040 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 495 macros
[0m18:03:18.649780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed6bc650>]}
[0m18:03:18.651903 [info ] [MainThread]: 
[0m18:03:18.652421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:18.652813 [info ] [MainThread]: 
[0m18:03:18.653534 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:18.655007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:03:18.655784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:19.142125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:03:19.142980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:19.409200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed728a90>]}
[0m18:03:19.410254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:19.418071 [debug] [Thread-1 (]: Began running node model.glramira.stg_order
[0m18:03:19.419092 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_order ............................. [RUN]
[0m18:03:19.420012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_order)
[0m18:03:19.420640 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_order
[0m18:03:19.433077 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_order"
[0m18:03:19.434117 [debug] [Thread-1 (]: Began executing node model.glramira.stg_order
[0m18:03:19.474224 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_order"
[0m18:03:19.475309 [debug] [Thread-1 (]: On model.glramira.stg_order: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_order"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_order`
  OPTIONS()
  as select
  _id,
  time_stamp,
  ip,
  user_agent,
  resolution,
  user_id_db,
  device_id,
  api_version,
  store_id,
  local_time
from `project-data-engineer-469310`.`product_info`.`event`;


[0m18:03:19.476110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:20.271515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b33e8526-806a-4eb8-9f05-7910dfb82872&page=queryresults
[0m18:03:20.272449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b33e8526-806a-4eb8-9f05-7910dfb82872&page=queryresults
[0m18:03:20.281995 [debug] [Thread-1 (]: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m18:03:20.284407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5881fb1-cc93-46b5-a8b1-256e8a8d7947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed83bc50>]}
[0m18:03:20.285492 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_order .................... [[31mERROR[0m in 0.86s]
[0m18:03:20.286617 [debug] [Thread-1 (]: Finished running node model.glramira.stg_order
[0m18:03:20.287584 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_order' to be skipped because of status 'error'.  Reason: Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql.
[0m18:03:20.290898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:20.293408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:20.293898 [debug] [MainThread]: Connection 'model.glramira.stg_order' was properly closed.
[0m18:03:20.294437 [info ] [MainThread]: 
[0m18:03:20.295004 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m18:03:20.296069 [debug] [MainThread]: Command end result
[0m18:03:20.328572 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:03:20.331184 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:03:20.339318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:03:20.339977 [info ] [MainThread]: 
[0m18:03:20.340711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:03:20.341333 [info ] [MainThread]: 
[0m18:03:20.342045 [error] [MainThread]: [31mFailure in model stg_order (models/staging/stg_order.sql)[0m
[0m18:03:20.342688 [error] [MainThread]:   Database Error in model stg_order (models/staging/stg_order.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_order.sql
[0m18:03:20.343209 [info ] [MainThread]: 
[0m18:03:20.343846 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_order.sql
[0m18:03:20.344372 [info ] [MainThread]: 
[0m18:03:20.344938 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:03:20.345859 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:20.347340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.920171, "process_in_blocks": "0", "process_kernel_time": 0.770025, "process_mem_max_rss": "392508", "process_out_blocks": "2112", "process_user_time": 6.248793}
[0m18:03:20.348147 [debug] [MainThread]: Command `dbt run` failed at 18:03:20.347950 after 5.92 seconds
[0m18:03:20.348887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f85de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761161f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761161f090>]}
[0m18:03:20.349470 [debug] [MainThread]: Flushing usage events
[0m18:03:20.593630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:52.416631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7bcde6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7be89a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7bcdf190>]}


============================== 18:14:52.422012 | 2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f ==============================
[0m18:14:52.422012 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:14:52.422907 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'empty': 'False', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False'}
[0m18:14:52.423590 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:14:52.424242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7be779d0>]}
[0m18:14:56.070409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5c4f7e90>]}
[0m18:14:56.180291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7e955250>]}
[0m18:14:56.181382 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:14:56.455821 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:14:56.596217 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:14:56.597006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7c61f290>]}
[0m18:14:58.389366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5be88dd0>]}
[0m18:14:58.498003 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:14:58.500840 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:14:58.518610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5b3cced0>]}
[0m18:14:58.519434 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:14:58.519992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5c4dee90>]}
[0m18:14:58.522140 [info ] [MainThread]: 
[0m18:14:58.522675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:58.523145 [info ] [MainThread]: 
[0m18:14:58.523938 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:58.525331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:14:58.525926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:59.020508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:14:59.021337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:59.305757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5b476150>]}
[0m18:14:59.306759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:59.314868 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:14:59.316163 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:14:59.317192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:14:59.317884 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:14:59.328932 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:14:59.329965 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:14:59.371496 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:14:59.372637 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        cast(order_id as int64) as order_id,
        cast(user_id as int64) as user_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(location_id as int64) as location_id,
        cast(date_id as int64) as date_id,
        cast(total_price as numeric) as total_price,
        cast(amount as int64) as amount,
        cast(price as numeric) as price,
        currency,
        is_paypal,
        ip_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:14:59.373388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:59.772749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:7a575d7a-4389-4f78-945c-4b3d75789005&page=queryresults
[0m18:14:59.773700 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:7a575d7a-4389-4f78-945c-4b3d75789005&page=queryresults
[0m18:14:59.783494 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:14:59.785831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c1ca1-7228-4d20-86c8-0f109f2cbd3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5bff1550>]}
[0m18:14:59.786864 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.47s]
[0m18:14:59.787828 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:14:59.788644 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:14:59.791481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:59.794130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:59.794773 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:14:59.795262 [info ] [MainThread]: 
[0m18:14:59.795796 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m18:14:59.796717 [debug] [MainThread]: Command end result
[0m18:14:59.833296 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:14:59.835798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:14:59.843331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:14:59.844015 [info ] [MainThread]: 
[0m18:14:59.844607 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:14:59.845144 [info ] [MainThread]: 
[0m18:14:59.845754 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:14:59.846363 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:14:59.846979 [info ] [MainThread]: 
[0m18:14:59.847803 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:14:59.848465 [info ] [MainThread]: 
[0m18:14:59.849162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:59.850251 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:59.852091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.515597, "process_in_blocks": "0", "process_kernel_time": 0.685866, "process_mem_max_rss": "402352", "process_out_blocks": "3200", "process_user_time": 8.383426}
[0m18:14:59.852997 [debug] [MainThread]: Command `dbt run` failed at 18:14:59.852782 after 7.52 seconds
[0m18:14:59.853806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7ff87110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7cfc25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e800d0690>]}
[0m18:14:59.854589 [debug] [MainThread]: Flushing usage events
[0m18:15:00.031281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:02.711611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8112017450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811215dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8112016750>]}


============================== 18:21:02.716092 | a12e40d8-c71e-496e-8d43-ca0dbf8300fa ==============================
[0m18:21:02.716092 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:21:02.716990 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_fact_orders', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m18:21:02.717669 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:21:02.718320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8112015610>]}
[0m18:21:06.165403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111fb9ed0>]}
[0m18:21:06.249358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8114bc6150>]}
[0m18:21:06.250409 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:21:06.476274 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:21:06.633818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:06.634451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:06.699064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f21b7a50>]}
[0m18:21:06.814965 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:21:06.817926 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:21:06.835897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f22d3050>]}
[0m18:21:06.837025 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:21:06.837747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2197850>]}
[0m18:21:06.840063 [info ] [MainThread]: 
[0m18:21:06.840709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:21:06.841232 [info ] [MainThread]: 
[0m18:21:06.842108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:21:06.843656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:21:06.844407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:07.342116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:21:07.342959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:07.631326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2133c90>]}
[0m18:21:07.632391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:07.640073 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:21:07.641031 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:21:07.641869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:21:07.642441 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:21:07.654867 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:21:07.655888 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:21:07.697432 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:21:07.698618 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        cast(order_id as int64) as order_id,
        cast(user_id as int64) as user_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(location_id as int64) as location_id,
        cast(date_id as int64) as date_id,
        cast(total_price as numeric) as total_price,
        cast(amount as int64) as amount,
        cast(price as numeric) as price,
        currency,
        is_paypal,
        ip_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:21:07.699413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:08.137356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:0e4c5017-adba-4c03-95bf-843198b6e354&page=queryresults
[0m18:21:08.138310 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:0e4c5017-adba-4c03-95bf-843198b6e354&page=queryresults
[0m18:21:08.148436 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:21:08.150721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12e40d8-c71e-496e-8d43-ca0dbf8300fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f1fa63d0>]}
[0m18:21:08.151822 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.51s]
[0m18:21:08.152674 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:21:08.153501 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:21:08.156416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:08.158720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:08.159299 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:21:08.159871 [info ] [MainThread]: 
[0m18:21:08.160383 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m18:21:08.161345 [debug] [MainThread]: Command end result
[0m18:21:08.196762 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:21:08.199392 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:21:08.207235 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:21:08.207914 [info ] [MainThread]: 
[0m18:21:08.208594 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:21:08.209158 [info ] [MainThread]: 
[0m18:21:08.209785 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:21:08.210385 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:21:08.210893 [info ] [MainThread]: 
[0m18:21:08.211497 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:21:08.212005 [info ] [MainThread]: 
[0m18:21:08.212541 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:21:08.213338 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:21:08.214843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.578038, "process_in_blocks": "0", "process_kernel_time": 0.880525, "process_mem_max_rss": "392440", "process_out_blocks": "2160", "process_user_time": 6.241703}
[0m18:21:08.215819 [debug] [MainThread]: Command `dbt run` failed at 18:21:08.215632 after 5.58 seconds
[0m18:21:08.216470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811215dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2227e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81161ab010>]}
[0m18:21:08.217053 [debug] [MainThread]: Flushing usage events
[0m18:21:08.405914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:46.337565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087a9e90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087aa2acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087a9e1a90>]}


============================== 18:27:46.343946 | 28e318cb-4973-4238-8a78-0c6d9763cfac ==============================
[0m18:27:46.343946 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:27:46.345165 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'empty': 'False', 'target_path': 'None'}
[0m18:27:46.346003 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:27:46.346820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087aa50210>]}
[0m18:27:49.855683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085af659d0>]}
[0m18:27:49.946518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087d5618d0>]}
[0m18:27:49.947705 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:27:50.187288 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:27:50.362734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:27:50.363870 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/source.yml
[0m18:27:50.364431 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:27:50.937704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b021410>]}
[0m18:27:51.048565 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:27:51.051458 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:27:51.069997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087c745450>]}
[0m18:27:51.070936 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:27:51.071529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085a921590>]}
[0m18:27:51.073710 [info ] [MainThread]: 
[0m18:27:51.074275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:51.074750 [info ] [MainThread]: 
[0m18:27:51.075633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:51.077416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:27:51.078307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:51.570822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:27:51.571836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:51.869900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087aff4990>]}
[0m18:27:51.870995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:51.880360 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:27:51.881439 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:27:51.882386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:27:51.882958 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:27:51.893635 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:27:51.894671 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:27:51.940524 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:27:51.941693 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        cast(order_id as int64) as order_id,
        cast(user_id as int64) as user_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(location_id as int64) as location_id,
        cast(date_id as int64) as date_id,
        cast(total_price as numeric) as total_price,
        cast(amount as int64) as amount,
        cast(price as numeric) as price,
        currency,
        is_paypal,
        ip_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:27:51.942395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:52.470093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:fd3378df-cdcb-4235-8d67-a918fb51e929&page=queryresults
[0m18:27:52.471038 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:US:fd3378df-cdcb-4235-8d67-a918fb51e929&page=queryresults
[0m18:27:52.482498 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:27:52.484924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e318cb-4973-4238-8a78-0c6d9763cfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085aaf11d0>]}
[0m18:27:52.485926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.60s]
[0m18:27:52.486799 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:27:52.487682 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:27:52.490839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:52.493243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:52.493690 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:27:52.494138 [info ] [MainThread]: 
[0m18:27:52.494658 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m18:27:52.495661 [debug] [MainThread]: Command end result
[0m18:27:52.530881 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:27:52.533496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:27:52.540922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:27:52.541474 [info ] [MainThread]: 
[0m18:27:52.542164 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:27:52.542691 [info ] [MainThread]: 
[0m18:27:52.543284 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:27:52.543922 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:product_info was not found in location US
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:27:52.544403 [info ] [MainThread]: 
[0m18:27:52.544955 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:27:52.545441 [info ] [MainThread]: 
[0m18:27:52.545966 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:27:52.546745 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:27:52.548356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.285714, "process_in_blocks": "0", "process_kernel_time": 0.82329, "process_mem_max_rss": "398276", "process_out_blocks": "3200", "process_user_time": 6.853412}
[0m18:27:52.549024 [debug] [MainThread]: Command `dbt run` failed at 18:27:52.548849 after 6.29 seconds
[0m18:27:52.549658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087eb87090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087a9e1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087ecd0e90>]}
[0m18:27:52.550269 [debug] [MainThread]: Flushing usage events
[0m18:27:52.769266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:52.176874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebfd2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebfca0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebfc9d90>]}


============================== 18:29:52.181524 | cf6a46a5-d875-4492-9d02-f8746da7c9bd ==============================
[0m18:29:52.181524 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:29:52.182376 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_fact_orders', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m18:29:52.182997 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:29:52.183663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec17e450>]}
[0m18:29:55.645281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc86f550>]}
[0m18:29:55.730981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8eec457d0>]}
[0m18:29:55.732156 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:29:55.958653 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:29:56.093793 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:29:56.094605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ecf8e750>]}
[0m18:29:57.815449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc3a1e90>]}
[0m18:29:57.927687 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:29:57.930534 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:29:57.949469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb72ff10>]}
[0m18:29:57.950417 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:29:57.951076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc8eb450>]}
[0m18:29:57.953479 [info ] [MainThread]: 
[0m18:29:57.954218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:29:57.954740 [info ] [MainThread]: 
[0m18:29:57.955640 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:29:57.957214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:29:57.958128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:58.445987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:29:58.446839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:29:58.715041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc7c3110>]}
[0m18:29:58.716183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:58.723046 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:29:58.723931 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:29:58.724708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:29:58.725217 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:29:58.735867 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:29:58.736935 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:29:58.776467 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:29:58.777593 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        cast(order_id as int64) as order_id,
        cast(user_id as int64) as user_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(location_id as int64) as location_id,
        cast(date_id as int64) as date_id,
        cast(total_price as numeric) as total_price,
        cast(amount as int64) as amount,
        cast(price as numeric) as price,
        currency,
        is_paypal,
        ip_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:29:58.778416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:59.610143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fa865cfe-693d-461c-9eba-94db11a5c1da&page=queryresults
[0m18:29:59.611096 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fa865cfe-693d-461c-9eba-94db11a5c1da&page=queryresults
[0m18:29:59.620737 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:29:59.623108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a46a5-d875-4492-9d02-f8746da7c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb912210>]}
[0m18:29:59.624137 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.90s]
[0m18:29:59.624954 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:29:59.625807 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:29:59.629055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:59.631637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:59.632189 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:29:59.632660 [info ] [MainThread]: 
[0m18:29:59.633213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m18:29:59.634188 [debug] [MainThread]: Command end result
[0m18:29:59.667162 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:29:59.669866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:29:59.677434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:29:59.677966 [info ] [MainThread]: 
[0m18:29:59.678618 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:29:59.679212 [info ] [MainThread]: 
[0m18:29:59.679968 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:29:59.680582 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Not found: Dataset project-data-engineer-469310:dbt_glramira was not found in location africa-south1
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:29:59.681077 [info ] [MainThread]: 
[0m18:29:59.681668 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:29:59.682174 [info ] [MainThread]: 
[0m18:29:59.682723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:29:59.683578 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:29:59.685113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.580905, "process_in_blocks": "0", "process_kernel_time": 0.766906, "process_mem_max_rss": "401136", "process_out_blocks": "3192", "process_user_time": 7.975722}
[0m18:29:59.685929 [debug] [MainThread]: Command `dbt run` failed at 18:29:59.685731 after 7.58 seconds
[0m18:29:59.686739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ec17de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc2a53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0277110>]}
[0m18:29:59.687457 [debug] [MainThread]: Flushing usage events
[0m18:29:59.901172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:37.718445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd4416d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd45c2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd4416f10>]}


============================== 18:32:37.723262 | f31da77f-5e7d-4ddf-92ff-f5aadec2f69b ==============================
[0m18:32:37.723262 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:32:37.724134 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'use_colors': 'True', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default'}
[0m18:32:37.724767 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:32:37.725381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd4272850>]}
[0m18:32:41.238936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb4b2b210>]}
[0m18:32:41.324968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb4aca410>]}
[0m18:32:41.326048 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:32:41.576013 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:32:41.735917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:41.736549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:41.800676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb48c8fd0>]}
[0m18:32:41.916022 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:32:41.918702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:32:41.936281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb4508b50>]}
[0m18:32:41.937181 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:32:41.937883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd49d0a50>]}
[0m18:32:41.940051 [info ] [MainThread]: 
[0m18:32:41.940607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:41.941081 [info ] [MainThread]: 
[0m18:32:41.941875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:41.943546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:32:41.944358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:42.446274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now create_project-data-engineer-469310_dbt_glramira)
[0m18:32:42.447332 [debug] [ThreadPool]: Creating schema "database: "project-data-engineer-469310"
schema: "dbt_glramira"
"
[0m18:32:42.462385 [debug] [ThreadPool]: On create_project-data-engineer-469310_dbt_glramira: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "connection_name": "create_project-data-engineer-469310_dbt_glramira"} */
create schema if not exists `project-data-engineer-469310`.`dbt_glramira`
  
[0m18:32:42.463041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:43.619674 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a2c4a6a8-8e23-4ff5-a26b-b5a5e805b474&page=queryresults
[0m18:32:46.819697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_project-data-engineer-469310_dbt_glramira, now list_project-data-engineer-469310_dbt_glramira)
[0m18:32:46.820560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:47.266244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd5780210>]}
[0m18:32:47.267635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:47.275075 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:32:47.276113 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:32:47.276909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:32:47.277483 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:32:47.289184 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:32:47.290416 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:32:47.325895 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:32:47.327035 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        cast(order_id as int64) as order_id,
        cast(user_id as int64) as user_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(location_id as int64) as location_id,
        cast(date_id as int64) as date_id,
        cast(total_price as numeric) as total_price,
        cast(amount as int64) as amount,
        cast(price as numeric) as price,
        currency,
        is_paypal,
        ip_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:32:47.327762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:48.055274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:934cfde0-91aa-4f49-8eea-6582f89baf52&page=queryresults
[0m18:32:48.501193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:934cfde0-91aa-4f49-8eea-6582f89baf52&page=queryresults
[0m18:32:48.511275 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unrecognized name: user_id; Did you mean order_id? at [9:14]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:32:48.513722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f31da77f-5e7d-4ddf-92ff-f5aadec2f69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb39fb8d0>]}
[0m18:32:48.514811 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.24s]
[0m18:32:48.515809 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:32:48.516614 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unrecognized name: user_id; Did you mean order_id? at [9:14]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:32:48.519589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:48.522248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:48.522759 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:32:48.523297 [info ] [MainThread]: 
[0m18:32:48.523877 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m18:32:48.524852 [debug] [MainThread]: Command end result
[0m18:32:48.561427 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:32:48.564308 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:32:48.572791 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:32:48.573465 [info ] [MainThread]: 
[0m18:32:48.574213 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:32:48.574803 [info ] [MainThread]: 
[0m18:32:48.575540 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:32:48.576207 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unrecognized name: user_id; Did you mean order_id? at [9:14]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:32:48.576708 [info ] [MainThread]: 
[0m18:32:48.577368 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:32:48.577882 [info ] [MainThread]: 
[0m18:32:48.578539 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:32:48.579544 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:32:48.581232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.936608, "process_in_blocks": "0", "process_kernel_time": 0.796626, "process_mem_max_rss": "395896", "process_out_blocks": "2152", "process_user_time": 6.573455}
[0m18:32:48.582029 [debug] [MainThread]: Command `dbt run` failed at 18:32:48.581844 after 10.94 seconds
[0m18:32:48.582680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd4271990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd4273190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd85fb010>]}
[0m18:32:48.583309 [debug] [MainThread]: Flushing usage events
[0m18:32:48.765731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:43.320413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65c85f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65c86390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65b37850>]}


============================== 18:43:43.324868 | ca0a4173-0560-4026-9871-95bc4e373dc9 ==============================
[0m18:43:43.324868 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:43:43.325712 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m stg_fact_orders', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True'}
[0m18:43:43.326361 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:43:43.327011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65d89d90>]}
[0m18:43:47.088763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c463e8410>]}
[0m18:43:47.174107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c68709490>]}
[0m18:43:47.175210 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:43:47.443243 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:43:47.620092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:47.621085 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:43:48.015410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c460ffe10>]}
[0m18:43:48.131019 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:43:48.133893 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:43:48.152708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c45dbf450>]}
[0m18:43:48.153570 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:43:48.154155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c45d9e950>]}
[0m18:43:48.156291 [info ] [MainThread]: 
[0m18:43:48.156846 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:48.157323 [info ] [MainThread]: 
[0m18:43:48.158126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:48.159671 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:43:48.160441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:48.663395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:43:48.664240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:49.130409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c45de0910>]}
[0m18:43:49.131356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:49.138468 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:43:49.139479 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:43:49.140288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:43:49.140851 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:43:49.151513 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:43:49.152499 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:43:49.191273 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:43:49.192349 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        SHA256(concat(
          cast(product_id as string), 
          cast(order_id as string), 
          cast(device_id as string)
        )) AS event_id,
        cast(order_id as int64) as order_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(price as numeric) as price,
        currency,
        is_paypal,
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:43:49.193052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:50.062092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:588c4122-9b3c-45b7-a4ca-3c5820ea28f0&page=queryresults
[0m18:43:51.026266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca0a4173-0560-4026-9871-95bc4e373dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c463672d0>]}
[0m18:43:51.027465 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.88s]
[0m18:43:51.028405 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:43:51.030714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:51.033006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:51.033503 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:43:51.034079 [info ] [MainThread]: 
[0m18:43:51.034593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m18:43:51.035784 [debug] [MainThread]: Command end result
[0m18:43:51.072927 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:43:51.075655 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:43:51.085160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:43:51.085998 [info ] [MainThread]: 
[0m18:43:51.086870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:51.087550 [info ] [MainThread]: 
[0m18:43:51.088189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:51.089014 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:43:51.090476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8464375, "process_in_blocks": "0", "process_kernel_time": 1.04846, "process_mem_max_rss": "402848", "process_out_blocks": "3200", "process_user_time": 6.82734}
[0m18:43:51.091130 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:51.090962 after 7.85 seconds
[0m18:43:51.091788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65d89d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69fca1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69cf6f50>]}
[0m18:43:51.092355 [debug] [MainThread]: Flushing usage events
[0m18:43:51.287625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:22.009886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29419368d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941a81b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941a819d0>]}


============================== 18:46:22.014313 | f92928a8-310e-4cb7-97b1-8eef2256bb91 ==============================
[0m18:46:22.014313 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:46:22.015592 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -m stg_fact_orders'}
[0m18:46:22.016312 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:46:22.017003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941940210>]}
[0m18:46:25.447637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2921e28610>]}
[0m18:46:25.530426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2944450d10>]}
[0m18:46:25.531470 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:46:25.757830 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:46:25.914500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:46:25.915484 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:46:26.277400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2921aedd90>]}
[0m18:46:26.393470 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:46:26.396264 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:46:26.413939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292186ebd0>]}
[0m18:46:26.414778 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:46:26.415351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2921d5d0d0>]}
[0m18:46:26.417546 [info ] [MainThread]: 
[0m18:46:26.418082 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:26.418547 [info ] [MainThread]: 
[0m18:46:26.419418 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:26.420865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:46:26.421580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:26.915677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:46:26.916559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:27.359343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292181c850>]}
[0m18:46:27.360399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:27.367711 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:46:27.368655 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:46:27.369490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:46:27.370046 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:46:27.380493 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:46:27.381524 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:46:27.421142 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:46:27.422325 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        FARM_FINGERPRINT(concat(
          cast(product_id as string), 
          cast(order_id as string), 
          cast(device_id as string)
        )) AS event_id,
        cast(order_id as int64) as order_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(price as numeric) as price,
        currency,
        is_paypal,
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:46:27.423042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:28.322278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:25a0e403-89f5-424e-ae07-3e7fdb4cd99b&page=queryresults
[0m18:46:28.975984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92928a8-310e-4cb7-97b1-8eef2256bb91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2921ffabd0>]}
[0m18:46:28.977148 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m18:46:28.978149 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:46:28.980886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:28.983262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:28.983775 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:46:28.984296 [info ] [MainThread]: 
[0m18:46:28.984922 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m18:46:28.985918 [debug] [MainThread]: Command end result
[0m18:46:29.020239 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:46:29.023127 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:46:29.031230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:46:29.031891 [info ] [MainThread]: 
[0m18:46:29.032629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:29.033264 [info ] [MainThread]: 
[0m18:46:29.033872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:46:29.034727 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:46:29.036226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1012425, "process_in_blocks": "0", "process_kernel_time": 0.871158, "process_mem_max_rss": "402084", "process_out_blocks": "3200", "process_user_time": 6.556715}
[0m18:46:29.036954 [debug] [MainThread]: Command `dbt run` succeeded at 18:46:29.036780 after 7.10 seconds
[0m18:46:29.037540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941943b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941943390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2945b582d0>]}
[0m18:46:29.038125 [debug] [MainThread]: Flushing usage events
[0m18:46:29.229566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:15.814668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76b09a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76966f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76cb6410>]}


============================== 18:57:15.819073 | bf0ff70f-13d5-42d5-962e-5c02dd358adf ==============================
[0m18:57:15.819073 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:57:15.820027 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True'}
[0m18:57:15.820666 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:57:15.821275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76cb6450>]}
[0m18:57:19.235800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d571fee10>]}
[0m18:57:19.321846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d79659690>]}
[0m18:57:19.322968 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:57:19.566375 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:57:19.725086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:19.726087 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:57:20.093701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d56daaf50>]}
[0m18:57:20.205436 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:57:20.208377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:57:20.226861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d57050150>]}
[0m18:57:20.227819 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:57:20.228442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d56ccd310>]}
[0m18:57:20.230509 [info ] [MainThread]: 
[0m18:57:20.231087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:20.231642 [info ] [MainThread]: 
[0m18:57:20.232475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:57:20.233966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:57:20.234749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:20.724807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:57:20.725693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:21.160549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d57051090>]}
[0m18:57:21.161542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:21.169953 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:57:21.171338 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:57:21.172593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:57:21.173511 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:57:21.187935 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:57:21.189176 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:57:21.237028 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:57:21.238099 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        FARM_FINGERPRINT(CONCAT(
        COALESCE(CAST(product_id AS STRING), ''),
        COALESCE(CAST(order_id AS STRING), ''),
        COALESCE(CAST(device_id AS STRING), '')
    )) AS event_id
        cast(order_id as int64) as order_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(price as numeric) as price,
        currency,
        is_paypal,
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:57:21.238767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:22.051237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:09ebd111-1089-4a66-8cc8-526a48632a46&page=queryresults
[0m18:57:22.052223 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:09ebd111-1089-4a66-8cc8-526a48632a46&page=queryresults
[0m18:57:22.061738 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [13:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:57:22.064134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0ff70f-13d5-42d5-962e-5c02dd358adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5413b990>]}
[0m18:57:22.065179 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.89s]
[0m18:57:22.066068 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:57:22.066939 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [13:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m18:57:22.069998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:22.072325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:22.072867 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:57:22.073431 [info ] [MainThread]: 
[0m18:57:22.073973 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m18:57:22.075202 [debug] [MainThread]: Command end result
[0m18:57:22.110290 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:57:22.112905 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:57:22.120587 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:57:22.121221 [info ] [MainThread]: 
[0m18:57:22.121872 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:57:22.122446 [info ] [MainThread]: 
[0m18:57:22.123099 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m18:57:22.123746 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [13:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m18:57:22.124223 [info ] [MainThread]: 
[0m18:57:22.124816 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m18:57:22.125298 [info ] [MainThread]: 
[0m18:57:22.125835 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:57:22.126640 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:57:22.128312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3864236, "process_in_blocks": "0", "process_kernel_time": 0.809826, "process_mem_max_rss": "396028", "process_out_blocks": "3200", "process_user_time": 6.58866}
[0m18:57:22.129073 [debug] [MainThread]: Command `dbt run` failed at 18:57:22.128872 after 6.39 seconds
[0m18:57:22.130045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d7ac57090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d76b01d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d571584d0>]}
[0m18:57:22.130671 [debug] [MainThread]: Flushing usage events
[0m18:57:22.325790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:32.166927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb0800750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb07fa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb09d9bd0>]}


============================== 18:58:32.171521 | a2874af5-5004-4175-ac20-436ac3d99099 ==============================
[0m18:58:32.171521 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:58:32.172380 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_fact_orders', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:58:32.172977 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:58:32.173602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb07fa790>]}
[0m18:58:35.629293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd90ff59d0>]}
[0m18:58:35.716762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb3424990>]}
[0m18:58:35.717898 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:58:35.944280 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:58:36.121355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:36.122447 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:58:36.495742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd90918f90>]}
[0m18:58:36.611122 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:58:36.613968 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:58:36.632175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd909e4190>]}
[0m18:58:36.633037 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:58:36.633682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd90955b50>]}
[0m18:58:36.635829 [info ] [MainThread]: 
[0m18:58:36.636427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:36.636932 [info ] [MainThread]: 
[0m18:58:36.637830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:58:36.639875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:58:36.640635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:37.121804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:58:37.122667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:37.560151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd90947a90>]}
[0m18:58:37.561162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:37.568124 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:58:37.569086 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:58:37.569965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:58:37.570552 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:58:37.581118 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:58:37.582086 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:58:37.623050 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:58:37.624235 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        FARM_FINGERPRINT(CONCAT(
        COALESCE(CAST(product_id AS STRING), ''),
        COALESCE(CAST(order_id AS STRING), ''),
        COALESCE(CAST(device_id AS STRING), '')
    )) AS event_id,
        cast(order_id as int64) as order_id,
        cast(product_id as int64) as product_id,
        cast(store_id as int64) as store_id,
        cast(device_id as int64) as device_id,
        cast(price as numeric) as price,
        currency,
        is_paypal,
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:58:37.624909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:38.505580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:10f9bf7f-9c2e-4cce-a89d-3e66f42ff958&page=queryresults
[0m18:58:39.448535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2874af5-5004-4175-ac20-436ac3d99099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd90bbf9d0>]}
[0m18:58:39.449660 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.88s]
[0m18:58:39.450634 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:58:39.452965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:39.455247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:39.455881 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:58:39.456443 [info ] [MainThread]: 
[0m18:58:39.457071 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m18:58:39.458215 [debug] [MainThread]: Command end result
[0m18:58:39.490122 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:58:39.492855 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:58:39.500667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:58:39.501269 [info ] [MainThread]: 
[0m18:58:39.502002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:39.502520 [info ] [MainThread]: 
[0m18:58:39.503056 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:58:39.503856 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:58:39.505228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.412326, "process_in_blocks": "0", "process_kernel_time": 0.881472, "process_mem_max_rss": "398936", "process_out_blocks": "3208", "process_user_time": 6.594816}
[0m18:58:39.505882 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:39.505732 after 7.41 seconds
[0m18:58:39.506442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb07fa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb09d9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb4ad41d0>]}
[0m18:58:39.506981 [debug] [MainThread]: Flushing usage events
[0m18:58:39.681326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:38.995784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad753032d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad754b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad75302490>]}


============================== 18:59:39.000575 | be0f7ed9-4e09-499a-8fa6-7c80ba621736 ==============================
[0m18:59:39.000575 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:59:39.001813 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:59:39.002706 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:59:39.003560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7533e490>]}
[0m18:59:42.383166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad55ae9810>]}
[0m18:59:42.469117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad77e59250>]}
[0m18:59:42.470256 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:59:42.728536 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:59:42.902584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:42.903630 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:59:43.293067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad55309150>]}
[0m18:59:43.406617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:59:43.409461 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:59:43.428097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad54c5b750>]}
[0m18:59:43.428916 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m18:59:43.429506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad55303890>]}
[0m18:59:43.431688 [info ] [MainThread]: 
[0m18:59:43.432236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:43.432698 [info ] [MainThread]: 
[0m18:59:43.433493 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:59:43.435000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m18:59:43.435903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:43.901842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m18:59:43.902663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:44.348568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5533e710>]}
[0m18:59:44.349439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:44.356261 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:59:44.357262 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m18:59:44.358142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:59:44.358730 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:59:44.369399 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:59:44.370459 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:59:44.411518 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m18:59:44.412721 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with orders as (
    select
        FARM_FINGERPRINT(CONCAT(
        COALESCE(CAST(product_id AS STRING), ''),
        COALESCE(CAST(order_id AS STRING), ''),
        COALESCE(CAST(device_id AS STRING), '')
    )) AS event_id,
        cast(order_id as int64) as order_id
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from orders;


[0m18:59:44.413468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:45.123055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e41f59e9-5ed2-458e-a17b-d8a9cb863830&page=queryresults
[0m18:59:46.014787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0f7ed9-4e09-499a-8fa6-7c80ba621736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5591ec10>]}
[0m18:59:46.016012 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m18:59:46.016986 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:59:46.019247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:46.021613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:46.022152 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:59:46.022685 [info ] [MainThread]: 
[0m18:59:46.023287 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m18:59:46.024392 [debug] [MainThread]: Command end result
[0m18:59:46.053373 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:59:46.055850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:59:46.063852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:59:46.064400 [info ] [MainThread]: 
[0m18:59:46.065049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:46.065574 [info ] [MainThread]: 
[0m18:59:46.066126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:59:46.066945 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:59:46.068374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.147542, "process_in_blocks": "0", "process_kernel_time": 0.794267, "process_mem_max_rss": "400784", "process_out_blocks": "3200", "process_user_time": 6.703502}
[0m18:59:46.069019 [debug] [MainThread]: Command `dbt run` succeeded at 18:59:46.068878 after 7.15 seconds
[0m18:59:46.069556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad754b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7945f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad795202d0>]}
[0m18:59:46.070146 [debug] [MainThread]: Flushing usage events
[0m18:59:46.253329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:14.269151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72427e7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7242aa4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7242aa57d0>]}


============================== 09:29:14.274373 | 8dada51e-9b0d-415d-b2e5-e864750fef10 ==============================
[0m09:29:14.274373 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:29:14.275339 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt ', 'empty': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None'}
[0m09:29:14.425260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dada51e-9b0d-415d-b2e5-e864750fef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7242850090>]}
[0m09:29:14.447602 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:29:14.449187 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:29:14.450909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2565162, "process_in_blocks": "232", "process_kernel_time": 0.296277, "process_mem_max_rss": "102320", "process_out_blocks": "16", "process_user_time": 1.895378}
[0m09:29:14.451713 [debug] [MainThread]: Command `cli deps` succeeded at 09:29:14.451525 after 0.26 seconds
[0m09:29:14.452247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7246bbd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72426e80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7246bbd310>]}
[0m09:29:14.452798 [debug] [MainThread]: Flushing usage events
[0m09:29:14.648167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:58.401570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316e9ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316eca190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316efad10>]}


============================== 09:41:58.406050 | f2ff7cd8-511d-4cc1-ba74-c0c1ffac97c9 ==============================
[0m09:41:58.406050 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:41:58.406931 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'warn_error': 'None', 'version_check': 'True'}
[0m09:41:58.418670 [info ] [MainThread]: dbt version: 1.10.13
[0m09:41:58.419479 [info ] [MainThread]: python version: 3.11.2
[0m09:41:58.420081 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m09:41:58.420603 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m09:42:01.546611 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m09:42:01.547609 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m09:42:01.548159 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m09:42:01.548666 [info ] [MainThread]: adapter type: bigquery
[0m09:42:01.549142 [info ] [MainThread]: adapter version: 1.10.2
[0m09:42:01.687826 [info ] [MainThread]: Configuration:
[0m09:42:01.688515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:42:01.688984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:42:01.689404 [info ] [MainThread]: Required dependencies:
[0m09:42:01.689902 [debug] [MainThread]: Executing "git --help"
[0m09:42:01.692646 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:42:01.693268 [debug] [MainThread]: STDERR: "b''"
[0m09:42:01.693680 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:42:01.694145 [info ] [MainThread]: Connection:
[0m09:42:01.694749 [info ] [MainThread]:   method: service-account
[0m09:42:01.695217 [info ] [MainThread]:   database: project-data-engineer-469310
[0m09:42:01.695777 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m09:42:01.696304 [info ] [MainThread]:   schema: dbt_glramira
[0m09:42:01.696739 [info ] [MainThread]:   location: africa-south1
[0m09:42:01.697175 [info ] [MainThread]:   priority: interactive
[0m09:42:01.697607 [info ] [MainThread]:   maximum_bytes_billed: None
[0m09:42:01.698084 [info ] [MainThread]:   impersonate_service_account: None
[0m09:42:01.698525 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m09:42:01.699031 [info ] [MainThread]:   job_retries: 1
[0m09:42:01.699563 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m09:42:01.700105 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m09:42:01.700725 [info ] [MainThread]:   timeout_seconds: 300
[0m09:42:01.701549 [info ] [MainThread]:   client_id: None
[0m09:42:01.702358 [info ] [MainThread]:   token_uri: None
[0m09:42:01.703030 [info ] [MainThread]:   compute_region: None
[0m09:42:01.703730 [info ] [MainThread]:   dataproc_cluster_name: None
[0m09:42:01.704390 [info ] [MainThread]:   gcs_bucket: None
[0m09:42:01.705038 [info ] [MainThread]:   dataproc_batch: None
[0m09:42:01.705961 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:42:01.952849 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m09:42:01.953483 [debug] [MainThread]: On debug: select 1 as id
[0m09:42:01.953961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:04.402572 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:df661aed-6c97-49fa-bec2-789d52585956&page=queryresults
[0m09:42:05.260260 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:42:05.261189 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:42:05.262632 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.932896, "process_in_blocks": "0", "process_kernel_time": 0.654996, "process_mem_max_rss": "386976", "process_out_blocks": "32", "process_user_time": 5.456245}
[0m09:42:05.263330 [debug] [MainThread]: Command `dbt debug` succeeded at 09:42:05.263160 after 6.93 seconds
[0m09:42:05.263852 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:42:05.264431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31b03b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316e97a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f734f690>]}
[0m09:42:05.265032 [debug] [MainThread]: Flushing usage events
[0m09:42:05.501197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:24.643224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431b1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431e6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431e46d0>]}


============================== 09:53:24.647892 | 53867447-2f24-4e71-9d2d-d108f9413f8f ==============================
[0m09:53:24.647892 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:53:24.648778 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_dim_store', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m09:53:24.649409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:53:24.650040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431e6890>]}
[0m09:53:28.322391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc44029690>]}
[0m09:53:28.410077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45d3de10>]}
[0m09:53:28.411331 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:53:28.659697 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:53:28.831622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:28.832263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:28.895403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc234ab490>]}
[0m09:53:29.016828 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:53:29.019826 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:53:29.038527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc44eec390>]}
[0m09:53:29.039392 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m09:53:29.040025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc234aaf50>]}
[0m09:53:29.042227 [info ] [MainThread]: 
[0m09:53:29.042812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:29.043339 [info ] [MainThread]: 
[0m09:53:29.044291 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:29.046516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m09:53:29.047288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:29.532882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m09:53:29.533686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:30.013877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431bb890>]}
[0m09:53:30.014739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:30.022533 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_store
[0m09:53:30.023587 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_store ......................... [RUN]
[0m09:53:30.024420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_store)
[0m09:53:30.024979 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_store
[0m09:53:30.037714 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_store"
[0m09:53:30.038770 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_store
[0m09:53:30.080401 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_store"
[0m09:53:30.081430 [debug] [Thread-1 (]: On model.glramira.stg_dim_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_store"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  OPTIONS()
  as with orders as (
    select
        cast(store_id as int64) as store_id,
        concat('glamira_', cast(store_id as string)) as store_name
    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from orders;


[0m09:53:30.082070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:32.526827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2dcd6d50-0344-4464-8e0a-e12a2c8308b0&page=queryresults
[0m09:53:33.349001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53867447-2f24-4e71-9d2d-d108f9413f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2374e5d0>]}
[0m09:53:33.350086 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_store .................... [[32mCREATE VIEW (0 processed)[0m in 3.32s]
[0m09:53:33.351090 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_store
[0m09:53:33.353193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:33.355279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:33.355752 [debug] [MainThread]: Connection 'model.glramira.stg_dim_store' was properly closed.
[0m09:53:33.356213 [info ] [MainThread]: 
[0m09:53:33.356793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m09:53:33.357852 [debug] [MainThread]: Command end result
[0m09:53:33.392735 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:53:33.395140 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:53:33.403049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m09:53:33.403620 [info ] [MainThread]: 
[0m09:53:33.404339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:33.404872 [info ] [MainThread]: 
[0m09:53:33.405414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:53:33.406185 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:53:33.407570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.835969, "process_in_blocks": "0", "process_kernel_time": 1.141947, "process_mem_max_rss": "396824", "process_out_blocks": "2152", "process_user_time": 6.264981}
[0m09:53:33.408207 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:33.408054 after 8.84 seconds
[0m09:53:33.408717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431e6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc47336fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc473fc2d0>]}
[0m09:53:33.409247 [debug] [MainThread]: Flushing usage events
[0m09:53:33.639908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:39.600872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b05c9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b0775a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b05ca810>]}


============================== 09:55:39.605460 | 67384617-7ef1-430c-b478-27ecca34ef71 ==============================
[0m09:55:39.605460 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:55:39.606327 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_dim_store', 'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m09:55:39.606966 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:55:39.607638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b0775a90>]}
[0m09:55:43.065808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb390b09510>]}
[0m09:55:43.154338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b3161410>]}
[0m09:55:43.155439 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:55:43.386075 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:55:43.551785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:55:43.552424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:55:43.619704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3908ce390>]}
[0m09:55:43.741499 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:55:43.744273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:55:43.763540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb390cdda50>]}
[0m09:55:43.764436 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m09:55:43.765080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb390c29f10>]}
[0m09:55:43.767460 [info ] [MainThread]: 
[0m09:55:43.768089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:43.768600 [info ] [MainThread]: 
[0m09:55:43.769491 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:55:43.771578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m09:55:43.772387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:44.267657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m09:55:44.268512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:44.718914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39071b0d0>]}
[0m09:55:44.719969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:44.727219 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_store
[0m09:55:44.728205 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_store ......................... [RUN]
[0m09:55:44.729085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_store)
[0m09:55:44.729651 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_store
[0m09:55:44.742855 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_store"
[0m09:55:44.743919 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_store
[0m09:55:44.786105 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_store"
[0m09:55:44.787264 [debug] [Thread-1 (]: On model.glramira.stg_dim_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_store"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  OPTIONS()
  as with orders as (
    select distinct
        cast(store_id as int64) as store_id,
        concat('glamira_', cast(store_id as string)) as store_name
    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from orders;


[0m09:55:44.787985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:45.548797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:30401ab7-be29-4e54-bebe-7e050bbf3ac3&page=queryresults
[0m09:55:46.957075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67384617-7ef1-430c-b478-27ecca34ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3906a9c10>]}
[0m09:55:46.958266 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_store .................... [[32mCREATE VIEW (0 processed)[0m in 2.23s]
[0m09:55:46.959284 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_store
[0m09:55:46.961493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:46.963826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:46.964421 [debug] [MainThread]: Connection 'model.glramira.stg_dim_store' was properly closed.
[0m09:55:46.965001 [info ] [MainThread]: 
[0m09:55:46.965644 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m09:55:46.966950 [debug] [MainThread]: Command end result
[0m09:55:46.999747 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:55:47.003359 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:55:47.011021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m09:55:47.011630 [info ] [MainThread]: 
[0m09:55:47.012332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:47.012856 [info ] [MainThread]: 
[0m09:55:47.013408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:55:47.014214 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:55:47.015581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4884467, "process_in_blocks": "0", "process_kernel_time": 0.929861, "process_mem_max_rss": "395428", "process_out_blocks": "2152", "process_user_time": 6.383136}
[0m09:55:47.016240 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:47.016094 after 7.49 seconds
[0m09:55:47.016789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b0432ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b0431990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b48143d0>]}
[0m09:55:47.017479 [debug] [MainThread]: Flushing usage events
[0m09:55:47.204248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:04:44.317780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38cc7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38d22dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3915b8d0>]}


============================== 10:04:44.322366 | f856db46-ce99-49c0-a6ab-b1138ce7e665 ==============================
[0m10:04:44.322366 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:04:44.323175 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -m stg_dim_product', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None'}
[0m10:04:44.323846 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:04:44.324433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38d21bd0>]}
[0m10:04:47.713688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b19311190>]}
[0m10:04:47.798151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3b859a10>]}
[0m10:04:47.799252 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:04:48.101037 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:04:48.262680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:48.263307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:48.327161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18f67990>]}
[0m10:04:48.441542 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:04:48.444292 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:04:48.462664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18f39110>]}
[0m10:04:48.463592 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:04:48.464288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b193de010>]}
[0m10:04:48.466557 [info ] [MainThread]: 
[0m10:04:48.467254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:04:48.467812 [info ] [MainThread]: 
[0m10:04:48.468725 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:04:48.470365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:04:48.471277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:48.993535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:04:48.994365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:49.452187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3b090ad0>]}
[0m10:04:49.453052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:49.460518 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:04:49.461554 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:04:49.462413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:04:49.462999 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:04:49.474139 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:04:49.475188 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:04:49.515147 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:04:49.516376 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select distinct
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as float) as product_price,
        cast(min_price as float) as min_price,
        cast(max_price as float) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format

)
select * from products
where product_id <> '101993';


[0m10:04:49.517036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:50.375127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:247263e2-ec61-44d4-9ea1-8b1ababf87fe&page=queryresults
[0m10:04:51.165170 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:247263e2-ec61-44d4-9ea1-8b1ababf87fe&page=queryresults
[0m10:04:51.217017 [debug] [Thread-1 (]: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Query without FROM clause cannot use SELECT DISTINCT at [7:5]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:04:51.219731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856db46-ce99-49c0-a6ab-b1138ce7e665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18eee150>]}
[0m10:04:51.220931 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_product .............. [[31mERROR[0m in 1.76s]
[0m10:04:51.222059 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:04:51.222972 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_product' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Query without FROM clause cannot use SELECT DISTINCT at [7:5]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql.
[0m10:04:51.226255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:51.229730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:51.230506 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:04:51.231232 [info ] [MainThread]: 
[0m10:04:51.232008 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m10:04:51.233400 [debug] [MainThread]: Command end result
[0m10:04:51.288768 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:04:51.292492 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:04:51.304968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:04:51.305812 [info ] [MainThread]: 
[0m10:04:51.306697 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:04:51.307490 [info ] [MainThread]: 
[0m10:04:51.308353 [error] [MainThread]: [31mFailure in model stg_dim_product (models/staging/stg_dim_product.sql)[0m
[0m10:04:51.309186 [error] [MainThread]:   Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Query without FROM clause cannot use SELECT DISTINCT at [7:5]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:04:51.309934 [info ] [MainThread]: 
[0m10:04:51.310730 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_product.sql
[0m10:04:51.311420 [info ] [MainThread]: 
[0m10:04:51.312130 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:04:51.313255 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:04:51.315153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0738525, "process_in_blocks": "168", "process_kernel_time": 0.84532, "process_mem_max_rss": "392644", "process_out_blocks": "2160", "process_user_time": 6.339602}
[0m10:04:51.316149 [debug] [MainThread]: Command `dbt run` failed at 10:04:51.315930 after 7.08 seconds
[0m10:04:51.316986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ce5b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38cfa350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cfa4510>]}
[0m10:04:51.317811 [debug] [MainThread]: Flushing usage events
[0m10:04:51.538392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:01.993939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea6d2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea7365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea8861d0>]}


============================== 10:06:01.998233 | cdb29ccc-fbcc-41e0-8b18-29a29b38f495 ==============================
[0m10:06:01.998233 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:06:01.999121 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'invocation_command': 'dbt run -m stg_dim_product', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m10:06:01.999790 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:06:02.000495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea718710>]}
[0m10:06:05.346107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cad7b0d0>]}
[0m10:06:05.430314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ed255790>]}
[0m10:06:05.431431 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:06:05.677233 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:06:05.836056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:05.836694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:05.899289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ca9c51d0>]}
[0m10:06:06.016688 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:06:06.019542 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:06:06.038565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cac4f910>]}
[0m10:06:06.039726 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:06:06.040386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ca915c90>]}
[0m10:06:06.042592 [info ] [MainThread]: 
[0m10:06:06.043212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:06:06.043766 [info ] [MainThread]: 
[0m10:06:06.044585 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:06:06.046151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:06:06.046876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:06.531858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:06:06.532712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:06.996040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cac6ba90>]}
[0m10:06:06.996926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:07.006674 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:06:07.007724 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:06:07.008642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:06:07.009216 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:06:07.020385 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:06:07.021411 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:06:07.061045 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:06:07.062196 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as float) as product_price,
        cast(min_price as float) as min_price,
        cast(max_price as float) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format

)
select * from products
where product_id <> '101993';


[0m10:06:07.062916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:07.777243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8968dcb7-d28f-4fa3-9bc9-c7a6c219209f&page=queryresults
[0m10:06:08.057453 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8968dcb7-d28f-4fa3-9bc9-c7a6c219209f&page=queryresults
[0m10:06:08.067901 [debug] [Thread-1 (]: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Unrecognized name: product_id at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:06:08.070250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb29ccc-fbcc-41e0-8b18-29a29b38f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ca711910>]}
[0m10:06:08.071298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_product .............. [[31mERROR[0m in 1.06s]
[0m10:06:08.072282 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:06:08.073137 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_product' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Unrecognized name: product_id at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql.
[0m10:06:08.076191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:08.078738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:08.079247 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:06:08.079930 [info ] [MainThread]: 
[0m10:06:08.080556 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m10:06:08.081564 [debug] [MainThread]: Command end result
[0m10:06:08.116908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:06:08.119617 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:06:08.127076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:06:08.127673 [info ] [MainThread]: 
[0m10:06:08.128354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:06:08.128984 [info ] [MainThread]: 
[0m10:06:08.129648 [error] [MainThread]: [31mFailure in model stg_dim_product (models/staging/stg_dim_product.sql)[0m
[0m10:06:08.130263 [error] [MainThread]:   Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Unrecognized name: product_id at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:06:08.130791 [info ] [MainThread]: 
[0m10:06:08.131386 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_product.sql
[0m10:06:08.131978 [info ] [MainThread]: 
[0m10:06:08.132524 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:06:08.133402 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:06:08.135032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2140503, "process_in_blocks": "0", "process_kernel_time": 0.823568, "process_mem_max_rss": "392568", "process_out_blocks": "2168", "process_user_time": 6.21676}
[0m10:06:08.135832 [debug] [MainThread]: Command `dbt run` failed at 10:06:08.135677 after 6.22 seconds
[0m10:06:08.136403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77eeb6e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cac75990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ee89b250>]}
[0m10:06:08.136920 [debug] [MainThread]: Flushing usage events
[0m10:06:08.336592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:39.728658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f2c2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f561cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f2c3210>]}


============================== 10:07:39.733204 | 9b1f79b2-5949-45e9-a071-535795d0e750 ==============================
[0m10:07:39.733204 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:07:39.734033 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m stg_dim_product', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False'}
[0m10:07:39.734659 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:07:39.735247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f2c27d0>]}
[0m10:07:43.158363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f2d85d0>]}
[0m10:07:43.242087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f912410>]}
[0m10:07:43.243125 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:07:43.478394 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:07:43.638800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:43.639467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:43.705823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f56e4d0>]}
[0m10:07:43.823160 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:07:43.825848 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:07:43.844488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f533c90>]}
[0m10:07:43.845323 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:07:43.845920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f4cda90>]}
[0m10:07:43.848198 [info ] [MainThread]: 
[0m10:07:43.848791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:43.849331 [info ] [MainThread]: 
[0m10:07:43.850157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:07:43.851649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:07:43.852313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:44.320879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:07:44.321820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:44.773292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f532790>]}
[0m10:07:44.774195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:44.783857 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:07:44.784824 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:07:44.785653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:07:44.786255 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:07:44.798908 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:07:44.800144 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:07:44.840163 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:07:44.841390 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as float) as product_price,
        cast(min_price as float) as min_price,
        cast(max_price as float) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format
    from `project-data-engineer-469310`.`product_info`.`product`

)
select * from products
where product_id <> '101993';


[0m10:07:44.842105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:45.710163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fa4793b3-72e8-4cdd-bdf1-56632cc16df4&page=queryresults
[0m10:07:45.985853 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fa4793b3-72e8-4cdd-bdf1-56632cc16df4&page=queryresults
[0m10:07:45.996413 [debug] [Thread-1 (]: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Type not found: float at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:07:45.998890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f79b2-5949-45e9-a071-535795d0e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f68aa50>]}
[0m10:07:45.999978 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_product .............. [[31mERROR[0m in 1.21s]
[0m10:07:46.001160 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:07:46.002182 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_product' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Type not found: float at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql.
[0m10:07:46.005274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:46.007821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:46.008454 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:07:46.009011 [info ] [MainThread]: 
[0m10:07:46.009548 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m10:07:46.010522 [debug] [MainThread]: Command end result
[0m10:07:46.045158 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:07:46.047815 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:07:46.055487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:07:46.056097 [info ] [MainThread]: 
[0m10:07:46.056741 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:07:46.057272 [info ] [MainThread]: 
[0m10:07:46.057903 [error] [MainThread]: [31mFailure in model stg_dim_product (models/staging/stg_dim_product.sql)[0m
[0m10:07:46.058498 [error] [MainThread]:   Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  Type not found: float at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:07:46.058981 [info ] [MainThread]: 
[0m10:07:46.059633 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_product.sql
[0m10:07:46.060139 [info ] [MainThread]: 
[0m10:07:46.060657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:07:46.061467 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:07:46.062823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.405853, "process_in_blocks": "0", "process_kernel_time": 0.825059, "process_mem_max_rss": "392360", "process_out_blocks": "2160", "process_user_time": 6.227938}
[0m10:07:46.063510 [debug] [MainThread]: Command `dbt run` failed at 10:07:46.063328 after 6.41 seconds
[0m10:07:46.064082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023f561d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021f917490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0243605110>]}
[0m10:07:46.064622 [debug] [MainThread]: Flushing usage events
[0m10:07:46.265592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:12.335409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be0ae4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be0c91a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be0ae7410>]}


============================== 10:09:12.339808 | 5ce3d95c-526d-495c-abba-e46f5cbadfe6 ==============================
[0m10:09:12.339808 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:09:12.340699 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run -m stg_dim_product', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'empty': 'False'}
[0m10:09:12.341302 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:09:12.341898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be0ae5b50>]}
[0m10:09:15.725957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc13f12d0>]}
[0m10:09:15.809856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be375d750>]}
[0m10:09:15.811016 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:09:16.039751 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:09:16.197108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:16.197737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:16.260543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc0e47a10>]}
[0m10:09:16.378017 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:09:16.380739 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:09:16.399214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc127ae90>]}
[0m10:09:16.400071 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:09:16.400748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc0f8d010>]}
[0m10:09:16.403013 [info ] [MainThread]: 
[0m10:09:16.403676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:09:16.404190 [info ] [MainThread]: 
[0m10:09:16.405032 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:16.409121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:09:16.409884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:16.880770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:09:16.881582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:17.326239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be2fb0f90>]}
[0m10:09:17.327069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:17.336109 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:09:17.337124 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:09:17.338033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:09:17.338627 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:09:17.351565 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:09:17.352563 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:09:17.393213 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:09:17.394312 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as int64) as product_price,
        cast(min_price as int64) as min_price,
        cast(max_price as int64) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format
    from `project-data-engineer-469310`.`product_info`.`product`

)
select * from products
where product_id <> '101993';


[0m10:09:17.395026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:18.149826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8d79c8fc-ac1a-4252-be25-5413574a025b&page=queryresults
[0m10:09:18.431236 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8d79c8fc-ac1a-4252-be25-5413574a025b&page=queryresults
[0m10:09:18.441795 [debug] [Thread-1 (]: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:09:18.444692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce3d95c-526d-495c-abba-e46f5cbadfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc0c6e410>]}
[0m10:09:18.445777 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_product .............. [[31mERROR[0m in 1.10s]
[0m10:09:18.446759 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:09:18.447665 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_product' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql.
[0m10:09:18.450705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:18.453164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:18.453722 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:09:18.454204 [info ] [MainThread]: 
[0m10:09:18.454763 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m10:09:18.455826 [debug] [MainThread]: Command end result
[0m10:09:18.490489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:09:18.493219 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:09:18.501253 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:09:18.501865 [info ] [MainThread]: 
[0m10:09:18.502511 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:09:18.503045 [info ] [MainThread]: 
[0m10:09:18.503703 [error] [MainThread]: [31mFailure in model stg_dim_product (models/staging/stg_dim_product.sql)[0m
[0m10:09:18.504310 [error] [MainThread]:   Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:09:18.504842 [info ] [MainThread]: 
[0m10:09:18.505435 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_product.sql
[0m10:09:18.505905 [info ] [MainThread]: 
[0m10:09:18.506451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:09:18.507290 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:09:18.508909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2460065, "process_in_blocks": "0", "process_kernel_time": 0.687832, "process_mem_max_rss": "392600", "process_out_blocks": "2160", "process_user_time": 6.389834}
[0m10:09:18.509843 [debug] [MainThread]: Command `dbt run` failed at 10:09:18.509661 after 6.25 seconds
[0m10:09:18.510628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be4d97250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be4d971d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3be4d97290>]}
[0m10:09:18.511227 [debug] [MainThread]: Flushing usage events
[0m10:09:18.711994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:50.250934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9956007c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99561ae550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9956007050>]}


============================== 10:09:50.255271 | 59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b ==============================
[0m10:09:50.255271 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:09:50.256226 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'static_parser': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -m stg_dim_product', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m10:09:50.256870 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:09:50.257516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99561ae450>]}
[0m10:09:53.610285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995600d890>]}
[0m10:09:53.693900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9958be4190>]}
[0m10:09:53.694966 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:09:53.926926 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:09:54.092327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:54.093015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:54.156311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99362b5f90>]}
[0m10:09:54.275604 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:09:54.278464 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:09:54.298096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993669fa50>]}
[0m10:09:54.299110 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:09:54.299864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9936233ad0>]}
[0m10:09:54.302190 [info ] [MainThread]: 
[0m10:09:54.302821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:09:54.303358 [info ] [MainThread]: 
[0m10:09:54.304276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:54.306566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:09:54.307857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:54.799150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:09:54.800171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:55.247066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99366c7a50>]}
[0m10:09:55.247943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:55.257718 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:09:55.258836 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:09:55.259752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:09:55.260336 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:09:55.273673 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:09:55.274703 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:09:55.315142 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:09:55.316385 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as int64) as product_price,
        cast(min_price as int64) as min_price,
        cast(max_price as int64) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format
    from `project-data-engineer-469310`.`product_info`.`product`

)
select * from products
where product_id != '101993';


[0m10:09:55.317140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:56.191345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:af91a774-e44b-4f7c-aaf4-0b7230cc679a&page=queryresults
[0m10:09:56.638665 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:af91a774-e44b-4f7c-aaf4-0b7230cc679a&page=queryresults
[0m10:09:56.648810 [debug] [Thread-1 (]: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:09:56.651317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d0a6ee-33c9-4008-9c50-ebdb1b7f3f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993637b650>]}
[0m10:09:56.652479 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_product .............. [[31mERROR[0m in 1.39s]
[0m10:09:56.653379 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:09:56.654230 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_product' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql.
[0m10:09:56.657245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:56.659775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:56.660446 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:09:56.661024 [info ] [MainThread]: 
[0m10:09:56.661652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m10:09:56.662673 [debug] [MainThread]: Command end result
[0m10:09:56.698173 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:09:56.700966 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:09:56.709122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:09:56.709697 [info ] [MainThread]: 
[0m10:09:56.710386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:09:56.710980 [info ] [MainThread]: 
[0m10:09:56.711647 [error] [MainThread]: [31mFailure in model stg_dim_product (models/staging/stg_dim_product.sql)[0m
[0m10:09:56.712278 [error] [MainThread]:   Database Error in model stg_dim_product (models/staging/stg_dim_product.sql)
  No matching signature for operator != for argument types: INT64, STRING
    Signature: T1 != T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [19:7]
  compiled code at target/run/glramira/models/staging/stg_dim_product.sql
[0m10:09:56.712768 [info ] [MainThread]: 
[0m10:09:56.713379 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_product.sql
[0m10:09:56.713856 [info ] [MainThread]: 
[0m10:09:56.714480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:09:56.715312 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:09:56.716772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5381546, "process_in_blocks": "0", "process_kernel_time": 0.770492, "process_mem_max_rss": "392476", "process_out_blocks": "2160", "process_user_time": 6.376543}
[0m10:09:56.717581 [debug] [MainThread]: Command `dbt run` failed at 10:09:56.717428 after 6.54 seconds
[0m10:09:56.718171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9955e732d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99367cf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993476e710>]}
[0m10:09:56.718732 [debug] [MainThread]: Flushing usage events
[0m10:09:56.886754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:17.467019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de49ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de641a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de49add0>]}


============================== 10:10:17.471518 | cd197a13-7c21-4c26-83eb-78c016679d2e ==============================
[0m10:10:17.471518 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:10:17.472348 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt run -m stg_dim_product', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'log_format': 'default'}
[0m10:10:17.472954 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:10:17.473548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de4a13d0>]}
[0m10:10:20.833127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de4d7990>]}
[0m10:10:20.917553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5e1059890>]}
[0m10:10:20.918652 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:10:21.147916 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:10:21.305915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:21.306610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:21.370789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be71fb10>]}
[0m10:10:21.490835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:10:21.493666 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:10:21.512196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be71f4d0>]}
[0m10:10:21.513076 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m10:10:21.513656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be68bf10>]}
[0m10:10:21.515810 [info ] [MainThread]: 
[0m10:10:21.516434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:21.516924 [info ] [MainThread]: 
[0m10:10:21.517794 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:10:21.519262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m10:10:21.520075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:21.999834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m10:10:22.000792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:22.457251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5bebadd10>]}
[0m10:10:22.458070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:22.465069 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_product
[0m10:10:22.465956 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m10:10:22.466787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_product)
[0m10:10:22.467451 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_product
[0m10:10:22.479927 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m10:10:22.480869 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_product
[0m10:10:22.520843 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m10:10:22.521931 [debug] [Thread-1 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as with products as (
    select
        cast(product_id as int64) as product_id,
        cast(product_name as string) as product_name,
        cast(product_price as int64) as product_price,
        cast(min_price as int64) as min_price,
        cast(max_price as int64) as max_price,
        cast(min_price_format as string) as min_price_format,
        cast(max_price_format as string) as max_price_format
    from `project-data-engineer-469310`.`product_info`.`product`

)
select * from products
where product_id != 101993;


[0m10:10:22.522602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:23.720131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e46dca7b-06ca-4ba7-b08d-7feb5f9e96fd&page=queryresults
[0m10:10:24.528003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd197a13-7c21-4c26-83eb-78c016679d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be8837d0>]}
[0m10:10:24.529079 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_product .................. [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m10:10:24.530008 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_product
[0m10:10:24.532497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:24.534652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:24.535233 [debug] [MainThread]: Connection 'model.glramira.stg_dim_product' was properly closed.
[0m10:10:24.535820 [info ] [MainThread]: 
[0m10:10:24.536390 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m10:10:24.537742 [debug] [MainThread]: Command end result
[0m10:10:24.570714 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m10:10:24.573242 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m10:10:24.582611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m10:10:24.583169 [info ] [MainThread]: 
[0m10:10:24.583867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:24.584418 [info ] [MainThread]: 
[0m10:10:24.584970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:10:24.585777 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:10:24.587107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.193792, "process_in_blocks": "0", "process_kernel_time": 0.863951, "process_mem_max_rss": "396608", "process_out_blocks": "2152", "process_user_time": 6.238636}
[0m10:10:24.587750 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:24.587613 after 7.19 seconds
[0m10:10:24.588298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de4d65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5de50bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5e26fc3d0>]}
[0m10:10:24.588832 [debug] [MainThread]: Flushing usage events
[0m10:10:24.770405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:32.080603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2943cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd294579950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd294579ed0>]}


============================== 12:05:32.086894 | 6efe3ce9-caa0-43f0-a422-c0551f8e1638 ==============================
[0m12:05:32.086894 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:05:32.087833 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_dim_date', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True'}
[0m12:05:32.088512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:05:32.089172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29443b290>]}
[0m12:05:36.538185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274a3be90>]}
[0m12:05:36.624697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd297045210>]}
[0m12:05:36.625835 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:05:36.867947 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:05:37.042093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:37.042693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:37.106363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2747988d0>]}
[0m12:05:37.228023 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:05:37.231330 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:05:37.250591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd296a95d50>]}
[0m12:05:37.251505 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:05:37.252083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27474f7d0>]}
[0m12:05:37.254298 [info ] [MainThread]: 
[0m12:05:37.254867 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:37.255403 [info ] [MainThread]: 
[0m12:05:37.256252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:37.257879 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:05:37.258570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:37.797617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:05:37.798525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:38.267334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274683510>]}
[0m12:05:38.268286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:38.276717 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m12:05:38.277850 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m12:05:38.278754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m12:05:38.279410 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m12:05:38.292632 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m12:05:38.293655 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m12:05:38.336608 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m12:05:38.337704 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as with date as (
    select
        cast(format_timestamp('%m%d%Y', time_stamp) as int64) as date_id,
        format_timestamp('%m/%d/%Y', time_stamp) as full_date,
        cast(format_timestamp('%d', time_stamp) as int64) as day,
        cast(format_timestamp('%m', time_stamp) as int64) as month,
        cast(format_timestamp('%Y', time_stamp) as int64) as year,
        cast(EXTRACT(DAYOFWEEK FROM time_stamp) IN (1,7) AS boolean) AS is_weekend
    from `project-data-engineer-469310`.`product_info`.`event`

)
select * from date;


[0m12:05:38.338405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:39.612205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bc79f6a6-9e7d-411e-927a-52454e7d803e&page=queryresults
[0m12:05:40.412620 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bc79f6a6-9e7d-411e-927a-52454e7d803e&page=queryresults
[0m12:05:40.424939 [debug] [Thread-1 (]: Database Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  No matching signature for function FORMAT_TIMESTAMP
    Argument types: STRING, INT64
    Signature: FORMAT_TIMESTAMP(STRING, TIMESTAMP, [STRING])
      Argument 2: Unable to coerce type INT64 to expected type TIMESTAMP
    Signature: FORMAT_TIMESTAMP(STRING, DATETIME)
      Argument 2: Unable to coerce type INT64 to expected type DATETIME at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_date.sql
[0m12:05:40.427533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efe3ce9-caa0-43f0-a422-c0551f8e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274779490>]}
[0m12:05:40.428673 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_date ................. [[31mERROR[0m in 2.15s]
[0m12:05:40.429564 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m12:05:40.430496 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_date' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  No matching signature for function FORMAT_TIMESTAMP
    Argument types: STRING, INT64
    Signature: FORMAT_TIMESTAMP(STRING, TIMESTAMP, [STRING])
      Argument 2: Unable to coerce type INT64 to expected type TIMESTAMP
    Signature: FORMAT_TIMESTAMP(STRING, DATETIME)
      Argument 2: Unable to coerce type INT64 to expected type DATETIME at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_date.sql.
[0m12:05:40.433671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:40.436297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:40.436918 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m12:05:40.437666 [info ] [MainThread]: 
[0m12:05:40.438277 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m12:05:40.439261 [debug] [MainThread]: Command end result
[0m12:05:40.476155 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:05:40.478926 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:05:40.487083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:05:40.487751 [info ] [MainThread]: 
[0m12:05:40.488386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:05:40.488970 [info ] [MainThread]: 
[0m12:05:40.489637 [error] [MainThread]: [31mFailure in model stg_dim_date (models/staging/stg_dim_date.sql)[0m
[0m12:05:40.490237 [error] [MainThread]:   Database Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  No matching signature for function FORMAT_TIMESTAMP
    Argument types: STRING, INT64
    Signature: FORMAT_TIMESTAMP(STRING, TIMESTAMP, [STRING])
      Argument 2: Unable to coerce type INT64 to expected type TIMESTAMP
    Signature: FORMAT_TIMESTAMP(STRING, DATETIME)
      Argument 2: Unable to coerce type INT64 to expected type DATETIME at [8:14]
  compiled code at target/run/glramira/models/staging/stg_dim_date.sql
[0m12:05:40.490827 [info ] [MainThread]: 
[0m12:05:40.491472 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_date.sql
[0m12:05:40.491922 [info ] [MainThread]: 
[0m12:05:40.492420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:05:40.493192 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:05:40.494493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.491044, "process_in_blocks": "6784", "process_kernel_time": 1.577665, "process_mem_max_rss": "391284", "process_out_blocks": "2160", "process_user_time": 6.497215}
[0m12:05:40.495322 [debug] [MainThread]: Command `dbt run` failed at 12:05:40.495165 after 8.49 seconds
[0m12:05:40.495982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29868b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd294579ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270c51090>]}
[0m12:05:40.496570 [debug] [MainThread]: Flushing usage events
[0m12:05:40.691437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:09.216620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b20a07ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21a0f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b20a072d0>]}


============================== 12:11:09.223064 | f5225406-8e3c-4656-9749-ba1c9a99f093 ==============================
[0m12:11:09.223064 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:11:09.224352 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_dim_date', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False'}
[0m12:11:09.225272 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:11:09.226141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b20bba1d0>]}
[0m12:11:12.785723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b20a3b290>]}
[0m12:11:12.872486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b235e1510>]}
[0m12:11:12.873568 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:11:13.108114 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:11:13.267253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:13.267922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:13.331286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b00c60050>]}
[0m12:11:13.448972 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:11:13.451954 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:11:13.469808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b01001990>]}
[0m12:11:13.470671 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:11:13.471356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0105c650>]}
[0m12:11:13.473535 [info ] [MainThread]: 
[0m12:11:13.474108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:13.474580 [info ] [MainThread]: 
[0m12:11:13.475437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:13.477018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:11:13.477794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:13.972931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:11:13.973777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:14.440402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b00abead0>]}
[0m12:11:14.441372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:14.449032 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m12:11:14.450038 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m12:11:14.451074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m12:11:14.451706 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m12:11:14.465253 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m12:11:14.466403 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m12:11:14.507774 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m12:11:14.509025 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as with date as (
    select
        cast(format_timestamp('%m%d%Y', timestamp_millis(time_stamp)) as int64) as date_id,
        format_timestamp('%m/%d/%Y', timestamp_millis(time_stamp)) as full_date,
        cast(format_timestamp('%d', timestamp_millis(time_stamp)) as int64) as day,
        cast(format_timestamp('%m', timestamp_millis(time_stamp)) as int64) as month,
        cast(format_timestamp('%Y', timestamp_millis(time_stamp)) as int64) as year,
        cast(EXTRACT(DAYOFWEEK FROM timestamp_millis(time_stamp)) IN (1,7) AS boolean) AS is_weekend
    from `project-data-engineer-469310`.`product_info`.`event`

)
select * from date;


[0m12:11:14.509792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:15.779602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f813094e-fb7f-4fc7-8c6e-ea8eacac08a9&page=queryresults
[0m12:11:16.592157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5225406-8e3c-4656-9749-ba1c9a99f093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03fc9090>]}
[0m12:11:16.593316 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_date ..................... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m12:11:16.594360 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m12:11:16.596855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:16.599219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:16.599855 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m12:11:16.600408 [info ] [MainThread]: 
[0m12:11:16.601089 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m12:11:16.602430 [debug] [MainThread]: Command end result
[0m12:11:16.637218 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:11:16.639953 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:11:16.647813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:11:16.648381 [info ] [MainThread]: 
[0m12:11:16.649062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:16.649552 [info ] [MainThread]: 
[0m12:11:16.650105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:11:16.650899 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:11:16.652358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.509728, "process_in_blocks": "0", "process_kernel_time": 0.841252, "process_mem_max_rss": "396476", "process_out_blocks": "2160", "process_user_time": 6.424962}
[0m12:11:16.653036 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:16.652884 after 7.51 seconds
[0m12:11:16.653590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b24bbf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b24bbf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21922c50>]}
[0m12:11:16.654254 [debug] [MainThread]: Flushing usage events
[0m12:11:16.849218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:42.835869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd2efb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd2efaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd2ef9850>]}


============================== 12:13:42.840527 | bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f ==============================
[0m12:13:42.840527 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:13:42.841415 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_dim_date', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m12:13:42.842066 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:13:42.842709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd2ed08d0>]}
[0m12:13:46.279710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db35c0590>]}
[0m12:13:46.364254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd5a548d0>]}
[0m12:13:46.365314 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:13:46.607975 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:13:46.774121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:46.774720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:46.838126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db31958d0>]}
[0m12:13:46.958492 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:13:46.961340 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:13:46.979613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db3295e50>]}
[0m12:13:46.980435 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:13:46.981009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db3160090>]}
[0m12:13:46.982961 [info ] [MainThread]: 
[0m12:13:46.983495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:46.983916 [info ] [MainThread]: 
[0m12:13:46.984623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:13:46.986121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:13:46.986962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:47.477703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:13:47.478600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:47.933688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db35aa490>]}
[0m12:13:47.934833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:47.944414 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m12:13:47.945407 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m12:13:47.946316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m12:13:47.946936 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m12:13:47.960498 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m12:13:47.961637 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m12:13:48.004680 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m12:13:48.005926 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as with date as (
    select distinct
        cast(format_timestamp('%m%d%Y', timestamp_seconds(time_stamp)) as int64) as date_id,
        format_timestamp('%m/%d/%Y', timestamp_seconds(time_stamp)) as full_date,
        cast(format_timestamp('%d', timestamp_seconds(time_stamp)) as int64) as day,
        cast(format_timestamp('%m', timestamp_seconds(time_stamp)) as int64) as month,
        cast(format_timestamp('%Y', timestamp_seconds(time_stamp)) as int64) as year,
        cast(EXTRACT(DAYOFWEEK FROM timestamp_seconds(time_stamp)) IN (1,7) AS boolean) AS is_weekend
    from `project-data-engineer-469310`.`product_info`.`event`

)
select * from date;


[0m12:13:48.006720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:48.877725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b1cbce43-3e98-44ac-ae29-f6653d4d9bb3&page=queryresults
[0m12:13:49.511196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe829d2-6ba5-4ede-b4e8-f89e991b5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db2f929d0>]}
[0m12:13:49.512512 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_date ..................... [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m12:13:49.513785 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m12:13:49.516328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:49.518672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:49.519134 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m12:13:49.519909 [info ] [MainThread]: 
[0m12:13:49.520565 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m12:13:49.521810 [debug] [MainThread]: Command end result
[0m12:13:49.555900 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:13:49.558582 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:13:49.566134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:13:49.566709 [info ] [MainThread]: 
[0m12:13:49.567439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:49.567906 [info ] [MainThread]: 
[0m12:13:49.568433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:13:49.569247 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:13:49.570617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.808995, "process_in_blocks": "0", "process_kernel_time": 0.797435, "process_mem_max_rss": "396660", "process_out_blocks": "2152", "process_user_time": 6.384392}
[0m12:13:49.571293 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:49.571122 after 6.81 seconds
[0m12:13:49.571869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd314c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd30421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd703b090>]}
[0m12:13:49.572424 [debug] [MainThread]: Flushing usage events
[0m12:13:49.784225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:49.434526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca484321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca48432dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca48433fd0>]}


============================== 12:38:49.439589 | 2cea1711-add5-4f9e-84c4-e0633381a751 ==============================
[0m12:38:49.439589 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:49.440600 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m stg_dim_device', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'cache_selected_only': 'False'}
[0m12:38:49.441249 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:38:49.441976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca48431990>]}
[0m12:38:52.970549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28b33f90>]}
[0m12:38:53.057317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b1618d0>]}
[0m12:38:53.058396 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:38:53.296018 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:53.466160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:53.466864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:53.531052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca288aff50>]}
[0m12:38:53.651823 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:38:53.654457 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:38:53.673397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca288cda90>]}
[0m12:38:53.674196 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:38:53.674820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca288ac950>]}
[0m12:38:53.677019 [info ] [MainThread]: 
[0m12:38:53.677659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:53.678171 [info ] [MainThread]: 
[0m12:38:53.679037 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:38:53.681218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:38:53.682053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:54.186555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:38:54.187419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:54.648302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca486eb510>]}
[0m12:38:54.649098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:54.655405 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:38:54.656278 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:38:54.657107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:38:54.657631 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:38:54.670918 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:38:54.671916 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:38:54.711504 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:38:54.712686 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        -- Tạo surrogate key từ user_agent + resolution + raw_device_id
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(raw_device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(raw_device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Device model
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone') THEN 'iPhone'
            WHEN REGEXP_CONTAINS(user_agent, r'iPad') THEN 'iPad'
            WHEN REGEXP_CONTAINS(user_agent, r'Macintosh') THEN 'Mac'
            WHEN REGEXP_CONTAINS(user_agent, r'Windows') THEN 'PC'
            ELSE 'Unknown'
        END AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;;


[0m12:38:54.713443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:55.551900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:cb55ed57-3898-427d-90bb-78950fc6bf52&page=queryresults
[0m12:38:55.552977 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:cb55ed57-3898-427d-90bb-78950fc6bf52&page=queryresults
[0m12:38:55.562365 [debug] [Thread-1 (]: Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Unexpected ";" at [55:22]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql
[0m12:38:55.564656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cea1711-add5-4f9e-84c4-e0633381a751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca286cb650>]}
[0m12:38:55.565848 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_device ............... [[31mERROR[0m in 0.91s]
[0m12:38:55.566713 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:38:55.567629 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_device' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Unexpected ";" at [55:22]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql.
[0m12:38:55.570505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:55.572763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:55.573217 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:38:55.573686 [info ] [MainThread]: 
[0m12:38:55.574151 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m12:38:55.575076 [debug] [MainThread]: Command end result
[0m12:38:55.610975 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:38:55.613567 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:38:55.621370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:38:55.621939 [info ] [MainThread]: 
[0m12:38:55.622604 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:38:55.623177 [info ] [MainThread]: 
[0m12:38:55.623818 [error] [MainThread]: [31mFailure in model stg_dim_device (models/staging/stg_dim_device.sql)[0m
[0m12:38:55.624424 [error] [MainThread]:   Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Unexpected ";" at [55:22]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql
[0m12:38:55.624886 [info ] [MainThread]: 
[0m12:38:55.625496 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_device.sql
[0m12:38:55.625970 [info ] [MainThread]: 
[0m12:38:55.626519 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:38:55.627286 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:38:55.628777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.268941, "process_in_blocks": "176", "process_kernel_time": 0.897156, "process_mem_max_rss": "391428", "process_out_blocks": "2192", "process_user_time": 6.223575}
[0m12:38:55.629511 [debug] [MainThread]: Command `dbt run` failed at 12:38:55.629323 after 6.27 seconds
[0m12:38:55.630166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca48776210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca48604cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca495ba5d0>]}
[0m12:38:55.630706 [debug] [MainThread]: Flushing usage events
[0m12:38:55.813602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:33.456119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3339cf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc334858210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc333b81a10>]}


============================== 12:39:33.460576 | 5fa9e644-7b15-4205-80a1-8607cbb8819e ==============================
[0m12:39:33.460576 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:33.461545 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_dim_device', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None'}
[0m12:39:33.462206 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:39:33.462794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc333a0a610>]}
[0m12:39:36.803847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3140ed350>]}
[0m12:39:36.887022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc336551590>]}
[0m12:39:36.888144 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:39:37.114171 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:37.269813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:37.270449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:37.332263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31404de90>]}
[0m12:39:37.450447 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:39:37.453288 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:39:37.471331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc313f97dd0>]}
[0m12:39:37.472208 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:39:37.472837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3140520d0>]}
[0m12:39:37.475043 [info ] [MainThread]: 
[0m12:39:37.475790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:37.476532 [info ] [MainThread]: 
[0m12:39:37.477603 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:37.480153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:39:37.480880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:37.973175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:39:37.973868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:38.421314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3338b0210>]}
[0m12:39:38.422228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:38.429474 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:39:38.430493 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:39:38.431710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:39:38.432318 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:39:38.446023 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:39:38.447088 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:39:38.489807 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:39:38.491001 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Device model
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone') THEN 'iPhone'
            WHEN REGEXP_CONTAINS(user_agent, r'iPad') THEN 'iPad'
            WHEN REGEXP_CONTAINS(user_agent, r'Macintosh') THEN 'Mac'
            WHEN REGEXP_CONTAINS(user_agent, r'Windows') THEN 'PC'
            ELSE 'Unknown'
        END AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:39:38.491894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:39.765264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:9ae46478-4565-43ad-891e-8e62cc85609b&page=queryresults
[0m12:39:41.077286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa9e644-7b15-4205-80a1-8607cbb8819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc313d65e50>]}
[0m12:39:41.078427 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 2.64s]
[0m12:39:41.079519 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:39:41.081780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:41.084197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:41.084687 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:39:41.085226 [info ] [MainThread]: 
[0m12:39:41.085775 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m12:39:41.086912 [debug] [MainThread]: Command end result
[0m12:39:41.119562 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:39:41.122299 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:39:41.130363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:39:41.130979 [info ] [MainThread]: 
[0m12:39:41.131792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:41.132332 [info ] [MainThread]: 
[0m12:39:41.132912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:39:41.133751 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:39:41.135188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7500634, "process_in_blocks": "0", "process_kernel_time": 0.742621, "process_mem_max_rss": "395308", "process_out_blocks": "2192", "process_user_time": 6.251519}
[0m12:39:41.135902 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:41.135751 after 7.75 seconds
[0m12:39:41.136451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc333b81cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc333a43a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc337c3c3d0>]}
[0m12:39:41.137042 [debug] [MainThread]: Flushing usage events
[0m12:39:41.307884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:36.840273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a391910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a535950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a3ef490>]}


============================== 12:45:36.844718 | 534f50b9-1d18-408e-9f8d-83a7a5ccf78e ==============================
[0m12:45:36.844718 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:45:36.845690 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -m stg_dim_device'}
[0m12:45:36.846340 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:45:36.847050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a38a1d0>]}
[0m12:45:40.250301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655aa6bed0>]}
[0m12:45:40.332930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657cf4d810>]}
[0m12:45:40.333975 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:45:40.564074 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:45:40.727319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:40.728103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:40.790854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a681350>]}
[0m12:45:40.906314 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:45:40.909186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:45:40.927511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a77c890>]}
[0m12:45:40.928384 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:45:40.928967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655aa78590>]}
[0m12:45:40.931200 [info ] [MainThread]: 
[0m12:45:40.931779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:40.932251 [info ] [MainThread]: 
[0m12:45:40.933043 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:40.935026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:45:40.935946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:41.441930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:45:41.442831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:42.063069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a64cb90>]}
[0m12:45:42.063936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:42.071010 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:45:42.071932 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:45:42.072728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:45:42.073309 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:45:42.085988 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:45:42.087097 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:45:42.126259 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:45:42.127557 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Device model
        TRIM(SPLIT(user_agent, ';')[SAFE_OFFSET(2)]) AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:45:42.128393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:43.001390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3b23e553-c7a9-45b0-b2a3-a773a2f1a214&page=queryresults
[0m12:45:44.135266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534f50b9-1d18-408e-9f8d-83a7a5ccf78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a5c94d0>]}
[0m12:45:44.136502 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m12:45:44.137512 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:45:44.140106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:44.142586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:44.143184 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:45:44.143811 [info ] [MainThread]: 
[0m12:45:44.144552 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m12:45:44.145614 [debug] [MainThread]: Command end result
[0m12:45:44.180359 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:45:44.183320 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:45:44.191479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:45:44.192175 [info ] [MainThread]: 
[0m12:45:44.192919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:44.193461 [info ] [MainThread]: 
[0m12:45:44.194060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:45:44.194898 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:45:44.196423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.427925, "process_in_blocks": "0", "process_kernel_time": 0.781751, "process_mem_max_rss": "396864", "process_out_blocks": "2192", "process_user_time": 6.29003}
[0m12:45:44.197219 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:44.197043 after 7.43 seconds
[0m12:45:44.197818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a38a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657a3efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657e53ef50>]}
[0m12:45:44.198529 [debug] [MainThread]: Flushing usage events
[0m12:45:44.423589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:42.687062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb6e63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb6e4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb6e6690>]}


============================== 12:48:42.691638 | 3048750f-8a48-42c7-b58c-d8ca8a368dd5 ==============================
[0m12:48:42.691638 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:48:42.692505 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_dim_device', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'warn_error': 'None'}
[0m12:48:42.693136 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:48:42.693744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb70f690>]}
[0m12:48:46.121313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb6f1250>]}
[0m12:48:46.203500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ade245ed0>]}
[0m12:48:46.204607 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:48:46.428768 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:48:46.590150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:46.590781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:46.654066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abb963710>]}
[0m12:48:46.773554 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:48:46.776522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:48:46.795131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abbdfd810>]}
[0m12:48:46.796311 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:48:46.797033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abb86fed0>]}
[0m12:48:46.799308 [info ] [MainThread]: 
[0m12:48:46.800022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:46.800582 [info ] [MainThread]: 
[0m12:48:46.801482 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:48:46.803032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:48:46.803736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:47.310749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:48:47.311673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:47.765970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adc949e90>]}
[0m12:48:47.766860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:47.774046 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:48:47.774943 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:48:47.775802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:48:47.776396 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:48:47.789164 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:48:47.790262 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:48:47.829785 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:48:47.831131 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Device model
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'LG-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'LG-[^;\)]+')  
            WHEN REGEXP_CONTAINS(user_agent, r'MI [^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'MI [^;\)]+')
            ELSE TRIM(SPLIT(user_agent, ';')[SAFE_OFFSET(2)])
            END AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:48:47.832018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:48.744415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7fa60479-7184-478c-b510-bdf7f22ca8ac&page=queryresults
[0m12:48:49.550936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3048750f-8a48-42c7-b58c-d8ca8a368dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abb79b950>]}
[0m12:48:49.552104 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m12:48:49.553151 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:48:49.555639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:49.557873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:49.558333 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:48:49.558832 [info ] [MainThread]: 
[0m12:48:49.559330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m12:48:49.560431 [debug] [MainThread]: Command end result
[0m12:48:49.591918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:48:49.594675 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:48:49.602803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:48:49.603411 [info ] [MainThread]: 
[0m12:48:49.604059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:49.604546 [info ] [MainThread]: 
[0m12:48:49.605065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:48:49.605856 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:48:49.607198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.994786, "process_in_blocks": "0", "process_kernel_time": 0.807723, "process_mem_max_rss": "396684", "process_out_blocks": "2184", "process_user_time": 6.329165}
[0m12:48:49.607864 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:49.607722 after 7.00 seconds
[0m12:48:49.608440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb70f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adb856450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adf85f010>]}
[0m12:48:49.608942 [debug] [MainThread]: Flushing usage events
[0m12:48:49.834554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:25.864280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8cc7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8cbd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8e57a10>]}


============================== 12:54:25.868788 | ac68a958-b690-4351-8c8f-195d5e196ec5 ==============================
[0m12:54:25.868788 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:54:25.869660 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_dim_device', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False'}
[0m12:54:25.870298 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:54:25.870970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8d262d0>]}
[0m12:54:29.271265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a9316090>]}
[0m12:54:29.353772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cb8596d0>]}
[0m12:54:29.354872 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:54:29.581825 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:54:29.742233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:29.742850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:29.806598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a8f329d0>]}
[0m12:54:29.922666 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:54:29.925380 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:54:29.944209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a92005d0>]}
[0m12:54:29.945053 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:54:29.945706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a8f5b110>]}
[0m12:54:29.947944 [info ] [MainThread]: 
[0m12:54:29.948569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:29.949121 [info ] [MainThread]: 
[0m12:54:29.949958 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:29.951512 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:54:29.952311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:30.451945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:54:30.452799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:30.913239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a93160d0>]}
[0m12:54:30.914127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:30.921568 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:54:30.922494 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:54:30.923316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:54:30.923954 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:54:30.936724 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:54:30.937850 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:54:30.978747 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:54:30.980032 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'LG-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'LG-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'MI [^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'MI [^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Windows') 
                THEN 'PC ' || TRIM(SPLIT(user_agent, ';')[SAFE_OFFSET(2)])
            WHEN REGEXP_CONTAINS(user_agent, r'Macintosh') THEN 'Mac'
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone') THEN 'iPhone'
            WHEN REGEXP_CONTAINS(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
            END AS device_model

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:54:30.980858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:31.815914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:72be18e7-a9bd-45e1-849e-b9588cec19cc&page=queryresults
[0m12:54:31.816899 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:72be18e7-a9bd-45e1-849e-b9588cec19cc&page=queryresults
[0m12:54:31.826388 [debug] [Thread-1 (]: Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Expected ")" but got keyword CASE at [50:9]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql
[0m12:54:31.828654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac68a958-b690-4351-8c8f-195d5e196ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a8dabc10>]}
[0m12:54:31.829622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_device ............... [[31mERROR[0m in 0.90s]
[0m12:54:31.830507 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:54:31.831293 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_device' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Expected ")" but got keyword CASE at [50:9]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql.
[0m12:54:31.834232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:31.836609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:31.837140 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:54:31.837708 [info ] [MainThread]: 
[0m12:54:31.838181 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m12:54:31.839109 [debug] [MainThread]: Command end result
[0m12:54:31.873809 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:54:31.876591 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:54:31.884685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:54:31.885252 [info ] [MainThread]: 
[0m12:54:31.885937 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:31.886549 [info ] [MainThread]: 
[0m12:54:31.887387 [error] [MainThread]: [31mFailure in model stg_dim_device (models/staging/stg_dim_device.sql)[0m
[0m12:54:31.888128 [error] [MainThread]:   Database Error in model stg_dim_device (models/staging/stg_dim_device.sql)
  Syntax error: Expected ")" but got keyword CASE at [50:9]
  compiled code at target/run/glramira/models/staging/stg_dim_device.sql
[0m12:54:31.888738 [info ] [MainThread]: 
[0m12:54:31.889433 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_device.sql
[0m12:54:31.889995 [info ] [MainThread]: 
[0m12:54:31.890665 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:54:31.891738 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:54:31.893392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.1012034, "process_in_blocks": "1152", "process_kernel_time": 0.691041, "process_mem_max_rss": "392556", "process_out_blocks": "2192", "process_user_time": 6.449822}
[0m12:54:31.894113 [debug] [MainThread]: Command `dbt run` failed at 12:54:31.893948 after 6.10 seconds
[0m12:54:31.894731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8d25f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cce532d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cce53250>]}
[0m12:54:31.895342 [debug] [MainThread]: Flushing usage events
[0m12:54:32.113286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:04.900422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555dfd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555f6e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555f6d6d0>]}


============================== 12:56:04.905003 | 95cc51b6-0995-4039-93c4-2789da79d3f8 ==============================
[0m12:56:04.905003 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:56:04.905822 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'log_format': 'default', 'empty': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -m stg_dim_device', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m12:56:04.906454 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:56:04.907025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555dc3b10>]}
[0m12:56:08.269260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555de3dd0>]}
[0m12:56:08.361618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6558959950>]}
[0m12:56:08.362772 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:56:08.614462 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:56:08.771985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:08.772596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:08.836285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65393d3d90>]}
[0m12:56:08.953845 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:56:08.956617 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:56:08.974903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65360f00d0>]}
[0m12:56:08.975767 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:56:08.976350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65364d7150>]}
[0m12:56:08.978547 [info ] [MainThread]: 
[0m12:56:08.979108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:08.979634 [info ] [MainThread]: 
[0m12:56:08.980476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:08.981967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:56:08.982723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:09.474223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:56:09.475131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:09.960635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6535ee3150>]}
[0m12:56:09.961585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:09.968778 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:56:09.969732 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:56:09.970641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:56:09.971214 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:56:09.984139 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:56:09.985140 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:56:10.025751 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:56:10.026912 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Detect Device Model
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'LG-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'LG-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'MI [^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'MI [^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Windows') 
                THEN 'PC ' || TRIM(SPLIT(user_agent, ';')[SAFE_OFFSET(2)])
            WHEN REGEXP_CONTAINS(user_agent, r'Macintosh') THEN 'Mac'
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone') THEN 'iPhone'
            WHEN REGEXP_CONTAINS(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
        END AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:56:10.027787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:10.784221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:209e23a7-9286-47e2-9730-c55dab1f2843&page=queryresults
[0m12:56:12.005094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95cc51b6-0995-4039-93c4-2789da79d3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6535f46850>]}
[0m12:56:12.006268 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m12:56:12.007236 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:56:12.009703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:12.012036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:12.012550 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:56:12.013063 [info ] [MainThread]: 
[0m12:56:12.013657 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:56:12.014740 [debug] [MainThread]: Command end result
[0m12:56:12.046831 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:56:12.049725 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:56:12.057836 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:56:12.058451 [info ] [MainThread]: 
[0m12:56:12.059209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:12.059766 [info ] [MainThread]: 
[0m12:56:12.060369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:56:12.061210 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:56:12.062668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2353234, "process_in_blocks": "0", "process_kernel_time": 0.779373, "process_mem_max_rss": "396896", "process_out_blocks": "2192", "process_user_time": 6.335792}
[0m12:56:12.063449 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:12.063242 after 7.24 seconds
[0m12:56:12.064066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6555dc1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a0142d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6559f53090>]}
[0m12:56:12.064680 [debug] [MainThread]: Flushing usage events
[0m12:56:12.249867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:25.827860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3257190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3256350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c31f25d0>]}


============================== 12:57:25.832463 | 834c3ace-0bea-4545-82e5-c34b009598eb ==============================
[0m12:57:25.832463 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:57:25.833279 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_dim_device', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m12:57:25.833899 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:57:25.834537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3255c10>]}
[0m12:57:29.219710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3201a10>]}
[0m12:57:29.304345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a384a410>]}
[0m12:57:29.305373 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:57:29.534888 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:57:29.694301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:29.694924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:29.758769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a34cf110>]}
[0m12:57:29.877275 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:57:29.880140 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:57:29.898345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a35e9490>]}
[0m12:57:29.899216 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m12:57:29.899933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a34929d0>]}
[0m12:57:29.902162 [info ] [MainThread]: 
[0m12:57:29.902752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:29.903249 [info ] [MainThread]: 
[0m12:57:29.904154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:29.906462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m12:57:29.907391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:30.381566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m12:57:30.382406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:30.819005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a3753b50>]}
[0m12:57:30.819896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:30.827006 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m12:57:30.827981 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m12:57:30.828814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m12:57:30.829403 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m12:57:30.842134 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m12:57:30.843196 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m12:57:30.882665 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m12:57:30.883962 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        FARM_FINGERPRINT(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- Detect OS
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'Windows NT [0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Windows NT [0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Android\s+[0-9._]+') 
                 THEN REGEXP_EXTRACT(user_agent, r'Android\s+[0-9._]+')
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone OS [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Mac OS X [0-9_]+') 
                 THEN REPLACE(REGEXP_EXTRACT(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN REGEXP_CONTAINS(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,

        -- Detect Device Model
        CASE
            WHEN REGEXP_CONTAINS(user_agent, r'SM-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'SM-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'LG-[^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'LG-[^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'MI [^;\)]+') 
                THEN REGEXP_EXTRACT(user_agent, r'MI [^;\)]+')
            WHEN REGEXP_CONTAINS(user_agent, r'Windows') 
                THEN 'PC ' || TRIM(SPLIT(user_agent, ';')[SAFE_OFFSET(2)])
            WHEN REGEXP_CONTAINS(user_agent, r'Macintosh') THEN 'Mac'
            WHEN REGEXP_CONTAINS(user_agent, r'iPhone') THEN 'iPhone'
            WHEN REGEXP_CONTAINS(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
        END AS device_model,

        -- Device type
        CASE 
            WHEN REGEXP_CONTAINS(user_agent, r'Mobile') THEN 'Mobile'
            WHEN REGEXP_CONTAINS(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m12:57:30.884743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:31.794169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e6e65182-eb5f-4569-b133-6ab03285b944&page=queryresults
[0m12:57:32.600638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '834c3ace-0bea-4545-82e5-c34b009598eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a32d46d0>]}
[0m12:57:32.601765 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m12:57:32.602788 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m12:57:32.605112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:32.607450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:32.607991 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m12:57:32.608578 [info ] [MainThread]: 
[0m12:57:32.609155 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m12:57:32.610285 [debug] [MainThread]: Command end result
[0m12:57:32.643424 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m12:57:32.646000 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m12:57:32.653909 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m12:57:32.654468 [info ] [MainThread]: 
[0m12:57:32.655115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:32.655694 [info ] [MainThread]: 
[0m12:57:32.656255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:57:32.657065 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:57:32.658362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.903823, "process_in_blocks": "0", "process_kernel_time": 0.727524, "process_mem_max_rss": "396744", "process_out_blocks": "2184", "process_user_time": 6.333072}
[0m12:57:32.659056 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:32.658893 after 6.90 seconds
[0m12:57:32.659610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3257510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c3256050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c74843d0>]}
[0m12:57:32.660231 [debug] [MainThread]: Flushing usage events
[0m12:57:32.877479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:00.887523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762ddde150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762df91b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762df91a10>]}


============================== 13:07:00.892699 | 59678ad0-0d69-4011-9b1d-6ef248847f71 ==============================
[0m13:07:00.892699 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:07:00.893654 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'invocation_command': 'dbt run -m stg_dim_device', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80'}
[0m13:07:00.894481 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:07:00.895250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762de18790>]}
[0m13:07:04.281549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762ec68d50>]}
[0m13:07:04.364555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7630a58890>]}
[0m13:07:04.365629 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:07:04.595637 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:07:04.755342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:04.756071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:04.819071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760e02a410>]}
[0m13:07:04.936084 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:07:04.938843 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:07:04.957016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760e4aba90>]}
[0m13:07:04.957895 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:07:04.958600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760e40d450>]}
[0m13:07:04.960859 [info ] [MainThread]: 
[0m13:07:04.961473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:04.961970 [info ] [MainThread]: 
[0m13:07:04.962769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:07:04.964925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:07:04.965747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:05.478503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:07:05.479570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:05.935387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762fb78290>]}
[0m13:07:05.936312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:05.943598 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m13:07:05.944583 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m13:07:05.945451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m13:07:05.946020 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m13:07:05.959085 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m13:07:05.960165 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m13:07:05.999476 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m13:07:06.000809 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select
        farm_fingerprint(
            concat(
                coalesce(device_id, ''),
                coalesce(user_agent, ''),
                coalesce(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- detect os
        case
            when regexp_contains(user_agent, r'Windows NT [0-9._]+') 
                then regexp_extract(user_agent, r'Windows NT [0-9._]+')
            when regexp_contains(user_agent, r'Android\s+[0-9._]+') 
                then regexp_extract(user_agent, r'Android\s+[0-9._]+')
            when regexp_contains(user_agent, r'iPhone OS [0-9_]+') 
                then replace(regexp_extract(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            when regexp_contains(user_agent, r'Mac OS X [0-9_]+') 
                then replace(regexp_extract(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            when regexp_contains(user_agent, r'Linux') then 'Linux'
            else 'Other'
        end as os,

        -- detect device model
        case
            when regexp_contains(user_agent, r'SM-[^;\)]+') 
                then regexp_extract(user_agent, r'SM-[^;\)]+')
            when regexp_contains(user_agent, r'LG-[^;\)]+') 
                then regexp_extract(user_agent, r'LG-[^;\)]+')
            when regexp_contains(user_agent, r'MI [^;\)]+') 
                then regexp_extract(user_agent, r'MI [^;\)]+')
            when regexp_contains(user_agent, r'Windows') 
                then 'PC Windows'
            when regexp_contains(user_agent, r'Macintosh') then 'Mac'
            when regexp_contains(user_agent, r'iPhone') then 'iPhone'
            when regexp_contains(user_agent, r'iPad') then 'iPad'
            else 'Unknown'
        end as device_model,

        -- device type
        case 
            when regexp_contains(user_agent, r'Mobile') then 'Mobile'
            when regexp_contains(user_agent, r'Tablet') then 'Tablet'
            else 'Desktop'
        end as device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m13:07:06.001748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:06.950449 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5dc54328-c7d3-46fe-8552-4a2bf0aa6d01&page=queryresults
[0m13:07:07.927790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59678ad0-0d69-4011-9b1d-6ef248847f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760de265d0>]}
[0m13:07:07.929054 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m13:07:07.930115 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m13:07:07.932560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:07.934814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:07.935394 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m13:07:07.935915 [info ] [MainThread]: 
[0m13:07:07.936503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m13:07:07.937603 [debug] [MainThread]: Command end result
[0m13:07:07.970145 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:07:07.973245 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:07:07.981522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:07:07.982179 [info ] [MainThread]: 
[0m13:07:07.982950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:07.983577 [info ] [MainThread]: 
[0m13:07:07.984182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:07:07.985022 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:07:07.986577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1723647, "process_in_blocks": "0", "process_kernel_time": 0.810498, "process_mem_max_rss": "396844", "process_out_blocks": "2184", "process_user_time": 6.249556}
[0m13:07:07.987560 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:07.987346 after 7.17 seconds
[0m13:07:07.988417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762df91910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7632108290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7632046f50>]}
[0m13:07:07.989055 [debug] [MainThread]: Flushing usage events
[0m13:07:08.160757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:42.622326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce99401910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce995adb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce993f9a90>]}


============================== 13:08:42.626829 | 6d7ca517-b592-4044-b9b3-a5434ee64f54 ==============================
[0m13:08:42.626829 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:08:42.627703 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_dim_device', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False'}
[0m13:08:42.628343 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:08:42.629000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce995ae450>]}
[0m13:08:46.075174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce99437510>]}
[0m13:08:46.159833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce797c2410>]}
[0m13:08:46.160905 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:08:46.394758 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:08:46.558458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:46.559107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:46.626801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce794d1e50>]}
[0m13:08:46.746842 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:08:46.749936 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:08:46.768274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce795fcfd0>]}
[0m13:08:46.769209 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:08:46.769818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce798edf50>]}
[0m13:08:46.772049 [info ] [MainThread]: 
[0m13:08:46.772609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:46.773115 [info ] [MainThread]: 
[0m13:08:46.773950 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:46.775402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:08:46.776097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:47.253437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:08:47.254261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:47.699676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce798edf50>]}
[0m13:08:47.700490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:47.708163 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m13:08:47.709177 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m13:08:47.710076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m13:08:47.710646 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m13:08:47.724259 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m13:08:47.725263 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m13:08:47.767348 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m13:08:47.768624 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as with device as (
    select distinct
        farm_fingerprint(
            concat(
                coalesce(device_id, ''),
                coalesce(user_agent, ''),
                coalesce(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- detect os
        case
            when regexp_contains(user_agent, r'Windows NT [0-9._]+') 
                then regexp_extract(user_agent, r'Windows NT [0-9._]+')
            when regexp_contains(user_agent, r'Android\s+[0-9._]+') 
                then regexp_extract(user_agent, r'Android\s+[0-9._]+')
            when regexp_contains(user_agent, r'iPhone OS [0-9_]+') 
                then replace(regexp_extract(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            when regexp_contains(user_agent, r'Mac OS X [0-9_]+') 
                then replace(regexp_extract(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            when regexp_contains(user_agent, r'Linux') then 'Linux'
            else 'Other'
        end as os,

        -- detect device model
        case
            when regexp_contains(user_agent, r'SM-[^;\)]+') 
                then regexp_extract(user_agent, r'SM-[^;\)]+')
            when regexp_contains(user_agent, r'LG-[^;\)]+') 
                then regexp_extract(user_agent, r'LG-[^;\)]+')
            when regexp_contains(user_agent, r'MI [^;\)]+') 
                then regexp_extract(user_agent, r'MI [^;\)]+')
            when regexp_contains(user_agent, r'Windows') 
                then 'PC Windows'
            when regexp_contains(user_agent, r'Macintosh') then 'Mac'
            when regexp_contains(user_agent, r'iPhone') then 'iPhone'
            when regexp_contains(user_agent, r'iPad') then 'iPad'
            else 'Unknown'
        end as device_model,

        -- device type
        case 
            when regexp_contains(user_agent, r'Mobile') then 'Mobile'
            when regexp_contains(user_agent, r'Tablet') then 'Tablet'
            else 'Desktop'
        end as device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device;


[0m13:08:47.769459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:48.514476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f3e1332f-79c2-440b-af29-fefedbef2850&page=queryresults
[0m13:08:49.415876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7ca517-b592-4044-b9b3-a5434ee64f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79791f90>]}
[0m13:08:49.417142 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m13:08:49.418249 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m13:08:49.421125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:49.423589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:49.424121 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m13:08:49.424753 [info ] [MainThread]: 
[0m13:08:49.425513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m13:08:49.426650 [debug] [MainThread]: Command end result
[0m13:08:49.461403 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:08:49.464314 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:08:49.472535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:08:49.473138 [info ] [MainThread]: 
[0m13:08:49.473853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:49.474403 [info ] [MainThread]: 
[0m13:08:49.474951 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:08:49.475806 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:08:49.477190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.931419, "process_in_blocks": "0", "process_kernel_time": 0.814101, "process_mem_max_rss": "396720", "process_out_blocks": "2184", "process_user_time": 6.401978}
[0m13:08:49.477822 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:49.477680 after 6.93 seconds
[0m13:08:49.478400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce995ae450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce995adb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9d5e7010>]}
[0m13:08:49.478920 [debug] [MainThread]: Flushing usage events
[0m13:08:49.694122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:59.513035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe33ea6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe344dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe359e1d0>]}


============================== 13:13:59.518290 | ecebcccc-3d92-4425-9dcb-599ba290dd00 ==============================
[0m13:13:59.518290 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:13:59.519308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'invocation_command': 'dbt run -m stg_dim_device'}
[0m13:13:59.519960 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:13:59.520581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ecebcccc-3d92-4425-9dcb-599ba290dd00', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe359e450>]}
[0m13:14:03.035136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecebcccc-3d92-4425-9dcb-599ba290dd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe39aebd0>]}
[0m13:14:03.123595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecebcccc-3d92-4425-9dcb-599ba290dd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe5ff9390>]}
[0m13:14:03.124799 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:14:03.375814 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:14:03.553757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:03.554796 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_location.sql
[0m13:14:03.839055 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.glramira.stg_dim_location' (models/staging/stg_dim_location.sql) depends on a source named 'product_info.location' which was not found
[0m13:14:03.840128 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:14:03.841653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.404979, "process_in_blocks": "0", "process_kernel_time": 0.894701, "process_mem_max_rss": "389588", "process_out_blocks": "16", "process_user_time": 5.850911}
[0m13:14:03.842649 [debug] [MainThread]: Command `dbt run` failed at 13:14:03.842480 after 4.41 seconds
[0m13:14:03.843295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe3426390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3504850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3a65050>]}
[0m13:14:03.843975 [debug] [MainThread]: Flushing usage events
[0m13:14:04.025684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:23.448637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a07d3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a096ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a07ca2d0>]}


============================== 13:14:23.453632 | a8aa0310-8550-4a03-93a9-dbf7c87569db ==============================
[0m13:14:23.453632 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:14:23.454747 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_dim_location', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80'}
[0m13:14:23.455514 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:14:23.456230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a8aa0310-8550-4a03-93a9-dbf7c87569db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a082d890>]}
[0m13:14:26.875505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8aa0310-8550-4a03-93a9-dbf7c87569db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2380fb9e90>]}
[0m13:14:26.961339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8aa0310-8550-4a03-93a9-dbf7c87569db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a34454d0>]}
[0m13:14:26.962425 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:14:27.192395 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:14:27.347757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:27.348793 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_location.sql
[0m13:14:27.607644 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.glramira.stg_dim_location' (models/staging/stg_dim_location.sql) depends on a source named 'product_info.location' which was not found
[0m13:14:27.608611 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:14:27.609963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2350035, "process_in_blocks": "0", "process_kernel_time": 0.743463, "process_mem_max_rss": "389740", "process_out_blocks": "8", "process_user_time": 5.780052}
[0m13:14:27.610955 [debug] [MainThread]: Command `dbt run` failed at 13:14:27.610785 after 4.24 seconds
[0m13:14:27.611571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a097e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2380c73a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2380ad2190>]}
[0m13:14:27.612158 [debug] [MainThread]: Flushing usage events
[0m13:14:27.786127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:53.660929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e031810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e032dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e0338d0>]}


============================== 13:14:53.665471 | 677663c5-07a2-47df-86a4-afdd3ba00205 ==============================
[0m13:14:53.665471 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:14:53.666377 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False'}
[0m13:14:53.667015 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:14:53.667750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e043810>]}
[0m13:14:57.478009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e204410>]}
[0m13:14:57.567444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e20d60fd0>]}
[0m13:14:57.568618 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:14:57.802702 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:14:57.962904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:57.963654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:58.027440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfe3d0590>]}
[0m13:14:58.143546 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:14:58.146399 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:14:58.164922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfe67b650>]}
[0m13:14:58.165767 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:14:58.166421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1ff27d90>]}
[0m13:14:58.168588 [info ] [MainThread]: 
[0m13:14:58.169139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:58.169612 [info ] [MainThread]: 
[0m13:14:58.170431 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:14:58.171942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:14:58.172662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:58.700578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:14:58.701482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:59.156757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfe67f9d0>]}
[0m13:14:59.157854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:59.166001 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:14:59.166979 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:14:59.168230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:14:59.168820 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:14:59.182851 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:14:59.183972 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:14:59.226370 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:14:59.227598 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select
        farm_fingerprint(concat(
        coalesce(cast(country as string), ''),
        coalesce(cast(country_code as string), ''),
        coalesce(cast(city as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(device_id as string) as device_id,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:14:59.228471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:00.137781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2246c853-2647-4f38-8bad-b51bba2c3870&page=queryresults
[0m13:15:00.589847 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2246c853-2647-4f38-8bad-b51bba2c3870&page=queryresults
[0m13:15:00.600103 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: device_id at [16:14]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:15:00.602445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677663c5-07a2-47df-86a4-afdd3ba00205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dee73c090>]}
[0m13:15:00.603500 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 1.43s]
[0m13:15:00.604360 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:15:00.605123 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: device_id at [16:14]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m13:15:00.607891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:00.610102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:00.610621 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:15:00.611219 [info ] [MainThread]: 
[0m13:15:00.611831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m13:15:00.612771 [debug] [MainThread]: Command end result
[0m13:15:00.647030 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:15:00.649629 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:15:00.657366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:15:00.657962 [info ] [MainThread]: 
[0m13:15:00.658619 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:00.659192 [info ] [MainThread]: 
[0m13:15:00.659844 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m13:15:00.660434 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: device_id at [16:14]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:15:00.660904 [info ] [MainThread]: 
[0m13:15:00.661490 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m13:15:00.661965 [info ] [MainThread]: 
[0m13:15:00.662505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:15:00.663282 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:15:00.664648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0781236, "process_in_blocks": "0", "process_kernel_time": 1.085452, "process_mem_max_rss": "392684", "process_out_blocks": "2176", "process_user_time": 6.41605}
[0m13:15:00.665333 [debug] [MainThread]: Command `dbt run` failed at 13:15:00.665169 after 7.08 seconds
[0m13:15:00.666104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e204e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1e1ea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e22366e90>]}
[0m13:15:00.666684 [debug] [MainThread]: Flushing usage events
[0m13:15:00.835960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:28.977349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998cdf33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998f9db3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998cdf32d0>]}


============================== 13:15:28.982006 | 766f5838-08c1-466a-b52c-5a77a3fed5f8 ==============================
[0m13:15:28.982006 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:15:28.982948 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt run -m stg_dim_location', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False'}
[0m13:15:28.983671 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:15:28.984354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998cdf1b50>]}
[0m13:15:32.590278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d6f43d0>]}
[0m13:15:32.677801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998fa15750>]}
[0m13:15:32.678909 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:15:32.935631 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:15:33.104658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:33.105325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:33.168017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d1176d0>]}
[0m13:15:33.287729 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:15:33.290641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:15:33.310464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d17bd10>]}
[0m13:15:33.311675 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:15:33.312475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d180190>]}
[0m13:15:33.315488 [info ] [MainThread]: 
[0m13:15:33.316248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:33.316821 [info ] [MainThread]: 
[0m13:15:33.317704 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:33.319272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:15:33.320093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:33.801794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:15:33.802642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:34.274440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d6b6090>]}
[0m13:15:34.275294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:34.284079 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:15:34.285021 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:15:34.285858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:15:34.286703 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:15:34.299625 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:15:34.300771 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:15:34.341967 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:15:34.343225 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select
        farm_fingerprint(concat(
        coalesce(cast(country as string), ''),
        coalesce(cast(country_code as string), ''),
        coalesce(cast(city as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:15:34.343976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:35.084243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:ed2b1a54-b613-46da-8a84-45da180a5b3f&page=queryresults
[0m13:15:36.154127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '766f5838-08c1-466a-b52c-5a77a3fed5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996cf69990>]}
[0m13:15:36.155471 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m13:15:36.156623 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:15:36.159101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:36.161383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:36.161860 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:15:36.162396 [info ] [MainThread]: 
[0m13:15:36.162918 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m13:15:36.163998 [debug] [MainThread]: Command end result
[0m13:15:36.198607 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:15:36.201335 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:15:36.209087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:15:36.209641 [info ] [MainThread]: 
[0m13:15:36.210334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:36.210884 [info ] [MainThread]: 
[0m13:15:36.211458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:15:36.212205 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:15:36.213482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3122425, "process_in_blocks": "0", "process_kernel_time": 0.794147, "process_mem_max_rss": "396792", "process_out_blocks": "2184", "process_user_time": 6.487608}
[0m13:15:36.214097 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:36.213962 after 7.31 seconds
[0m13:15:36.214612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998cf9e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998cdea2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99910c41d0>]}
[0m13:15:36.215189 [debug] [MainThread]: Flushing usage events
[0m13:15:36.398312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:24.413793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9ded3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e07e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9ded1150>]}


============================== 13:17:24.418271 | 85beab54-041d-4415-9e28-6ae7b572bd6a ==============================
[0m13:17:24.418271 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:17:24.419154 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_dim_location', 'static_parser': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:17:24.419782 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:17:24.420390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9deca210>]}
[0m13:17:27.876895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7e573e10>]}
[0m13:17:27.962814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa0b3c0d0>]}
[0m13:17:27.963926 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:17:28.205780 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:17:28.362811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:28.363463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:28.427997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7e187990>]}
[0m13:17:28.544666 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:17:28.547509 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:17:28.566203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7e5dbd90>]}
[0m13:17:28.567064 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:17:28.567646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7e178fd0>]}
[0m13:17:28.569706 [info ] [MainThread]: 
[0m13:17:28.570239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:28.570701 [info ] [MainThread]: 
[0m13:17:28.571516 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:28.572908 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:17:28.573653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:29.043107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:17:29.043890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:29.482329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7e178fd0>]}
[0m13:17:29.483233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:29.491934 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:17:29.492930 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:17:29.493836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:17:29.494403 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:17:29.507515 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:17:29.508635 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:17:29.549318 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:17:29.550499 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(concat(
        coalesce(cast(country as string), ''),
        coalesce(cast(country_code as string), ''),
        coalesce(cast(city as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:17:29.551282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:30.457285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:edd5ebb3-d6cc-4a16-b7d3-c76cd81f70ff&page=queryresults
[0m13:17:31.251061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85beab54-041d-4415-9e28-6ae7b572bd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7df0c110>]}
[0m13:17:31.252408 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m13:17:31.253448 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:17:31.255862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:31.258151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:31.258710 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:17:31.259248 [info ] [MainThread]: 
[0m13:17:31.259803 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m13:17:31.260895 [debug] [MainThread]: Command end result
[0m13:17:31.292814 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:17:31.295408 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:17:31.303441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:17:31.304031 [info ] [MainThread]: 
[0m13:17:31.304701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:31.305213 [info ] [MainThread]: 
[0m13:17:31.305785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:17:31.306739 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:17:31.308280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.968339, "process_in_blocks": "0", "process_kernel_time": 0.873755, "process_mem_max_rss": "396604", "process_out_blocks": "2184", "process_user_time": 6.256916}
[0m13:17:31.309008 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:31.308845 after 6.97 seconds
[0m13:17:31.309566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9df3bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9df3b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa212efd0>]}
[0m13:17:31.310140 [debug] [MainThread]: Flushing usage events
[0m13:17:31.506547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:06.867396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80363e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80362dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a803614d0>]}


============================== 13:19:06.871903 | 35153ffe-2f0f-478a-8310-da303fcc27e0 ==============================
[0m13:19:06.871903 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:19:06.872901 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'indirect_selection': 'eager', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:19:06.873542 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:19:06.874193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80361190>]}
[0m13:19:10.269827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80558310>]}
[0m13:19:10.354185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a830c5450>]}
[0m13:19:10.355306 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:19:10.612997 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:19:10.781417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:10.782077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:10.845913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a608bc750>]}
[0m13:19:10.966961 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:19:10.969969 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:19:10.988033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60bba250>]}
[0m13:19:10.988882 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:19:10.989501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a608c3790>]}
[0m13:19:10.991708 [info ] [MainThread]: 
[0m13:19:10.992283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:10.992774 [info ] [MainThread]: 
[0m13:19:10.993602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:10.995071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:19:10.995922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:11.473444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:19:11.474330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:11.914169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6067fb10>]}
[0m13:19:11.915075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:11.922012 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:19:11.922953 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:19:11.923811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:19:11.924380 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:19:11.936916 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:19:11.938064 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:19:11.977947 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:19:11.979172 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(concat(
        coalesce(cast(country as string), ''),
        coalesce(cast(country_code as string), ''),
        coalesce(cast(region as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:19:11.979920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:12.716504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:df84c624-a351-4294-a279-2e719258d40b&page=queryresults
[0m13:19:13.609186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35153ffe-2f0f-478a-8310-da303fcc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a608bd010>]}
[0m13:19:13.610447 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m13:19:13.611568 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:19:13.614113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:13.616645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:13.617206 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:19:13.617775 [info ] [MainThread]: 
[0m13:19:13.618636 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m13:19:13.619707 [debug] [MainThread]: Command end result
[0m13:19:13.653097 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:19:13.655698 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:19:13.663605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:19:13.664153 [info ] [MainThread]: 
[0m13:19:13.664733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:13.665197 [info ] [MainThread]: 
[0m13:19:13.665693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:19:13.666525 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:19:13.667913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8732104, "process_in_blocks": "0", "process_kernel_time": 0.765655, "process_mem_max_rss": "395280", "process_out_blocks": "2176", "process_user_time": 6.36231}
[0m13:19:13.668624 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:13.668471 after 6.87 seconds
[0m13:19:13.669167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80361190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a80362ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a84770310>]}
[0m13:19:13.669704 [debug] [MainThread]: Flushing usage events
[0m13:19:13.926196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:16.202435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc10f1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc1156350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc10f20d0>]}


============================== 13:20:16.207201 | d89108fc-2878-4920-bae5-73bc2abddb3d ==============================
[0m13:20:16.207201 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:20:16.208252 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m13:20:16.208888 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:20:16.209551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc55ce190>]}
[0m13:20:19.608839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc10f1910>]}
[0m13:20:19.693975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3d051d0>]}
[0m13:20:19.695109 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:20:19.939210 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:20:20.095800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:20.096423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:20.159262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca148ec90>]}
[0m13:20:20.277573 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:20:20.280797 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:20:20.299825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca18bd950>]}
[0m13:20:20.300710 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:20:20.301374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca18e0b90>]}
[0m13:20:20.303584 [info ] [MainThread]: 
[0m13:20:20.304190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:20.304811 [info ] [MainThread]: 
[0m13:20:20.305797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:20.308004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:20:20.308730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:20.810450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:20:20.811538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:21.345084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca1722090>]}
[0m13:20:21.345912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:21.354109 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:20:21.355020 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:20:21.355874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:20:21.356456 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:20:21.369276 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:20:21.370305 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:20:21.410876 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:20:21.412044 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(concat(
        coalesce(cast(country as string), ''),
        coalesce(cast(country_code as string), ''),
        coalesce(cast(city as string), ''),
        coalesce(cast(region as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:20:21.412735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:22.157585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7439015f-0862-4f83-a0fa-49a139c3da5a&page=queryresults
[0m13:20:23.043580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd89108fc-2878-4920-bae5-73bc2abddb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc99505ed0>]}
[0m13:20:23.044711 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m13:20:23.045688 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:20:23.047961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:23.050280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:23.050821 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:20:23.051355 [info ] [MainThread]: 
[0m13:20:23.051898 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m13:20:23.053043 [debug] [MainThread]: Command end result
[0m13:20:23.087041 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:20:23.089772 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:20:23.097414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:20:23.097960 [info ] [MainThread]: 
[0m13:20:23.098608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:23.099089 [info ] [MainThread]: 
[0m13:20:23.099669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:20:23.100457 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:20:23.101779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9738984, "process_in_blocks": "0", "process_kernel_time": 0.844089, "process_mem_max_rss": "396524", "process_out_blocks": "2176", "process_user_time": 6.330879}
[0m13:20:23.102474 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:23.102323 after 6.97 seconds
[0m13:20:23.103038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc55ce190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc0f67110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc53b8310>]}
[0m13:20:23.103651 [debug] [MainThread]: Flushing usage events
[0m13:20:23.289724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:48.174549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80469e1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8046b8db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80469d9b10>]}


============================== 13:25:48.179092 | b59e1f2b-88b4-487f-b6c6-a35c6ce160c2 ==============================
[0m13:25:48.179092 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:25:48.180028 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_dim_user', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'printer_width': '80'}
[0m13:25:48.180690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:25:48.181356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8046b8e450>]}
[0m13:25:51.560121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80491fe1d0>]}
[0m13:25:51.644920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8049654c90>]}
[0m13:25:51.646010 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:25:51.895142 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:25:52.056532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:52.057223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:52.119650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026e63250>]}
[0m13:25:52.237431 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:25:52.240133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:25:52.257258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802703cc10>]}
[0m13:25:52.258105 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:25:52.258671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80271cded0>]}
[0m13:25:52.261169 [info ] [MainThread]: 
[0m13:25:52.261725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:52.262217 [info ] [MainThread]: 
[0m13:25:52.263029 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:52.264485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:25:52.265143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:52.752620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:25:52.753534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:53.215428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026ec8090>]}
[0m13:25:53.216380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:53.223892 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m13:25:53.224859 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m13:25:53.225696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_user)
[0m13:25:53.226304 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m13:25:53.239504 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m13:25:53.240527 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m13:25:53.281389 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m13:25:53.282531 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as with user as (
    select
        farm_fingerprint(concat(
        coalesce(cast(email_address as string), '')
    )) AS event_id,
        cast(email_address as string) as email_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from user;


[0m13:25:53.283195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:54.207258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3dbafb15-1812-44b5-aace-d5e07df18076&page=queryresults
[0m13:25:55.174241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59e1f2b-88b4-487f-b6c6-a35c6ce160c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026b9d910>]}
[0m13:25:55.175485 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m13:25:55.176501 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m13:25:55.179286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:55.181872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:55.182402 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m13:25:55.183024 [info ] [MainThread]: 
[0m13:25:55.183822 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m13:25:55.184769 [debug] [MainThread]: Command end result
[0m13:25:55.218997 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:25:55.221853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:25:55.229727 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:25:55.230399 [info ] [MainThread]: 
[0m13:25:55.231100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:55.231684 [info ] [MainThread]: 
[0m13:25:55.232326 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:25:55.233256 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:25:55.234624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1337595, "process_in_blocks": "0", "process_kernel_time": 0.806336, "process_mem_max_rss": "396780", "process_out_blocks": "2176", "process_user_time": 6.32284}
[0m13:25:55.235297 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:55.235144 after 7.13 seconds
[0m13:25:55.235864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80469da310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804ad642d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804aca3090>]}
[0m13:25:55.236683 [debug] [MainThread]: Flushing usage events
[0m13:25:55.408171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:54.762755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b61f1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b62515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b6252dd0>]}


============================== 13:26:54.767254 | 1adabd1f-acc6-434d-b0bf-24b2796a01a3 ==============================
[0m13:26:54.767254 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:26:54.768224 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run -m stg_dim_user', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True'}
[0m13:26:54.768850 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:26:54.769514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b6259dd0>]}
[0m13:26:58.145570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b7f74e10>]}
[0m13:26:58.231236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b8e11f10>]}
[0m13:26:58.232421 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:26:58.493356 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:26:58.654087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:58.654698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:58.719224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169652b610>]}
[0m13:26:58.838836 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:26:58.841584 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:26:58.859940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169652b810>]}
[0m13:26:58.860784 [info ] [MainThread]: Found 9 models, 4 data tests, 3 sources, 495 macros
[0m13:26:58.861411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169668fa10>]}
[0m13:26:58.863616 [info ] [MainThread]: 
[0m13:26:58.864200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:58.864694 [info ] [MainThread]: 
[0m13:26:58.865536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:26:58.867145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:26:58.868005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:59.374587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:26:59.375485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:59.819961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169683cd90>]}
[0m13:26:59.820828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:59.829004 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m13:26:59.830213 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m13:26:59.831199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_user)
[0m13:26:59.831818 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m13:26:59.844558 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m13:26:59.845540 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m13:26:59.885091 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m13:26:59.886267 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as with user as (
    select distinct
        farm_fingerprint(concat(
        coalesce(cast(email_address as string), '')
    )) AS event_id,
        cast(email_address as string) as email_address
    from `project-data-engineer-469310`.`product_info`.`event`
)

select * from user;


[0m13:26:59.886969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:00.619577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1636d47a-4c45-4a3c-8717-6215d2160bdc&page=queryresults
[0m13:27:01.677408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adabd1f-acc6-434d-b0bf-24b2796a01a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1696329b90>]}
[0m13:27:01.678583 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m13:27:01.679661 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m13:27:01.682052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:01.684487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:01.685064 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m13:27:01.685565 [info ] [MainThread]: 
[0m13:27:01.686139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m13:27:01.687270 [debug] [MainThread]: Command end result
[0m13:27:01.721119 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:27:01.723714 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:27:01.731530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:27:01.732114 [info ] [MainThread]: 
[0m13:27:01.732762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:01.733254 [info ] [MainThread]: 
[0m13:27:01.733776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:27:01.734561 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:27:01.735892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.047915, "process_in_blocks": "0", "process_kernel_time": 0.810495, "process_mem_max_rss": "396720", "process_out_blocks": "2176", "process_user_time": 6.284601}
[0m13:27:01.736558 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:01.736399 after 7.05 seconds
[0m13:27:01.737107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b625bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b625ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169690f490>]}
[0m13:27:01.737668 [debug] [MainThread]: Flushing usage events
[0m13:27:01.958389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:51:30.327105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0656f0fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06571cd650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0656f05f10>]}


============================== 05:51:30.335160 | c2141c3e-bbe5-4406-9a54-6878be0ee30b ==============================
[0m05:51:30.335160 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:51:30.336660 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'empty': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m05:51:30.548589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2141c3e-bbe5-4406-9a54-6878be0ee30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0657d7d5d0>]}
[0m05:51:30.578781 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:51:30.580761 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:51:30.582780 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36027688, "process_in_blocks": "224", "process_kernel_time": 0.614926, "process_mem_max_rss": "102312", "process_out_blocks": "8", "process_user_time": 2.496497}
[0m05:51:30.583984 [debug] [MainThread]: Command `cli deps` succeeded at 05:51:30.583759 after 0.36 seconds
[0m05:51:30.584625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0656f52550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065b26d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065b26d2d0>]}
[0m05:51:30.585381 [debug] [MainThread]: Flushing usage events
[0m05:51:30.821875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:14:13.175635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66c1b6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66c213810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66c211110>]}


============================== 06:14:13.281203 | b1edb66f-8ff6-46a1-8a78-613324518b90 ==============================
[0m06:14:13.281203 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:14:13.282397 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False', 'introspect': 'True', 'target_path': 'None'}
[0m06:14:13.293923 [info ] [MainThread]: dbt version: 1.10.13
[0m06:14:13.294689 [info ] [MainThread]: python version: 3.11.2
[0m06:14:13.295315 [info ] [MainThread]: python path: /home/quakinh943/dbt_glamira_prod/.venv/bin/python3
[0m06:14:13.295878 [info ] [MainThread]: os info: Linux-6.1.0-39-cloud-amd64-x86_64-with-glibc2.36
[0m06:14:16.508658 [info ] [MainThread]: Using profiles dir at /home/quakinh943/.dbt
[0m06:14:16.509781 [info ] [MainThread]: Using profiles.yml file at /home/quakinh943/.dbt/profiles.yml
[0m06:14:16.510437 [info ] [MainThread]: Using dbt_project.yml file at /home/quakinh943/dbt_glamira_prod/glramira/dbt_project.yml
[0m06:14:16.511011 [info ] [MainThread]: adapter type: bigquery
[0m06:14:16.511582 [info ] [MainThread]: adapter version: 1.10.2
[0m06:14:16.658342 [info ] [MainThread]: Configuration:
[0m06:14:16.659118 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:14:16.659768 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:14:16.660326 [info ] [MainThread]: Required dependencies:
[0m06:14:16.660892 [debug] [MainThread]: Executing "git --help"
[0m06:14:16.663854 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:14:16.664678 [debug] [MainThread]: STDERR: "b''"
[0m06:14:16.665149 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:14:16.665787 [info ] [MainThread]: Connection:
[0m06:14:16.666449 [info ] [MainThread]:   method: service-account
[0m06:14:16.666966 [info ] [MainThread]:   database: project-data-engineer-469310
[0m06:14:16.667498 [info ] [MainThread]:   execution_project: project-data-engineer-469310
[0m06:14:16.668014 [info ] [MainThread]:   schema: dbt_glramira
[0m06:14:16.668514 [info ] [MainThread]:   location: africa-south1
[0m06:14:16.669023 [info ] [MainThread]:   priority: interactive
[0m06:14:16.669508 [info ] [MainThread]:   maximum_bytes_billed: None
[0m06:14:16.670019 [info ] [MainThread]:   impersonate_service_account: None
[0m06:14:16.670533 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m06:14:16.671131 [info ] [MainThread]:   job_retries: 1
[0m06:14:16.671723 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m06:14:16.672314 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m06:14:16.672872 [info ] [MainThread]:   timeout_seconds: 300
[0m06:14:16.673423 [info ] [MainThread]:   client_id: None
[0m06:14:16.673944 [info ] [MainThread]:   token_uri: None
[0m06:14:16.674447 [info ] [MainThread]:   compute_region: None
[0m06:14:16.674966 [info ] [MainThread]:   dataproc_cluster_name: None
[0m06:14:16.675508 [info ] [MainThread]:   gcs_bucket: None
[0m06:14:16.676039 [info ] [MainThread]:   dataproc_batch: None
[0m06:14:16.676799 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:14:16.890452 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m06:14:16.891125 [debug] [MainThread]: On debug: select 1 as id
[0m06:14:16.891719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:19.124460 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bd2d7067-a886-4a68-a231-f2a6ae190220&page=queryresults
[0m06:14:19.956680 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:14:19.957897 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:14:19.959342 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.8572445, "process_in_blocks": "8", "process_kernel_time": 0.705507, "process_mem_max_rss": "387004", "process_out_blocks": "16", "process_user_time": 5.555598}
[0m06:14:19.960082 [debug] [MainThread]: Command `dbt debug` succeeded at 06:14:19.959934 after 6.86 seconds
[0m06:14:19.960538 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:14:19.961089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66c1e1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe670357010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64c8b0f50>]}
[0m06:14:19.961682 [debug] [MainThread]: Flushing usage events
[0m06:14:20.129464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:14:25.942283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb559d2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5684bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb55af6a50>]}


============================== 06:14:25.946906 | 7382f661-db8e-4492-9202-38c15037a837 ==============================
[0m06:14:25.946906 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:14:25.947930 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:14:26.110304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7382f661-db8e-4492-9202-38c15037a837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb558c5610>]}
[0m06:14:26.135062 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_h1gofvn'
[0m06:14:26.136368 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:14:26.319453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:14:26.322331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m06:14:26.442718 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m06:14:26.446091 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m06:14:26.446852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7382f661-db8e-4492-9202-38c15037a837', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb55816150>]}
[0m06:14:26.454511 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m06:14:26.573547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m06:14:26.589487 [info ] [MainThread]: Updating lock file in file path: /home/quakinh943/dbt_glamira_prod/glramira/package-lock.yml
[0m06:14:26.598393 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rlpbwipp'
[0m06:14:26.604700 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m06:14:27.032906 [info ] [MainThread]: Installed from version 0.10.4
[0m06:14:27.033665 [info ] [MainThread]: Up to date!
[0m06:14:27.034354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7382f661-db8e-4492-9202-38c15037a837', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5578ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb558cd2d0>]}
[0m06:14:27.034935 [info ] [MainThread]: Installing calogica/dbt_date
[0m06:14:27.200561 [info ] [MainThread]: Installed from version 0.10.1
[0m06:14:27.201288 [info ] [MainThread]: Up to date!
[0m06:14:27.202001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7382f661-db8e-4492-9202-38c15037a837', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5574ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5565fe10>]}
[0m06:14:27.203907 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:14:27.205254 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3379657, "process_in_blocks": "240", "process_kernel_time": 0.38757, "process_mem_max_rss": "111492", "process_out_blocks": "20848", "process_user_time": 2.280779}
[0m06:14:27.205997 [debug] [MainThread]: Command `dbt deps` succeeded at 06:14:27.205802 after 1.34 seconds
[0m06:14:27.206597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb559ca4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb55842c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb59c101d0>]}
[0m06:14:27.207230 [debug] [MainThread]: Flushing usage events
[0m06:14:27.372354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:14:47.814758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019c4f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019bea290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019c4e590>]}


============================== 06:14:47.819293 | 7120e911-5cb9-48e1-9290-492395cba970 ==============================
[0m06:14:47.819293 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:14:47.820220 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'None', 'write_json': 'True'}
[0m06:14:51.356391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7120e911-5cb9-48e1-9290-492395cba970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feffa100350>]}
[0m06:14:51.447387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7120e911-5cb9-48e1-9290-492395cba970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01c7f9450>]}
[0m06:14:51.448524 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:14:51.734402 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:14:51.885334 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m06:14:51.886200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7120e911-5cb9-48e1-9290-492395cba970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01abae710>]}
[0m06:14:53.890623 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_not_be_null`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m06:14:53.891545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7120e911-5cb9-48e1-9290-492395cba970', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9daacd0>]}
[0m06:14:54.037082 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_source_expect_column_values_to_not_be_null_product_info_event_event_id (models/staging/source.yml)
  macro 'dbt_macro__test_expect_column_values_to_not_be_null' takes no keyword argument 'column'
[0m06:14:54.038354 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:14:54.040018 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.2987247, "process_in_blocks": "16", "process_kernel_time": 0.823118, "process_mem_max_rss": "392832", "process_out_blocks": "32", "process_user_time": 7.791881}
[0m06:14:54.040872 [debug] [MainThread]: Command `dbt test` failed at 06:14:54.040662 after 6.30 seconds
[0m06:14:54.041544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff92c9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9bbf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019d9dc10>]}
[0m06:14:54.042201 [debug] [MainThread]: Flushing usage events
[0m06:14:54.230184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:15:12.233199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28ab1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28ab2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28ab3310>]}


============================== 06:15:12.238219 | 802cc5df-ce6a-4d8a-b970-f1b0ad38ba81 ==============================
[0m06:15:12.238219 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:15:12.239226 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select source:product_info', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True'}
[0m06:15:15.737982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '802cc5df-ce6a-4d8a-b970-f1b0ad38ba81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda09124b90>]}
[0m06:15:15.824818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '802cc5df-ce6a-4d8a-b970-f1b0ad38ba81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2b6c8910>]}
[0m06:15:15.825919 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:15:16.096301 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:15:16.229596 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m06:15:16.230413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '802cc5df-ce6a-4d8a-b970-f1b0ad38ba81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda29a828d0>]}
[0m06:15:18.088653 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_not_be_null`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m06:15:18.089539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '802cc5df-ce6a-4d8a-b970-f1b0ad38ba81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda08122f50>]}
[0m06:15:18.222970 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_source_expect_column_values_to_not_be_null_product_info_event_event_id (models/staging/source.yml)
  macro 'dbt_macro__test_expect_column_values_to_not_be_null' takes no keyword argument 'column'
[0m06:15:18.224073 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:15:18.225498 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.0746737, "process_in_blocks": "0", "process_kernel_time": 0.759974, "process_mem_max_rss": "394536", "process_out_blocks": "8", "process_user_time": 7.646011}
[0m06:15:18.226240 [debug] [MainThread]: Command `dbt test` failed at 06:15:18.226073 after 6.08 seconds
[0m06:15:18.226863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28b24110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28b27fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda081e5e50>]}
[0m06:15:18.227528 [debug] [MainThread]: Flushing usage events
[0m06:15:18.399477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:16:44.241009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd41024d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd42b6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd42b5cd0>]}


============================== 06:16:44.245624 | a979980d-850c-4eab-92ee-e49175858f81 ==============================
[0m06:16:44.245624 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:16:44.246571 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'invocation_command': 'dbt test --select source:product_info', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs'}
[0m06:16:47.752795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a979980d-850c-4eab-92ee-e49175858f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db470cdd0>]}
[0m06:16:47.838587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a979980d-850c-4eab-92ee-e49175858f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd6d19650>]}
[0m06:16:47.839796 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:16:48.086799 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:16:48.219998 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m06:16:48.220874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a979980d-850c-4eab-92ee-e49175858f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd50c6610>]}
[0m06:16:50.248053 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_source_expect_column_values_to_not_be_null_product_info_event_event_id (models/staging/source.yml)
  macro 'dbt_macro__test_expect_column_values_to_not_be_null' takes no keyword argument 'column'
[0m06:16:50.249681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.0874763, "process_in_blocks": "0", "process_kernel_time": 0.880535, "process_mem_max_rss": "392668", "process_out_blocks": "16", "process_user_time": 7.587507}
[0m06:16:50.250455 [debug] [MainThread]: Command `dbt test` failed at 06:16:50.250276 after 6.09 seconds
[0m06:16:50.251045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db416fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db4180b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db430bcd0>]}
[0m06:16:50.251727 [debug] [MainThread]: Flushing usage events
[0m06:16:50.441243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:00.548560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d967e9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d967e2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d96995950>]}


============================== 13:56:00.556438 | 6758a26a-33ec-417c-9278-24f22e9a6b93 ==============================
[0m13:56:00.556438 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:56:00.557737 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'version_check': 'True'}
[0m13:56:00.798365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6758a26a-33ec-417c-9278-24f22e9a6b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9681d690>]}
[0m13:56:00.848991 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-knshjhgv'
[0m13:56:00.849961 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:56:00.969045 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:56:00.971767 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:56:01.053935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:56:01.057116 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:56:01.057921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6758a26a-33ec-417c-9278-24f22e9a6b93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9662bed0>]}
[0m13:56:01.061891 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:56:01.141600 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:56:01.147036 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:56:01.688235 [info ] [MainThread]: Installed from version 0.10.4
[0m13:56:01.689253 [info ] [MainThread]: Up to date!
[0m13:56:01.690123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6758a26a-33ec-417c-9278-24f22e9a6b93', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d98bbc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d977acc50>]}
[0m13:56:01.691083 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:56:01.907291 [info ] [MainThread]: Installed from version 0.10.1
[0m13:56:01.907913 [info ] [MainThread]: Up to date!
[0m13:56:01.909368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6758a26a-33ec-417c-9278-24f22e9a6b93', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d96566a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d976582d0>]}
[0m13:56:01.912185 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:56:01.913733 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4912952, "process_in_blocks": "424", "process_kernel_time": 0.480822, "process_mem_max_rss": "111340", "process_out_blocks": "20848", "process_user_time": 2.521449}
[0m13:56:01.914457 [debug] [MainThread]: Command `cli deps` succeeded at 13:56:01.914255 after 1.49 seconds
[0m13:56:01.915137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d96aa8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d96995a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d967d8790>]}
[0m13:56:01.915824 [debug] [MainThread]: Flushing usage events
[0m13:56:02.119797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:05.245958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d08f2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d0a9dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d0a9d950>]}


============================== 16:51:05.251123 | 0d742861-0bd2-4cee-ad54-7dfbc71aab18 ==============================
[0m16:51:05.251123 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:51:05.251981 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'empty': 'None', 'introspect': 'True'}
[0m16:51:05.409452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d742861-0bd2-4cee-ad54-7dfbc71aab18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d08ea590>]}
[0m16:51:05.451022 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qnmzt_6i'
[0m16:51:05.451739 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:51:05.650041 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:51:05.652659 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m16:51:05.785072 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m16:51:05.788087 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m16:51:05.788843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d742861-0bd2-4cee-ad54-7dfbc71aab18', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d094f7d0>]}
[0m16:51:05.792818 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:51:06.014000 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:51:06.019457 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m16:51:06.497871 [info ] [MainThread]: Installed from version 0.10.4
[0m16:51:06.498578 [info ] [MainThread]: Up to date!
[0m16:51:06.499409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0d742861-0bd2-4cee-ad54-7dfbc71aab18', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d18acd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d094f750>]}
[0m16:51:06.500003 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:51:06.667245 [info ] [MainThread]: Installed from version 0.10.1
[0m16:51:06.667862 [info ] [MainThread]: Up to date!
[0m16:51:06.668378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0d742861-0bd2-4cee-ad54-7dfbc71aab18', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d066a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d094d550>]}
[0m16:51:06.670468 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:51:06.672108 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4977603, "process_in_blocks": "160", "process_kernel_time": 0.291599, "process_mem_max_rss": "111220", "process_out_blocks": "20848", "process_user_time": 2.340252}
[0m16:51:06.672705 [debug] [MainThread]: Command `cli deps` succeeded at 16:51:06.672571 after 1.50 seconds
[0m16:51:06.673161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d07f4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d08ea510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d08e9750>]}
[0m16:51:06.673660 [debug] [MainThread]: Flushing usage events
[0m16:51:06.863428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:11.551493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432c05cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432c05990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432c05bd0>]}


============================== 16:56:11.556211 | 8a039f3d-6f01-4ca6-9871-fb11e7dde0ff ==============================
[0m16:56:11.556211 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:56:11.557235 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'invocation_command': 'dbt run-operation debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'None'}
[0m16:56:14.914943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a039f3d-6f01-4ca6-9871-fb11e7dde0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4331ec790>]}
[0m16:56:14.998513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a039f3d-6f01-4ca6-9871-fb11e7dde0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4358595d0>]}
[0m16:56:14.999598 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:56:15.276897 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:56:15.412936 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:56:15.413686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a039f3d-6f01-4ca6-9871-fb11e7dde0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4331732d0>]}
[0m16:56:17.488276 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_source_expect_column_values_to_not_be_null_product_info_event_event_id (models/staging/source.yml)
  macro 'dbt_macro__test_expect_column_values_to_not_be_null' takes no keyword argument 'column'
[0m16:56:17.489837 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 6.0153723, "process_in_blocks": "24", "process_kernel_time": 0.755802, "process_mem_max_rss": "394952", "process_out_blocks": "24", "process_user_time": 7.577661}
[0m16:56:17.490637 [debug] [MainThread]: Command `dbt run-operation` failed at 16:56:17.490463 after 6.02 seconds
[0m16:56:17.491214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432a62090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432a61990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd412d6fe90>]}
[0m16:56:17.491821 [debug] [MainThread]: Flushing usage events
[0m16:56:17.701919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:57.463134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d33eb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d33e2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d33eac90>]}


============================== 16:56:57.467560 | 6821f612-eaf9-4622-a8db-f0c8cda91c27 ==============================
[0m16:56:57.467560 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:56:57.468374 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'empty': 'False', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt compile --select stg_dim_date', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m16:57:00.796813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6821f612-eaf9-4622-a8db-f0c8cda91c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b3ad8f50>]}
[0m16:57:00.881636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6821f612-eaf9-4622-a8db-f0c8cda91c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d5f60990>]}
[0m16:57:00.882736 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:57:01.126164 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:57:01.265961 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:57:01.266903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6821f612-eaf9-4622-a8db-f0c8cda91c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d3d2b490>]}
[0m16:57:03.338577 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_source_expect_column_values_to_not_be_null_product_info_event_event_id (models/staging/source.yml)
  macro 'dbt_macro__test_expect_column_values_to_not_be_null' takes no keyword argument 'column'
[0m16:57:03.340294 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 5.9510665, "process_in_blocks": "0", "process_kernel_time": 0.729659, "process_mem_max_rss": "394964", "process_out_blocks": "24", "process_user_time": 7.636197}
[0m16:57:03.341100 [debug] [MainThread]: Command `dbt compile` failed at 16:57:03.340889 after 5.95 seconds
[0m16:57:03.341771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d3450690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d3453c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b33bab50>]}
[0m16:57:03.342441 [debug] [MainThread]: Flushing usage events
[0m16:57:03.512255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:05.673635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19976ea990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997895d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19976eb450>]}


============================== 16:58:05.678175 | 74137542-fbf4-438d-a6ad-880740cfcf81 ==============================
[0m16:58:05.678175 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:58:05.679057 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt compile --select stg_dim_date', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'quiet': 'False', 'debug': 'False'}
[0m16:58:08.976386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977e901d0>]}
[0m16:58:09.063610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199a360a90>]}
[0m16:58:09.064682 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:58:09.422454 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:58:09.563543 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:58:09.564389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199802f350>]}
[0m16:58:11.675932 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m16:58:11.676797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977705690>]}
[0m16:58:11.821696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m16:58:11.839069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1976ca0e10>]}
[0m16:58:11.970095 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:58:11.974453 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:58:11.993253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1976c2f3d0>]}
[0m16:58:11.994085 [info ] [MainThread]: Found 10 models, 12 data tests, 3 sources, 762 macros
[0m16:58:11.994713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1976b72dd0>]}
[0m16:58:11.996908 [info ] [MainThread]: 
[0m16:58:11.997499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:11.998002 [info ] [MainThread]: 
[0m16:58:11.998795 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:12.005091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m16:58:12.005820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:12.520029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74137542-fbf4-438d-a6ad-880740cfcf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1976c23110>]}
[0m16:58:12.520828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:12.528981 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m16:58:12.529881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m16:58:12.530547 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m16:58:12.542560 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m16:58:12.543697 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m16:58:12.544376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:12.547055 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m16:58:12.549101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:12.549635 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m16:58:12.550581 [debug] [MainThread]: Command end result
[0m16:58:12.601000 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:58:12.603749 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:58:12.612262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m16:58:12.612933 [info ] [MainThread]: Compiled node 'stg_dim_date' is:
WITH date AS (
    SELECT DISTINCT
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS date_id,
        FORMAT_TIMESTAMP('%m/%d/%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS full_date,
        CAST(FORMAT_TIMESTAMP('%d', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS day,
        CAST(FORMAT_TIMESTAMP('%m', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS month,
        CAST(FORMAT_TIMESTAMP('%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS year,
        CASE 
            WHEN EXTRACT(DAYOFWEEK FROM TIMESTAMP_SECONDS(`time_stamp`)) IN (1, 7) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM date
[0m16:58:12.613855 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:58:12.615260 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.016682, "process_in_blocks": "8", "process_kernel_time": 0.830009, "process_mem_max_rss": "401656", "process_out_blocks": "5216", "process_user_time": 8.159561}
[0m16:58:12.615970 [debug] [MainThread]: Command `dbt compile` succeeded at 16:58:12.615821 after 7.02 seconds
[0m16:58:12.616490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997755e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997895a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f197774bf90>]}
[0m16:58:12.616988 [debug] [MainThread]: Flushing usage events
[0m16:58:12.846185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:56.262653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7d9a1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7d9a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7d9a1a90>]}


============================== 16:59:56.267303 | 54a6b1bb-ddff-489c-a876-ba07b34ad37b ==============================
[0m16:59:56.267303 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:59:56.268250 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --select stg_dim_date'}
[0m16:59:59.733541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a6b1bb-ddff-489c-a876-ba07b34ad37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5de3c410>]}
[0m16:59:59.818971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a6b1bb-ddff-489c-a876-ba07b34ad37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b80359290>]}
[0m16:59:59.820066 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:00:00.102544 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:00.282270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:00.282947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:00.291440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m17:00:00.348282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a6b1bb-ddff-489c-a876-ba07b34ad37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5d900f10>]}
[0m17:00:00.494337 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:00:00.497436 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:00:00.681373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a6b1bb-ddff-489c-a876-ba07b34ad37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5cdc4d10>]}
[0m17:00:00.682276 [info ] [MainThread]: Found 10 models, 12 data tests, 3 sources, 762 macros
[0m17:00:00.682896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a6b1bb-ddff-489c-a876-ba07b34ad37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5dbcef50>]}
[0m17:00:00.684968 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:00:00.687591 [debug] [MainThread]: Command end result
[0m17:00:00.737761 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:00:00.740592 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:00:00.745176 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:00:00.746623 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.556759, "process_in_blocks": "864", "process_kernel_time": 0.825731, "process_mem_max_rss": "421844", "process_out_blocks": "4688", "process_user_time": 6.010908}
[0m17:00:00.747715 [debug] [MainThread]: Command `dbt test` succeeded at 17:00:00.747521 after 4.56 seconds
[0m17:00:00.748339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7d852110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7d91ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b819671d0>]}
[0m17:00:00.749009 [debug] [MainThread]: Flushing usage events
[0m17:00:00.962861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:02.888165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d4db4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d4d1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d4db590>]}


============================== 17:01:02.892615 | d5dda6f2-08e4-4b90-81ee-ed0ecc547138 ==============================
[0m17:01:02.892615 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:01:02.893500 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt show --select stg_dim_date --limit 20', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False'}
[0m17:01:06.250084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d4e3590>]}
[0m17:01:06.335562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d38a410>]}
[0m17:01:06.356899 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:01:06.600604 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:01:06.793476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:06.794122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:06.802471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m17:01:06.857749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d65b5d0>]}
[0m17:01:06.996696 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:01:06.999686 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:01:07.004484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d73fdd0>]}
[0m17:01:07.005349 [info ] [MainThread]: Found 10 models, 12 data tests, 3 sources, 762 macros
[0m17:01:07.006009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87daa4e10>]}
[0m17:01:07.008341 [info ] [MainThread]: 
[0m17:01:07.008964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:01:07.009500 [info ] [MainThread]: 
[0m17:01:07.010382 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:01:07.016855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m17:01:07.017613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:07.486204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5dda6f2-08e4-4b90-81ee-ed0ecc547138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d732a50>]}
[0m17:01:07.487001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:07.494496 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m17:01:07.495436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m17:01:07.496085 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m17:01:07.510235 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m17:01:07.511447 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m17:01:07.522882 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */

  
  WITH date AS (
    SELECT DISTINCT
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS date_id,
        FORMAT_TIMESTAMP('%m/%d/%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS full_date,
        CAST(FORMAT_TIMESTAMP('%d', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS day,
        CAST(FORMAT_TIMESTAMP('%m', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS month,
        CAST(FORMAT_TIMESTAMP('%Y', TIMESTAMP_SECONDS(`time_stamp`)) AS INT64) AS year,
        CASE 
            WHEN EXTRACT(DAYOFWEEK FROM TIMESTAMP_SECONDS(`time_stamp`)) IN (1, 7) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM date
  
  limit 20

[0m17:01:07.523711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:10.829829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:05c62637-f40d-4d3d-a837-fadc5a99396a&page=queryresults
[0m17:01:12.752820 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m17:01:12.755104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:12.755745 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m17:01:12.756753 [debug] [MainThread]: Command end result
[0m17:01:12.807944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:01:12.810777 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:01:12.820123 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:01:12.821065 [info ] [MainThread]: Previewing node 'stg_dim_date':
| date_id | full_date  | day | month | year | is_weekend |
| ------- | ---------- | --- | ----- | ---- | ---------- |
| 5032020 | 05/03/2020 |   3 |     5 | 2020 |       True |
| 4042020 | 04/04/2020 |   4 |     4 | 2020 |       True |
| 5192020 | 05/19/2020 |  19 |     5 | 2020 |      False |
| 4132020 | 04/13/2020 |  13 |     4 | 2020 |      False |
| 4082020 | 04/08/2020 |   8 |     4 | 2020 |      False |
| 4162020 | 04/16/2020 |  16 |     4 | 2020 |      False |
| 5132020 | 05/13/2020 |  13 |     5 | 2020 |      False |
| 5172020 | 05/17/2020 |  17 |     5 | 2020 |       True |
| 5042020 | 05/04/2020 |   4 |     5 | 2020 |      False |
| 5202020 | 05/20/2020 |  20 |     5 | 2020 |      False |
| 6042020 | 06/04/2020 |   4 |     6 | 2020 |      False |
| 4032020 | 04/03/2020 |   3 |     4 | 2020 |      False |
| 4012020 | 04/01/2020 |   1 |     4 | 2020 |      False |
| 5232020 | 05/23/2020 |  23 |     5 | 2020 |       True |
| 4192020 | 04/19/2020 |  19 |     4 | 2020 |       True |
| 4242020 | 04/24/2020 |  24 |     4 | 2020 |      False |
| 5112020 | 05/11/2020 |  11 |     5 | 2020 |      False |
| 4052020 | 04/05/2020 |   5 |     4 | 2020 |       True |
| 5062020 | 05/06/2020 |   6 |     5 | 2020 |      False |
| 5152020 | 05/15/2020 |  15 |     5 | 2020 |      False |

[0m17:01:12.822665 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 10.019803, "process_in_blocks": "24", "process_kernel_time": 0.820727, "process_mem_max_rss": "397472", "process_out_blocks": "3528", "process_user_time": 6.185268}
[0m17:01:12.823332 [debug] [MainThread]: Command `dbt show` succeeded at 17:01:12.823187 after 10.02 seconds
[0m17:01:12.823889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d506290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89d536fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a1760450>]}
[0m17:01:12.824440 [debug] [MainThread]: Flushing usage events
[0m17:01:13.020189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:29.732442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb1e16850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb1c72c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb1c71e10>]}


============================== 18:01:29.737144 | d283a655-b6e3-41bb-a9a3-5bdf44d95c85 ==============================
[0m18:01:29.737144 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:01:29.738104 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt show --select stg_fact_order --limit 20', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'write_json': 'True', 'empty': 'None'}
[0m18:01:33.288017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e92389ed0>]}
[0m18:01:33.375573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb4a05490>]}
[0m18:01:33.394654 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:01:33.652140 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:01:33.856195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m18:01:33.858319 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/source.yml
[0m18:01:33.859322 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_location.sql
[0m18:01:33.860110 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:01:33.860668 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_store.sql
[0m18:01:33.861177 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_product.sql
[0m18:01:33.861648 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_user.sql
[0m18:01:33.862194 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_dim_device.sql
[0m18:01:34.506230 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:01:34.507047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e91b66710>]}
[0m18:01:34.862175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:01:34.876359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e91a7c4d0>]}
[0m18:01:35.018091 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:01:35.021237 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:01:35.027257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e920b81d0>]}
[0m18:01:35.028142 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:01:35.028722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd283a655-b6e3-41bb-a9a3-5bdf44d95c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e91cd0990>]}
[0m18:01:35.029841 [warn ] [MainThread]: The selection criterion 'stg_fact_order' does not match any enabled nodes
[0m18:01:35.031654 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:01:35.032482 [debug] [MainThread]: Command end result
[0m18:01:35.083071 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:01:35.085782 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:01:35.089972 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:01:35.090881 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 8 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:35.092350 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 5.434476, "process_in_blocks": "0", "process_kernel_time": 0.970093, "process_mem_max_rss": "399708", "process_out_blocks": "5392", "process_user_time": 6.746187}
[0m18:01:35.093030 [debug] [MainThread]: Command `dbt show` succeeded at 18:01:35.092846 after 5.44 seconds
[0m18:01:35.093590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb1c81fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb1c800d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb60a44d0>]}
[0m18:01:35.094175 [debug] [MainThread]: Flushing usage events
[0m18:01:35.293437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:15.814421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b3607e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b3607950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b3607010>]}


============================== 18:02:15.818899 | cb7213b2-6f1a-4dbb-b657-ab3f3316e30d ==============================
[0m18:02:15.818899 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:02:15.819760 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt show --select stg_fact_order --limit 20', 'use_colors': 'True', 'empty': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m18:02:19.577830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff093dc3d10>]}
[0m18:02:19.672838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b61fd910>]}
[0m18:02:19.695124 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:02:20.010741 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:02:20.234302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:20.235647 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:02:20.751208 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:02:20.752038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09355a450>]}
[0m18:02:20.937023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:02:20.957179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0935bf210>]}
[0m18:02:21.099296 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:02:21.102539 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:02:21.109011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09370e610>]}
[0m18:02:21.109895 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:02:21.110488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb7213b2-6f1a-4dbb-b657-ab3f3316e30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff093dd6e10>]}
[0m18:02:21.111632 [warn ] [MainThread]: The selection criterion 'stg_fact_order' does not match any enabled nodes
[0m18:02:21.113362 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:02:21.114193 [debug] [MainThread]: Command end result
[0m18:02:21.168269 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:02:21.171382 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:02:21.175724 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:02:21.176764 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:02:21.178202 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 5.4376135, "process_in_blocks": "0", "process_kernel_time": 1.104041, "process_mem_max_rss": "398232", "process_out_blocks": "5424", "process_user_time": 6.688087}
[0m18:02:21.179171 [debug] [MainThread]: Command `dbt show` succeeded at 18:02:21.179006 after 5.44 seconds
[0m18:02:21.179795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b3469b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b3469990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b78a0450>]}
[0m18:02:21.180382 [debug] [MainThread]: Flushing usage events
[0m18:02:21.352307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:22.668814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1befdbee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1befdbec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1befdbef10>]}


============================== 18:04:22.673485 | 621db900-6c25-4b85-b708-cf95e671719a ==============================
[0m18:04:22.673485 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:04:22.674426 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt test -m stg_fact_orders', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True'}
[0m18:04:22.675030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:04:22.675712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '621db900-6c25-4b85-b708-cf95e671719a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1beff621d0>]}
[0m18:04:26.223716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '621db900-6c25-4b85-b708-cf95e671719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bd0415490>]}
[0m18:04:26.312454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '621db900-6c25-4b85-b708-cf95e671719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf2949690>]}
[0m18:04:26.313555 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:04:26.575486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:04:26.783023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:26.784510 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/source.yml
[0m18:04:27.289633 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/source.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'strictly': True})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:04:27.290741 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:04:27.292470 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.697065, "process_in_blocks": "0", "process_kernel_time": 0.898512, "process_mem_max_rss": "395596", "process_out_blocks": "16", "process_user_time": 6.113258}
[0m18:04:27.293460 [debug] [MainThread]: Command `dbt test` failed at 18:04:27.293292 after 4.70 seconds
[0m18:04:27.294059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf3f372d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bcfdf5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bcfc38310>]}
[0m18:04:27.294641 [debug] [MainThread]: Flushing usage events
[0m18:04:27.495633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:16.355294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ffbf18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ffeac9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ffc53f90>]}


============================== 18:06:16.360193 | d36c1344-102d-44e4-a5bf-f7ff36c52201 ==============================
[0m18:06:16.360193 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:06:16.361120 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test -m stg_fact_orders', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m18:06:16.361760 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:06:16.362391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ffc33a50>]}
[0m18:06:19.707060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e011ebd0>]}
[0m18:06:19.794835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27027f9510>]}
[0m18:06:19.795938 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:06:20.044218 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:06:20.241149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:20.241870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:20.250701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:06:20.310030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dfaf6a10>]}
[0m18:06:20.449631 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:06:20.452651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:06:20.491146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dfa83f90>]}
[0m18:06:20.492065 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:06:20.492643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dff54a10>]}
[0m18:06:20.495548 [info ] [MainThread]: 
[0m18:06:20.496119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:20.496615 [info ] [MainThread]: 
[0m18:06:20.497429 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:06:20.504064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:06:20.504790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:21.109635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36c1344-102d-44e4-a5bf-f7ff36c52201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dff56b10>]}
[0m18:06:21.110629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:21.118817 [debug] [Thread-1 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:06:21.119651 [debug] [Thread-2 (]: Began running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:06:21.121058 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:06:21.120389 [info ] [Thread-1 (]: 1 of 9 START test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True  [RUN]
[0m18:06:21.121995 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:06:21.122588 [info ] [Thread-2 (]: 2 of 9 START test not_null_stg_fact_orders_event_id ............................ [RUN]
[0m18:06:21.123308 [info ] [Thread-3 (]: 3 of 9 START test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_  [RUN]
[0m18:06:21.124155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a)
[0m18:06:21.124845 [info ] [Thread-4 (]: 4 of 9 START test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_  [RUN]
[0m18:06:21.125865 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a'
[0m18:06:21.126880 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec'
[0m18:06:21.127822 [debug] [Thread-1 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:06:21.128982 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867'
[0m18:06:21.129612 [debug] [Thread-2 (]: Began compiling node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:06:21.130313 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:06:21.155284 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:06:21.167687 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:06:21.185990 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:06:21.195237 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:06:21.203886 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:06:21.205933 [debug] [Thread-1 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:06:21.206893 [debug] [Thread-2 (]: Began executing node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:06:21.207529 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:06:21.229183 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:06:21.263160 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:06:21.268449 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:06:21.271570 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:06:21.276340 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:06:21.278385 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:21.279303 [debug] [Thread-2 (]: On test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:06:21.280501 [debug] [Thread-1 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and total_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m18:06:21.281380 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:06:21.282115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:06:21.282892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:21.283661 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:21.364060 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:06:23.131920 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0a919415-cb79-4bfe-b600-d17e4b927719&page=queryresults
[0m18:06:23.132815 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0a919415-cb79-4bfe-b600-d17e4b927719&page=queryresults
[0m18:06:23.144877 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_9e21d9a4a5764a24a4cfaca4b6849d99.sql
[0m18:06:23.145826 [error] [Thread-4 (]: 4 of 9 ERROR relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_  [[31mERROR[0m in 2.02s]
[0m18:06:23.146819 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:06:23.147529 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:06:23.148235 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_9e21d9a4a5764a24a4cfaca4b6849d99.sql.
[0m18:06:23.148864 [info ] [Thread-4 (]: 5 of 9 START test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_  [RUN]
[0m18:06:23.150735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867, now test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f)
[0m18:06:23.151325 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:06:23.160631 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:06:23.161599 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:06:23.165681 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:06:23.166734 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:23.167457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:23.593683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:584d8e50-cd12-44c8-a9ba-7c65b411faa1&page=queryresults
[0m18:06:23.594751 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:584d8e50-cd12-44c8-a9ba-7c65b411faa1&page=queryresults
[0m18:06:23.602083 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [23:11]
  compiled code at target/run/glramira/models/staging/source.yml/dbt_expectations_expect_column_3b2674034e585ddfd968692ffe1b2338.sql
[0m18:06:23.602973 [error] [Thread-1 (]: 1 of 9 ERROR dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True  [[31mERROR[0m in 2.48s]
[0m18:06:23.603913 [debug] [Thread-1 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:06:23.604519 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:06:23.605171 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [23:11]
  compiled code at target/run/glramira/models/staging/source.yml/dbt_expectations_expect_column_3b2674034e585ddfd968692ffe1b2338.sql.
[0m18:06:23.605776 [info ] [Thread-1 (]: 6 of 9 START test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_  [RUN]
[0m18:06:23.606908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a, now test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121)
[0m18:06:23.607521 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:06:23.616322 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:06:23.617311 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:06:23.624062 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:06:23.625156 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:23.625843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:24.564970 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6b370b61-8649-4aa8-994e-98be97b12804&page=queryresults
[0m18:06:24.566031 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6b370b61-8649-4aa8-994e-98be97b12804&page=queryresults
[0m18:06:24.574226 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ba36c97765f75b8a4c393361e6c6d617.sql
[0m18:06:24.575192 [error] [Thread-4 (]: 5 of 9 ERROR relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_  [[31mERROR[0m in 1.42s]
[0m18:06:24.576196 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:06:24.576817 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:06:24.577524 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ba36c97765f75b8a4c393361e6c6d617.sql.
[0m18:06:24.578118 [info ] [Thread-4 (]: 7 of 9 START test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_  [RUN]
[0m18:06:24.579219 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f, now test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731)
[0m18:06:24.579812 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:06:24.588568 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:06:24.589544 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:06:24.593810 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:06:24.594855 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:24.595542 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:24.663533 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8018e0e0-2e56-4704-8108-bbd36dfab9d9&page=queryresults
[0m18:06:24.665022 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8018e0e0-2e56-4704-8108-bbd36dfab9d9&page=queryresults
[0m18:06:24.675827 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_be75a233972114cffad4b3ea17280e95.sql
[0m18:06:24.677100 [error] [Thread-3 (]: 3 of 9 ERROR relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ . [[31mERROR[0m in 3.55s]
[0m18:06:24.678337 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:06:24.679211 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:06:24.680237 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_be75a233972114cffad4b3ea17280e95.sql.
[0m18:06:24.680898 [info ] [Thread-3 (]: 8 of 9 START test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_  [RUN]
[0m18:06:24.682276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec, now test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80)
[0m18:06:24.683074 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:06:24.692441 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:06:24.693651 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:06:24.697860 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:06:24.698970 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:06:24.699882 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:24.949426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:666f98ea-932c-4a0c-a974-add4e284d39f&page=queryresults
[0m18:06:24.950606 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:666f98ea-932c-4a0c-a974-add4e284d39f&page=queryresults
[0m18:06:24.958218 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ca15892533d437b51422afbfa0881814.sql
[0m18:06:24.959251 [error] [Thread-1 (]: 6 of 9 ERROR relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_  [[31mERROR[0m in 1.35s]
[0m18:06:24.960287 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:06:24.960887 [debug] [Thread-1 (]: Began running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:06:24.961636 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ca15892533d437b51422afbfa0881814.sql.
[0m18:06:24.962224 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_fact_orders_event_id .............................. [RUN]
[0m18:06:24.963293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121, now test.glramira.unique_stg_fact_orders_event_id.a749b832a4)
[0m18:06:24.964015 [debug] [Thread-1 (]: Began compiling node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:06:24.973196 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:06:24.974174 [debug] [Thread-1 (]: Began executing node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:06:24.978577 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:06:24.979588 [debug] [Thread-1 (]: On test.glramira.unique_stg_fact_orders_event_id.a749b832a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:06:24.980242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:25.055258 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d36d3ee3-bcc8-45e5-9a0c-b2039f4aa726&page=queryresults
[0m18:06:26.182564 [info ] [Thread-2 (]: 2 of 9 PASS not_null_stg_fact_orders_event_id .................................. [[32mPASS[0m in 5.06s]
[0m18:06:26.183694 [debug] [Thread-2 (]: Finished running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:06:26.222203 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:594aad3a-7566-4abe-8e9f-c6ee552cc90f&page=queryresults
[0m18:06:26.224174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bfca95ea-5e0a-4d04-be89-aeada525d5aa&page=queryresults
[0m18:06:26.223230 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:594aad3a-7566-4abe-8e9f-c6ee552cc90f&page=queryresults
[0m18:06:26.233302 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_39a80ee89b09ab533c24f11989ba1e5f.sql
[0m18:06:26.234234 [error] [Thread-3 (]: 8 of 9 ERROR relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ . [[31mERROR[0m in 1.55s]
[0m18:06:26.235121 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:06:26.236181 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_39a80ee89b09ab533c24f11989ba1e5f.sql.
[0m18:06:26.377642 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8028d356-ded9-4836-b8ba-99753e73370f&page=queryresults
[0m18:06:26.378520 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:8028d356-ded9-4836-b8ba-99753e73370f&page=queryresults
[0m18:06:26.385738 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_279264272981ae9713ac23aa51991b0e.sql
[0m18:06:26.386816 [error] [Thread-4 (]: 7 of 9 ERROR relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_  [[31mERROR[0m in 1.81s]
[0m18:06:26.387747 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:06:26.388522 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_279264272981ae9713ac23aa51991b0e.sql.
[0m18:06:27.102294 [error] [Thread-1 (]: 9 of 9 FAIL 4046640 unique_stg_fact_orders_event_id ............................ [[31mFAIL 4046640[0m in 2.14s]
[0m18:06:27.103276 [debug] [Thread-1 (]: Finished running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:06:27.105847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:27.108348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:27.108918 [debug] [MainThread]: Connection 'test.glramira.unique_stg_fact_orders_event_id.a749b832a4' was properly closed.
[0m18:06:27.109403 [debug] [MainThread]: Connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a' was properly closed.
[0m18:06:27.109934 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' was properly closed.
[0m18:06:27.110504 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' was properly closed.
[0m18:06:27.111119 [info ] [MainThread]: 
[0m18:06:27.111698 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m18:06:27.113994 [debug] [MainThread]: Command end result
[0m18:06:27.173345 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:06:27.176400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:06:27.185889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:06:27.186497 [info ] [MainThread]: 
[0m18:06:27.187150 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m18:06:27.187718 [info ] [MainThread]: 
[0m18:06:27.188382 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)[0m
[0m18:06:27.188996 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_9e21d9a4a5764a24a4cfaca4b6849d99.sql
[0m18:06:27.189486 [info ] [MainThread]: 
[0m18:06:27.190131 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_9e21d9a4a5764a24a4cfaca4b6849d99.sql
[0m18:06:27.190649 [info ] [MainThread]: 
[0m18:06:27.191260 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)[0m
[0m18:06:27.191919 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [23:11]
  compiled code at target/run/glramira/models/staging/source.yml/dbt_expectations_expect_column_3b2674034e585ddfd968692ffe1b2338.sql
[0m18:06:27.192393 [info ] [MainThread]: 
[0m18:06:27.193021 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/dbt_expectations_expect_column_3b2674034e585ddfd968692ffe1b2338.sql
[0m18:06:27.193516 [info ] [MainThread]: 
[0m18:06:27.194138 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)[0m
[0m18:06:27.194666 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ba36c97765f75b8a4c393361e6c6d617.sql
[0m18:06:27.195106 [info ] [MainThread]: 
[0m18:06:27.195626 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_ba36c97765f75b8a4c393361e6c6d617.sql
[0m18:06:27.196075 [info ] [MainThread]: 
[0m18:06:27.196648 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)[0m
[0m18:06:27.197275 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_be75a233972114cffad4b3ea17280e95.sql
[0m18:06:27.197714 [info ] [MainThread]: 
[0m18:06:27.198354 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_be75a233972114cffad4b3ea17280e95.sql
[0m18:06:27.198950 [info ] [MainThread]: 
[0m18:06:27.199529 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)[0m
[0m18:06:27.200098 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_ca15892533d437b51422afbfa0881814.sql
[0m18:06:27.200509 [info ] [MainThread]: 
[0m18:06:27.201050 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_ca15892533d437b51422afbfa0881814.sql
[0m18:06:27.201510 [info ] [MainThread]: 
[0m18:06:27.202141 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)[0m
[0m18:06:27.202715 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_39a80ee89b09ab533c24f11989ba1e5f.sql
[0m18:06:27.203287 [info ] [MainThread]: 
[0m18:06:27.203921 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_39a80ee89b09ab533c24f11989ba1e5f.sql
[0m18:06:27.204401 [info ] [MainThread]: 
[0m18:06:27.205124 [error] [MainThread]: [31mFailure in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)[0m
[0m18:06:27.205733 [error] [MainThread]:   Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [17:11]
  compiled code at target/run/glramira/models/staging/source.yml/relationships_stg_fact_orders_279264272981ae9713ac23aa51991b0e.sql
[0m18:06:27.206214 [info ] [MainThread]: 
[0m18:06:27.206825 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/relationships_stg_fact_orders_279264272981ae9713ac23aa51991b0e.sql
[0m18:06:27.207343 [info ] [MainThread]: 
[0m18:06:27.207968 [error] [MainThread]: [31mFailure in test unique_stg_fact_orders_event_id (models/staging/source.yml)[0m
[0m18:06:27.208678 [error] [MainThread]:   Got 4046640 results, configured to fail if != 0
[0m18:06:27.209126 [info ] [MainThread]: 
[0m18:06:27.209710 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/source.yml/unique_stg_fact_orders_event_id.sql
[0m18:06:27.210193 [info ] [MainThread]: 
[0m18:06:27.210709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=9
[0m18:06:27.211495 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:06:27.212855 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 10.931406, "process_in_blocks": "208", "process_kernel_time": 0.850154, "process_mem_max_rss": "408684", "process_out_blocks": "3880", "process_user_time": 8.35133}
[0m18:06:27.213544 [debug] [MainThread]: Command `dbt test` failed at 18:06:27.213366 after 10.93 seconds
[0m18:06:27.214211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2703dd32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ffc5f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700bb4210>]}
[0m18:06:27.214797 [debug] [MainThread]: Flushing usage events
[0m18:06:27.441668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:05.830443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42c06650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42d2aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42c07210>]}


============================== 18:07:05.834754 | 821d4472-a718-49a0-be04-1d6442b164da ==============================
[0m18:07:05.834754 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:07:05.835667 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:07:09.200996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed45386350>]}
[0m18:07:09.284963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed45824c90>]}
[0m18:07:09.300829 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:07:09.545607 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:07:09.776065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:09.776823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:09.785676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:07:09.843547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed230bfdd0>]}
[0m18:07:09.987752 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:07:09.990746 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:07:09.996605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed22fcc390>]}
[0m18:07:09.997544 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:07:09.998184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed22b241d0>]}
[0m18:07:10.001040 [info ] [MainThread]: 
[0m18:07:10.001620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:10.002276 [info ] [MainThread]: 
[0m18:07:10.003392 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:07:10.012304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:07:10.013115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:10.476141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821d4472-a718-49a0-be04-1d6442b164da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed44a32cd0>]}
[0m18:07:10.476995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:10.484524 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:07:10.485435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:07:10.486092 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:07:10.499728 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:07:10.500912 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:07:10.513350 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        cast(e1.event_id as string) as event_id,
        cast(e1.order_id as string) as order_id,
        cast(e1.product_id as string) as product_id,
        cast(e1.device_id as string) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as string) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(e1.price as float64) as price,
        cast(e1.amount as float64) as amount,
        cast(e1.currency as string) as currency,
        cast(e1.final_amount as float64) as final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:07:10.514217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:11.491522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d4d09a8c-68c1-410d-a9b9-728257f8a008&page=queryresults
[0m18:07:11.492600 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d4d09a8c-68c1-410d-a9b9-728257f8a008&page=queryresults
[0m18:07:11.499657 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name event_id not found inside e1 at [6:17]
[0m18:07:11.500995 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:07:11.501951 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name event_id not found inside e1 at [6:17].
[0m18:07:11.503657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:11.504335 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:07:11.505235 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Name event_id not found inside e1 at [6:17]
[0m18:07:11.506674 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 5.7490993, "process_in_blocks": "0", "process_kernel_time": 0.799805, "process_mem_max_rss": "394280", "process_out_blocks": "1896", "process_user_time": 6.169856}
[0m18:07:11.507327 [debug] [MainThread]: Command `dbt show` failed at 18:07:11.507174 after 5.75 seconds
[0m18:07:11.507894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed22d17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed46e17290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed46e17210>]}
[0m18:07:11.508517 [debug] [MainThread]: Flushing usage events
[0m18:07:11.675949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:58.769967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1892458d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa189245d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1891e2110>]}


============================== 18:08:58.775037 | 8249e2a8-2254-4197-81e1-335be6f2bd41 ==============================
[0m18:08:58.775037 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:08:58.776031 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:09:02.163928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1698904d0>]}
[0m18:09:02.249256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18bd60bd0>]}
[0m18:09:02.264918 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:09:02.507104 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:09:02.695160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:02.696429 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:09:03.182028 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:09:03.182884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa168fd7cd0>]}
[0m18:09:03.346448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:09:03.365850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa168ff8810>]}
[0m18:09:03.502594 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:09:03.505606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:09:03.511793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1694b14d0>]}
[0m18:09:03.512697 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:09:03.513373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18be5b990>]}
[0m18:09:03.516092 [info ] [MainThread]: 
[0m18:09:03.516712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:03.517281 [info ] [MainThread]: 
[0m18:09:03.518116 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:09:03.525505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:09:03.526452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:03.990817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8249e2a8-2254-4197-81e1-335be6f2bd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa169111b50>]}
[0m18:09:03.991978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:03.999945 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:09:04.000892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:09:04.001603 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:09:04.013518 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:09:04.014609 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:09:04.026856 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                coalesce(`order_id`, ''),
                coalesce(`product_id`, ''),
                coalesce(`device_id`, '')
            )
        ) as event_id,
        cast(e1.order_id as string) as order_id,
        cast(e1.product_id as string) as product_id,
        cast(e1.device_id as string) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as string) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(e1.price as float64) as price,
        cast(e1.amount as float64) as amount,
        cast(e1.currency as string) as currency,
        cast(e1.final_amount as float64) as final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:09:04.027813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:04.956368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b8440a9a-dd28-43f9-a3fc-82d2143c38c5&page=queryresults
[0m18:09:04.957349 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b8440a9a-dd28-43f9-a3fc-82d2143c38c5&page=queryresults
[0m18:09:04.964136 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name amount not found inside e1 at [21:17]
[0m18:09:04.965358 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:09:04.966425 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name amount not found inside e1 at [21:17].
[0m18:09:04.968297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:04.969127 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:09:04.969973 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Name amount not found inside e1 at [21:17]
[0m18:09:04.970887 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:09:04.972327 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.2792535, "process_in_blocks": "0", "process_kernel_time": 0.763002, "process_mem_max_rss": "403476", "process_out_blocks": "3680", "process_user_time": 6.703766}
[0m18:09:04.973009 [debug] [MainThread]: Command `dbt show` failed at 18:09:04.972844 after 6.28 seconds
[0m18:09:04.973556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1891e2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1891e20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa169205850>]}
[0m18:09:04.974137 [debug] [MainThread]: Flushing usage events
[0m18:09:05.165178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:25:37.723923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ecd9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ecd90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ecdaf10>]}


============================== 18:25:37.728604 | 1b48bbf0-1829-49c1-9222-b6be31885066 ==============================
[0m18:25:37.728604 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:25:37.729580 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'profiles_dir': '/home/quakinh943/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True'}
[0m18:25:41.273645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262f2c0810>]}
[0m18:25:41.360084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26318552d0>]}
[0m18:25:41.376175 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:25:41.625884 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:25:41.814165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:41.815549 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:25:42.296825 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:25:42.297588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260eaf9190>]}
[0m18:25:42.464729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:25:42.484973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260ea1be10>]}
[0m18:25:42.627938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:25:42.630955 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:25:42.637173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260e9c8c10>]}
[0m18:25:42.638017 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:25:42.638674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263195cb10>]}
[0m18:25:42.641376 [info ] [MainThread]: 
[0m18:25:42.642009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:25:42.642512 [info ] [MainThread]: 
[0m18:25:42.643292 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:25:42.649767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:25:42.650558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:43.124976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b48bbf0-1829-49c1-9222-b6be31885066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260ed068d0>]}
[0m18:25:43.125901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:43.133770 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:25:43.134698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:25:43.135326 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:25:43.147193 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:25:43.148299 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:25:43.160015 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                coalesce(`order_id`, ''),
                coalesce(`product_id`, ''),
                coalesce(`device_id`, '')
            )
        ) as event_id,
        cast(e1.order_id as string) as order_id,
        cast(e1.product_id as string) as product_id,
        cast(e1.device_id as string) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as string) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(cp.amount * cp.price AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:25:43.160840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:43.988299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:be45d585-d107-4f70-80a8-f0a1145b3534&page=queryresults
[0m18:25:43.989247 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:be45d585-d107-4f70-80a8-f0a1145b3534&page=queryresults
[0m18:25:43.997075 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [38:5]
[0m18:25:43.998264 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:25:43.999188 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [38:5].
[0m18:25:44.000952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:44.001881 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:25:44.003010 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Syntax error: Expected ")" but got keyword UNNEST at [38:5]
[0m18:25:44.003945 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:25:44.005285 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.35455, "process_in_blocks": "0", "process_kernel_time": 0.804752, "process_mem_max_rss": "403560", "process_out_blocks": "3672", "process_user_time": 6.75901}
[0m18:25:44.005944 [debug] [MainThread]: Command `dbt show` failed at 18:25:44.005780 after 6.36 seconds
[0m18:25:44.006506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ed47510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ed44410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260eefa250>]}
[0m18:25:44.007065 [debug] [MainThread]: Flushing usage events
[0m18:25:44.231083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:40.977790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb21ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb0edd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb122a90>]}


============================== 18:27:40.982052 | 440b389b-eaf1-499f-8bcd-53a6823d3cc7 ==============================
[0m18:27:40.982052 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:27:40.982886 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None'}
[0m18:27:44.402150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ab7c9210>]}
[0m18:27:44.489661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cdc59a50>]}
[0m18:27:44.505123 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:27:44.757736 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:27:44.944415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:44.945569 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:27:45.431106 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:27:45.431992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60aad14390>]}
[0m18:27:45.598342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:27:45.618990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60aadaf790>]}
[0m18:27:45.755716 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:27:45.758750 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:27:45.764975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ab3c6d10>]}
[0m18:27:45.765814 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:27:45.766448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cddf4b50>]}
[0m18:27:45.769354 [info ] [MainThread]: 
[0m18:27:45.769947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:45.770420 [info ] [MainThread]: 
[0m18:27:45.771228 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:45.777576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:27:45.778428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:46.253273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '440b389b-eaf1-499f-8bcd-53a6823d3cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60aade5850>]}
[0m18:27:46.254068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:46.261659 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:27:46.262521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:27:46.263134 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:27:46.274717 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:27:46.275794 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:27:46.287474 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                coalesce(`order_id`, ''),
                coalesce(`product_id`, ''),
                coalesce(`device_id`, '')
            )
        ) as event_id,
        cast(e1.order_id as string) as order_id,
        cast(e1.product_id as string) as product_id,
        cast(e1.device_id as string) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as string) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:27:46.288311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:47.123959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:18e6480d-9faf-4a29-8921-19a9cb199c67&page=queryresults
[0m18:27:47.124902 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:18e6480d-9faf-4a29-8921-19a9cb199c67&page=queryresults
[0m18:27:47.131899 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [24:9]
[0m18:27:47.133171 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:27:47.134089 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [24:9].
[0m18:27:47.135827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:47.136617 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:27:47.137530 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Syntax error: Expected ")" but got keyword CAST at [24:9]
[0m18:27:47.138465 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:27:47.139823 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.235239, "process_in_blocks": "0", "process_kernel_time": 0.75213, "process_mem_max_rss": "403332", "process_out_blocks": "3680", "process_user_time": 6.694004}
[0m18:27:47.140479 [debug] [MainThread]: Command `dbt show` failed at 18:27:47.140317 after 6.24 seconds
[0m18:27:47.140996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb153110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb151990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60aad27bd0>]}
[0m18:27:47.141545 [debug] [MainThread]: Flushing usage events
[0m18:27:47.321649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:04.095326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9db8dbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9db9353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9db937490>]}


============================== 18:29:04.099670 | 9fd68892-a015-4791-ab6b-dfd255110986 ==============================
[0m18:29:04.099670 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:29:04.100640 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True'}
[0m18:29:07.593252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dbe87b10>]}
[0m18:29:07.679710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9de4552d0>]}
[0m18:29:07.695956 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:29:07.938232 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:29:08.126167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:08.127586 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:29:08.619070 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:29:08.619869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9bb6f43d0>]}
[0m18:29:08.776921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:29:08.796810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9bb553a10>]}
[0m18:29:08.933764 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:29:08.936667 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:29:08.942544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9bb8db090>]}
[0m18:29:08.943354 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:29:08.943991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df2bb8d0>]}
[0m18:29:08.946622 [info ] [MainThread]: 
[0m18:29:08.947207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:29:08.947717 [info ] [MainThread]: 
[0m18:29:08.948497 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:29:08.954829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:29:08.955550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:09.430839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd68892-a015-4791-ab6b-dfd255110986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9bb8d9b50>]}
[0m18:29:09.431671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:09.438470 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:29:09.439307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:29:09.439915 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:29:09.451871 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:29:09.452827 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:29:09.465050 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                coalesce(`order_id`, ''),
                coalesce(`product_id`, ''),
                coalesce(`device_id`, '')
            )
        ) as event_id,
        cast(e1.order_id as string) as order_id,
        cast(e1.product_id as string) as product_id,
        cast(e1.device_id as string) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as string) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:29:09.465832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:10.577700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:657c0093-2e1d-47f6-ab22-66fdc1c287d3&page=queryresults
[0m18:29:10.578705 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:657c0093-2e1d-47f6-ab22-66fdc1c287d3&page=queryresults
[0m18:29:10.585553 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [9:26]
[0m18:29:10.586810 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:29:10.587792 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [9:26].
[0m18:29:10.589539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:10.590389 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:29:10.591664 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Column name product_id is ambiguous at [9:26]
[0m18:29:10.592638 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:29:10.594043 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.5698366, "process_in_blocks": "0", "process_kernel_time": 0.801739, "process_mem_max_rss": "403504", "process_out_blocks": "3672", "process_user_time": 6.720574}
[0m18:29:10.594884 [debug] [MainThread]: Command `dbt show` failed at 18:29:10.594696 after 6.57 seconds
[0m18:29:10.595686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dba02e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9bb5db650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfaa7390>]}
[0m18:29:10.596457 [debug] [MainThread]: Flushing usage events
[0m18:29:10.806655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:04.927831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b6b2d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b6b56890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b6b2e490>]}


============================== 18:41:04.932287 | f31af600-d780-4ec9-a310-120bc8b3aed6 ==============================
[0m18:41:04.932287 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:41:04.933177 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs'}
[0m18:41:08.264005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b6b2c790>]}
[0m18:41:08.349439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b96d1690>]}
[0m18:41:08.365115 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:41:08.666906 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:41:08.859963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:08.861155 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:41:09.380511 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:41:09.381360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f999688b590>]}
[0m18:41:09.544373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:41:09.563731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99969c7a10>]}
[0m18:41:09.703522 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:41:09.706450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:41:09.712557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996d9c2d0>]}
[0m18:41:09.713320 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:41:09.713843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b9ce6290>]}
[0m18:41:09.716444 [info ] [MainThread]: 
[0m18:41:09.717051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:09.717573 [info ] [MainThread]: 
[0m18:41:09.718478 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:09.724983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:41:09.725703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:10.204186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31af600-d780-4ec9-a310-120bc8b3aed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99969dadd0>]}
[0m18:41:10.204958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:10.212537 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:41:10.213382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:41:10.213982 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:41:10.225804 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:41:10.226860 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:41:10.238431 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                coalesce(`order_id`, ''),
                coalesce(`product_id`, ''),
                coalesce(`device_id`, '')
            )
        ) as event_id,
        cast(e1.order_id as int64) as order_id,
        cast(cp.product_id as int64) as product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:41:10.239173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:11.364632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:780fd0ac-38a8-4c40-a411-feb08c48a86b&page=queryresults
[0m18:41:11.365649 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:780fd0ac-38a8-4c40-a411-feb08c48a86b&page=queryresults
[0m18:41:11.372804 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [9:26]
[0m18:41:11.374194 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:41:11.375209 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [9:26].
[0m18:41:11.376849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:11.377546 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:41:11.378514 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Column name product_id is ambiguous at [9:26]
[0m18:41:11.379463 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:41:11.380805 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.5253096, "process_in_blocks": "0", "process_kernel_time": 0.828445, "process_mem_max_rss": "403220", "process_out_blocks": "3672", "process_user_time": 6.740119}
[0m18:41:11.381504 [debug] [MainThread]: Command `dbt show` failed at 18:41:11.381345 after 6.53 seconds
[0m18:41:11.382077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b69663d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bacbb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bacbb390>]}
[0m18:41:11.382626 [debug] [MainThread]: Flushing usage events
[0m18:41:11.632758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:19.175528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a1cae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a1cbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a1cafd0>]}


============================== 18:44:19.180000 | b70dc026-ee50-4a8e-b79d-80e5f9c59a82 ==============================
[0m18:44:19.180000 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:44:19.180859 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'profiles_dir': '/home/quakinh943/.dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m18:44:22.562551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3a768bd0>]}
[0m18:44:22.649847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5cd61d10>]}
[0m18:44:22.666562 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:44:22.934193 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:44:23.122331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:23.123569 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:44:23.596553 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:44:23.597372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a210c90>]}
[0m18:44:23.771284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:44:23.791057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5b2ea390>]}
[0m18:44:23.928023 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:44:23.931065 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:44:23.937058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3a1274d0>]}
[0m18:44:23.937907 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:44:23.938562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f4b981690>]}
[0m18:44:23.941200 [info ] [MainThread]: 
[0m18:44:23.941780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:23.942261 [info ] [MainThread]: 
[0m18:44:23.943035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:23.951700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:44:23.952512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:24.428332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70dc026-ee50-4a8e-b79d-80e5f9c59a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3a8cca10>]}
[0m18:44:24.429097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:24.435579 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:44:24.436377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:44:24.436937 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:44:24.447963 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:44:24.449025 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:44:24.461378 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            concat(
                cast(e1.order_id as int64) as order_id,
                cast(cp.product_id as int64) as product_id,
                cast(e1.device_id as int64) as raw_device_id
            )
        ) as event_id,
        cast(e1.order_id as int64) as order_id,
        cast(cp.product_id as int64) as product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:44:24.462224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:25.589057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0e2be43e-83f5-4880-a7da-0bdfa14aacc3&page=queryresults
[0m18:44:25.590075 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0e2be43e-83f5-4880-a7da-0bdfa14aacc3&page=queryresults
[0m18:44:25.597399 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unexpected function call argument alias found at concat at [8:44]
[0m18:44:25.598625 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:44:25.599635 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unexpected function call argument alias found at concat at [8:44].
[0m18:44:25.601261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:25.602012 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:44:25.602744 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Unexpected function call argument alias found at concat at [8:44]
[0m18:44:25.603625 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:44:25.604931 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.5021677, "process_in_blocks": "8", "process_kernel_time": 0.805903, "process_mem_max_rss": "403576", "process_out_blocks": "3672", "process_user_time": 6.627329}
[0m18:44:25.605606 [debug] [MainThread]: Command `dbt show` failed at 18:44:25.605450 after 6.50 seconds
[0m18:44:25.606147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a3724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5a2f2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5e35f390>]}
[0m18:44:25.606694 [debug] [MainThread]: Flushing usage events
[0m18:44:25.816506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:09.623876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3670ec7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3671069a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3670ec6ed0>]}


============================== 18:45:09.628344 | d310e73b-4f43-4684-9ec8-41d763f12b68 ==============================
[0m18:45:09.628344 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:45:09.629323 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:45:12.969460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3671494950>]}
[0m18:45:13.055978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3673a59b10>]}
[0m18:45:13.071478 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:45:13.362577 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:45:13.561083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:13.562308 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:45:14.159402 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:45:14.161023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3650ec0090>]}
[0m18:45:14.397158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:45:14.417232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3651136c10>]}
[0m18:45:14.556310 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:45:14.559428 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:45:14.565503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3650e65d90>]}
[0m18:45:14.566360 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:45:14.567032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36515a10d0>]}
[0m18:45:14.569767 [info ] [MainThread]: 
[0m18:45:14.570415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:14.570987 [info ] [MainThread]: 
[0m18:45:14.571884 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:14.579015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:45:14.579995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:15.052294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd310e73b-4f43-4684-9ec8-41d763f12b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3651137a50>]}
[0m18:45:15.053046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:15.060880 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:45:15.061792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:45:15.062343 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:45:15.073349 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:45:15.074454 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:45:15.086035 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        cast(cp.product_id as int64) as product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:45:15.086863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:16.209047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dda4585c-1e60-4271-b310-9f164065be5a&page=queryresults
[0m18:45:16.210016 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dda4585c-1e60-4271-b310-9f164065be5a&page=queryresults
[0m18:45:16.217954 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:45:16.219151 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:45:16.220134 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m18:45:16.221751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:16.222509 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:45:16.223420 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:45:16.224583 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:45:16.226085 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.676276, "process_in_blocks": "0", "process_kernel_time": 0.726735, "process_mem_max_rss": "403708", "process_out_blocks": "3672", "process_user_time": 6.855707}
[0m18:45:16.226803 [debug] [MainThread]: Command `dbt show` failed at 18:45:16.226645 after 6.68 seconds
[0m18:45:16.227527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3670f21950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3670f21990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3671683550>]}
[0m18:45:16.228150 [debug] [MainThread]: Flushing usage events
[0m18:45:16.392575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:38.282607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442aa0fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442a86f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442a86e490>]}


============================== 18:46:38.287011 | 3fc2a8bb-7a36-4be8-87b1-3179ac5847e3 ==============================
[0m18:46:38.287011 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:46:38.287960 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80'}
[0m18:46:41.693006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442aa41e10>]}
[0m18:46:41.777636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442d5fded0>]}
[0m18:46:41.793138 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:46:42.035279 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:46:42.222736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:46:42.223983 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:46:42.698079 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:46:42.698956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4409f1ce50>]}
[0m18:46:42.873287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:46:42.894234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440a976510>]}
[0m18:46:43.037133 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:46:43.040393 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:46:43.046775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440adc4090>]}
[0m18:46:43.047977 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:46:43.048749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4409efef90>]}
[0m18:46:43.051412 [info ] [MainThread]: 
[0m18:46:43.052022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:43.052544 [info ] [MainThread]: 
[0m18:46:43.053345 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:43.059824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:46:43.060688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:43.523574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc2a8bb-7a36-4be8-87b1-3179ac5847e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ac0c810>]}
[0m18:46:43.524434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:43.532336 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:46:43.533208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:46:43.533911 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:46:43.545305 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:46:43.546438 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:46:43.558896 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:46:43.559774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:44.398571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e5f3779c-50de-4129-9107-ad8a6a48952f&page=queryresults
[0m18:46:44.399650 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e5f3779c-50de-4129-9107-ad8a6a48952f&page=queryresults
[0m18:46:44.406557 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [15:9]
[0m18:46:44.407804 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:46:44.408695 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got keyword CAST at [15:9].
[0m18:46:44.410225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:44.411245 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:46:44.412017 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Syntax error: Expected ")" but got keyword CAST at [15:9]
[0m18:46:44.412892 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:46:44.414219 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.2064867, "process_in_blocks": "0", "process_kernel_time": 0.930946, "process_mem_max_rss": "403684", "process_out_blocks": "3680", "process_user_time": 6.533401}
[0m18:46:44.414837 [debug] [MainThread]: Command `dbt show` failed at 18:46:44.414697 after 6.21 seconds
[0m18:46:44.415356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442a878150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440aae95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442ebf32d0>]}
[0m18:46:44.416071 [debug] [MainThread]: Flushing usage events
[0m18:46:44.622905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:46.295165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769db2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769e0f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769db3390>]}


============================== 18:47:46.299704 | 1f8e3014-3555-4592-a004-87ed510fe663 ==============================
[0m18:47:46.299704 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:47:46.300586 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:47:49.675631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376a380a50>]}
[0m18:47:49.764053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376c9d2010>]}
[0m18:47:49.781005 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:47:50.031592 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:47:50.218296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:50.219550 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:47:50.693980 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:47:50.694730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374a0ff7d0>]}
[0m18:47:50.866454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:47:50.886067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374a2971d0>]}
[0m18:47:51.022430 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:47:51.025426 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:47:51.031615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3749fa0290>]}
[0m18:47:51.032470 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:47:51.033092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374a24dfd0>]}
[0m18:47:51.035823 [info ] [MainThread]: 
[0m18:47:51.036412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:51.036926 [info ] [MainThread]: 
[0m18:47:51.037736 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:47:51.044899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:47:51.045706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:51.510515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8e3014-3555-4592-a004-87ed510fe663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376baff210>]}
[0m18:47:51.511342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:51.518592 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:47:51.519549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:47:51.520197 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:47:51.532039 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:47:51.533102 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:47:51.545080 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:47:51.545950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:52.482045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e632ef92-332f-4d5d-885d-83dd6fef5b0f&page=queryresults
[0m18:47:52.483001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e632ef92-332f-4d5d-885d-83dd6fef5b0f&page=queryresults
[0m18:47:52.489763 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:47:52.490904 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:47:52.491956 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m18:47:52.493484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:52.494155 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:47:52.494915 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:47:52.496047 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:47:52.497631 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.2773967, "process_in_blocks": "0", "process_kernel_time": 0.688036, "process_mem_max_rss": "403360", "process_out_blocks": "3672", "process_user_time": 6.858148}
[0m18:47:52.498375 [debug] [MainThread]: Command `dbt show` failed at 18:47:52.498208 after 6.28 seconds
[0m18:47:52.498978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376dfab350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376dfab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769db2e90>]}
[0m18:47:52.499588 [debug] [MainThread]: Flushing usage events
[0m18:47:52.705616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:33.789308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0872dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08748dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff087402a90>]}


============================== 18:48:33.793560 | fde2c92b-6627-46ab-a298-5b2839782b51 ==============================
[0m18:48:33.793560 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:48:33.794412 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'debug': 'False'}
[0m18:48:37.198735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff087311cd0>]}
[0m18:48:37.285307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff089f54c10>]}
[0m18:48:37.301253 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:48:37.544249 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:48:37.734387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:37.735792 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:48:38.210790 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:48:38.211685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff066b7ca90>]}
[0m18:48:38.385560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:48:38.404971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff066aa1350>]}
[0m18:48:38.543101 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:48:38.545996 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:48:38.552178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff067428450>]}
[0m18:48:38.552964 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:48:38.553535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff066a11d50>]}
[0m18:48:38.556129 [info ] [MainThread]: 
[0m18:48:38.556695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:48:38.557157 [info ] [MainThread]: 
[0m18:48:38.558098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:48:38.565213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:48:38.565991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:39.032567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde2c92b-6627-46ab-a298-5b2839782b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a010790>]}
[0m18:48:39.033354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:39.040633 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:48:39.041515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:48:39.042146 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:48:39.053388 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:48:39.054413 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:48:39.066236 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(cp.product_id, 0) AS product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:48:39.067044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:40.190250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:360ceaf5-3324-447f-83b3-f9228f481bc4&page=queryresults
[0m18:48:40.191360 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:360ceaf5-3324-447f-83b3-f9228f481bc4&page=queryresults
[0m18:48:40.198476 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [14:9]
[0m18:48:40.199739 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:48:40.200723 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [14:9].
[0m18:48:40.202363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:40.203302 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:48:40.204109 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [14:9]
[0m18:48:40.204997 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:48:40.206346 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.48946, "process_in_blocks": "0", "process_kernel_time": 0.778876, "process_mem_max_rss": "405748", "process_out_blocks": "3672", "process_user_time": 6.669227}
[0m18:48:40.207090 [debug] [MainThread]: Command `dbt show` failed at 18:48:40.206933 after 6.49 seconds
[0m18:48:40.207718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0873489d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff087348950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff067517b10>]}
[0m18:48:40.208305 [debug] [MainThread]: Flushing usage events
[0m18:48:40.372116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:55.743631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfde00f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfde00fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfde00f350>]}


============================== 18:48:55.747858 | 2130444d-357f-4951-ac3f-f008980ad04d ==============================
[0m18:48:55.747858 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:48:55.748805 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m18:48:59.059389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfde13d0d0>]}
[0m18:48:59.144997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0c05950>]}
[0m18:48:59.160479 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:48:59.401502 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:48:59.585747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:59.586963 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:49:00.237194 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:49:00.238048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbd7877d0>]}
[0m18:49:00.415284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:49:00.436407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbde0e710>]}
[0m18:49:00.572582 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:49:00.575525 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:49:00.582041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbe02f550>]}
[0m18:49:00.582955 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:49:00.583621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbe6c82d0>]}
[0m18:49:00.586274 [info ] [MainThread]: 
[0m18:49:00.587000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:00.587531 [info ] [MainThread]: 
[0m18:49:00.588374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:49:00.595052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:49:00.596103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:01.057189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2130444d-357f-4951-ac3f-f008980ad04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbe100790>]}
[0m18:49:01.057974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:01.064490 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:49:01.065247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:49:01.065787 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:49:01.076687 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:49:01.077763 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:49:01.089786 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        cast(e1.store_id as int64) as store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:49:01.090597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:02.010800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f69b5408-216a-491c-801a-1fae9c8157ab&page=queryresults
[0m18:49:02.012043 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f69b5408-216a-491c-801a-1fae9c8157ab&page=queryresults
[0m18:49:02.019242 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:49:02.020588 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:49:02.021612 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m18:49:02.023295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:02.024070 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:49:02.025022 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:49:02.025932 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:49:02.027251 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.356326, "process_in_blocks": "0", "process_kernel_time": 0.770968, "process_mem_max_rss": "405556", "process_out_blocks": "3672", "process_user_time": 6.844689}
[0m18:49:02.027961 [debug] [MainThread]: Command `dbt show` failed at 18:49:02.027807 after 6.36 seconds
[0m18:49:02.028532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfde048810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfbe045550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe21ef210>]}
[0m18:49:02.029087 [debug] [MainThread]: Flushing usage events
[0m18:49:02.230262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:59.731901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3af1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3aea5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3ae9dd0>]}


============================== 18:49:59.736535 | 02740828-f7af-4f3a-92bd-05762fa2af23 ==============================
[0m18:49:59.736535 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:49:59.737878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m18:50:03.193198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a41524d0>]}
[0m18:50:03.278798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c6714250>]}
[0m18:50:03.294685 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:50:03.541470 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:50:03.728202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:03.729422 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:50:04.197939 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:50:04.198731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a3201b10>]}
[0m18:50:04.375306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:50:04.395529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a3ba3350>]}
[0m18:50:04.535585 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:50:04.538670 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:50:04.544749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a3b163d0>]}
[0m18:50:04.545649 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:50:04.546285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c5f52110>]}
[0m18:50:04.549073 [info ] [MainThread]: 
[0m18:50:04.549651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:04.550133 [info ] [MainThread]: 
[0m18:50:04.550921 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:04.557213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:50:04.558008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:05.028589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02740828-f7af-4f3a-92bd-05762fa2af23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c67ccc50>]}
[0m18:50:05.029455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:05.036309 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:50:05.037236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:50:05.037906 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:50:05.049186 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:50:05.050303 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:50:05.062825 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:50:05.063757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:06.029085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:32f2cb2a-2718-4dfb-b5fb-98f133858698&page=queryresults
[0m18:50:06.030175 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:32f2cb2a-2718-4dfb-b5fb-98f133858698&page=queryresults
[0m18:50:06.037209 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:50:06.038471 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:50:06.039453 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m18:50:06.041290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:06.042090 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:50:06.043149 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m18:50:06.044037 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:50:06.045338 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.3883343, "process_in_blocks": "0", "process_kernel_time": 0.795424, "process_mem_max_rss": "405728", "process_out_blocks": "3688", "process_user_time": 6.766453}
[0m18:50:06.045997 [debug] [MainThread]: Command `dbt show` failed at 18:50:06.045827 after 6.39 seconds
[0m18:50:06.046545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3b25c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a326f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c7e70790>]}
[0m18:50:06.047111 [debug] [MainThread]: Flushing usage events
[0m18:50:06.250171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:30.548513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdffcdc66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdffcf722d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdffcf71bd0>]}


============================== 18:50:30.553061 | 95e28946-9bb0-421c-b72a-7de4ea3f831b ==============================
[0m18:50:30.553061 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:50:30.553962 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'indirect_selection': 'eager'}
[0m18:50:33.870736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdffcde71d0>]}
[0m18:50:33.956336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfff951750>]}
[0m18:50:33.972119 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:50:34.215434 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:50:34.395696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:34.396854 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:50:34.944354 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:50:34.945159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfdc21e550>]}
[0m18:50:35.123297 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:50:35.143031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfdc289150>]}
[0m18:50:35.279751 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:50:35.282639 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:50:35.288721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfdd0cc110>]}
[0m18:50:35.289556 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:50:35.290145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfff18e1d0>]}
[0m18:50:35.292781 [info ] [MainThread]: 
[0m18:50:35.293342 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:35.293781 [info ] [MainThread]: 
[0m18:50:35.294495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:35.301000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:50:35.301799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:35.803340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e28946-9bb0-421c-b72a-7de4ea3f831b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfffa18790>]}
[0m18:50:35.804177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:35.811159 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:50:35.812107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:50:35.812725 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:50:35.823979 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:50:35.824987 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:50:35.837177 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as int64) as raw_device_id
        -- cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        -- COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        -- farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:50:35.838041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:37.850272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:573122fc-ebfd-46a8-951c-c94becb0d2cd&page=queryresults
[0m18:50:38.129926 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:573122fc-ebfd-46a8-951c-c94becb0d2cd&page=queryresults
[0m18:50:38.136930 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Bad int64 value: 
[0m18:50:38.138233 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:50:38.139340 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Bad int64 value: .
[0m18:50:38.141173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:38.141905 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:50:38.142630 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Bad int64 value: 
[0m18:50:38.143537 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:50:38.144883 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 7.671328, "process_in_blocks": "0", "process_kernel_time": 0.84198, "process_mem_max_rss": "403816", "process_out_blocks": "3680", "process_user_time": 6.732148}
[0m18:50:38.145523 [debug] [MainThread]: Command `dbt show` failed at 18:50:38.145365 after 7.67 seconds
[0m18:50:38.146095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000f3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdffcdc5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe001081210>]}
[0m18:50:38.146630 [debug] [MainThread]: Flushing usage events
[0m18:50:38.313055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:51.837392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce039d6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce03b7e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce039ce8d0>]}


============================== 18:51:51.841971 | 44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5 ==============================
[0m18:51:51.841971 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:51:51.842864 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True'}
[0m18:51:55.223030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde3f5f610>]}
[0m18:51:55.309202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0498a410>]}
[0m18:51:55.324878 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:51:55.709578 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:51:55.962108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:55.963316 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:51:56.456249 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:51:56.457137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde3193a90>]}
[0m18:51:56.632320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:51:56.652283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde30e3250>]}
[0m18:51:56.789972 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:51:56.792952 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:51:56.798925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde3c474d0>]}
[0m18:51:56.799775 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:51:56.800394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce05a7e690>]}
[0m18:51:56.803091 [info ] [MainThread]: 
[0m18:51:56.803713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:51:56.804220 [info ] [MainThread]: 
[0m18:51:56.805036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:51:56.811760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:51:56.812537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:57.277990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44381cdf-47e5-44a0-8b6d-5ce3b4a0d8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde38684d0>]}
[0m18:51:57.278774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:57.286216 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:51:57.287126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:51:57.287725 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:51:57.298928 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:51:57.299909 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:51:57.312690 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id
        -- cast(e1.order_id as int64) as order_id,
        -- COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        -- cast(e1.device_id as int64) as raw_device_id
        -- cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        -- COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        -- farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:51:57.313499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:59.138211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:973040ba-910f-4679-b36b-3e96432b5ae4&page=queryresults
[0m18:52:00.961176 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:52:00.964837 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:52:00.966202 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a'
[0m18:52:00.967647 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:52:00.968444 [debug] [Thread-4 (]: Began running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:52:00.984370 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a'
[0m18:52:00.985308 [debug] [Thread-4 (]: Began compiling node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:52:00.969174 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:52:00.992403 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec'
[0m18:52:00.993295 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:52:00.977019 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:52:01.027844 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:52:01.029284 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:52:01.034662 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:52:01.035612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_fact_orders, now test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867)
[0m18:52:01.037459 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:52:01.038335 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:52:01.047645 [debug] [Thread-4 (]: Began executing node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:52:01.046570 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and total_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 20

[0m18:52:01.048586 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:52:01.068676 [debug] [Thread-4 (]: On test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"} */

  
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
where event_id is null



  
  limit 20

[0m18:52:01.070125 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:52:01.070811 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:52:01.080866 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"} */

  
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:01.082081 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:52:01.131751 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:52:01.134386 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:52:01.203172 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"} */

  
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:01.260978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:02.689084 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0f410db2-73a6-496d-b29b-e232138f0440&page=queryresults
[0m18:52:02.690088 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0f410db2-73a6-496d-b29b-e232138f0440&page=queryresults
[0m18:52:02.697387 [debug] [Thread-3 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11]
[0m18:52:02.699034 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:52:02.699919 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:52:02.700798 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11].
[0m18:52:02.701573 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a, now test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f)
[0m18:52:02.703834 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:52:02.711672 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:52:02.712602 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:52:02.720775 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"} */

  
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:02.721559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:02.760984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:56ca6581-31be-4c03-8975-5cef5b92951d&page=queryresults
[0m18:52:02.762067 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:56ca6581-31be-4c03-8975-5cef5b92951d&page=queryresults
[0m18:52:02.768316 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11]
[0m18:52:02.769526 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:52:02.770425 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:52:02.771177 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11].
[0m18:52:02.771932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867, now test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121)
[0m18:52:02.772777 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:52:02.781313 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:52:02.782267 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:52:02.788799 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"} */

  
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:02.789578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:02.830017 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:ed458566-c402-40d1-926b-4823475e1497&page=queryresults
[0m18:52:02.918297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:594e238f-c3f8-4373-b2e6-fadc11397bcf&page=queryresults
[0m18:52:02.919577 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:594e238f-c3f8-4373-b2e6-fadc11397bcf&page=queryresults
[0m18:52:02.928311 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11]
[0m18:52:02.929870 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:52:02.930909 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:52:02.931813 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11].
[0m18:52:02.932705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec, now test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731)
[0m18:52:02.933828 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:52:02.947053 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:52:02.948528 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:52:02.958935 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"} */

  
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:02.960040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:03.887408 [debug] [Thread-4 (]: Finished running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:52:03.888227 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:52:03.889091 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a, now test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80)
[0m18:52:03.889668 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:52:03.897740 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:52:03.898694 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:52:03.906637 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"} */

  
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:52:03.907550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:04.140158 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:27d12463-7598-49d4-a67d-d9571129358a&page=queryresults
[0m18:52:04.141200 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:27d12463-7598-49d4-a67d-d9571129358a&page=queryresults
[0m18:52:04.146953 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11]
[0m18:52:04.148511 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:52:04.149309 [debug] [Thread-3 (]: Began running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:52:04.150123 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11].
[0m18:52:04.150824 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f, now test.glramira.unique_stg_fact_orders_event_id.a749b832a4)
[0m18:52:04.152004 [debug] [Thread-3 (]: Began compiling node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:52:04.161830 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:52:04.162843 [debug] [Thread-3 (]: Began executing node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:52:04.169186 [debug] [Thread-3 (]: On test.glramira.unique_stg_fact_orders_event_id.a749b832a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"} */

  
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 20

[0m18:52:04.169917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:04.247083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:415fbccf-bb3b-452c-8df5-ae5f76dd2a8e&page=queryresults
[0m18:52:04.248369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:415fbccf-bb3b-452c-8df5-ae5f76dd2a8e&page=queryresults
[0m18:52:04.255223 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11]
[0m18:52:04.256527 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:52:04.257673 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11].
[0m18:52:04.369336 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6fc6d43e-fc97-4b39-b1c6-f22df07535a5&page=queryresults
[0m18:52:04.370286 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6fc6d43e-fc97-4b39-b1c6-f22df07535a5&page=queryresults
[0m18:52:04.376076 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11]
[0m18:52:04.377259 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:52:04.378404 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11].
[0m18:52:05.246966 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2a55df40-3ba8-4b37-a415-336e452950bf&page=queryresults
[0m18:52:05.247989 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2a55df40-3ba8-4b37-a415-336e452950bf&page=queryresults
[0m18:52:05.253527 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:52:05.254563 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:52:05.255622 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11].
[0m18:52:05.820232 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e2fb3d57-d370-4d96-9cd4-1227a7859246&page=queryresults
[0m18:52:06.693307 [debug] [Thread-3 (]: Finished running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:52:06.694163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:06.694989 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' was properly closed.
[0m18:52:06.695565 [debug] [MainThread]: Connection 'test.glramira.unique_stg_fact_orders_event_id.a749b832a4' was properly closed.
[0m18:52:06.696051 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' was properly closed.
[0m18:52:06.696538 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' was properly closed.
[0m18:52:06.697359 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
    Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:52:06.698356 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:52:06.699862 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 14.936256, "process_in_blocks": "0", "process_kernel_time": 0.87973, "process_mem_max_rss": "416876", "process_out_blocks": "3800", "process_user_time": 8.840716}
[0m18:52:06.700625 [debug] [MainThread]: Command `dbt show` failed at 18:52:06.700466 after 14.94 seconds
[0m18:52:06.701244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce07b7f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce07b7f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddb7b6f90>]}
[0m18:52:06.701904 [debug] [MainThread]: Flushing usage events
[0m18:52:06.895131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:30.744502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bef3e31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf02643d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bef3e2ad0>]}


============================== 18:55:30.749093 | 773e2e3e-cba2-4a39-9936-46f57e13d2f9 ==============================
[0m18:55:30.749093 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:55:30.750162 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m18:55:34.175848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcfb90650>]}
[0m18:55:34.261119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf2048bd0>]}
[0m18:55:34.276571 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:55:34.517096 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:55:34.704919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:34.706065 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:55:35.176563 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:55:35.177403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcecfbf10>]}
[0m18:55:35.349766 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:55:35.370378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcf3a6690>]}
[0m18:55:35.510980 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:55:35.513868 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:55:35.519803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcf7b13d0>]}
[0m18:55:35.520671 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:55:35.521323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcfb84a50>]}
[0m18:55:35.523935 [info ] [MainThread]: 
[0m18:55:35.524683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:35.525251 [info ] [MainThread]: 
[0m18:55:35.526091 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:35.533439 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:55:35.534305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:35.988360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773e2e3e-cba2-4a39-9936-46f57e13d2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcfc94a10>]}
[0m18:55:35.989189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:35.995619 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:55:35.996382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:55:35.996999 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:55:36.008297 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:55:36.009434 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:55:36.021632 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id
        -- cast(e1.device_id as int64) as raw_device_id
        -- cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        -- COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        -- farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:55:36.022497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:37.848913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6328f5de-e245-47e1-9fb8-8ec428548cd2&page=queryresults
[0m18:55:39.471730 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:55:39.473568 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:55:39.474296 [debug] [Thread-4 (]: Began running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:55:39.475031 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:55:39.475922 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a'
[0m18:55:39.476486 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:55:39.477371 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a'
[0m18:55:39.478140 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec'
[0m18:55:39.478785 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:55:39.479548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_fact_orders, now test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867)
[0m18:55:39.480156 [debug] [Thread-4 (]: Began compiling node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:55:39.480780 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:55:39.488581 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:55:39.489317 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:55:39.502229 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:55:39.510327 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:55:39.518839 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:55:39.519973 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:55:39.521300 [debug] [Thread-4 (]: Began executing node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:55:39.522498 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:55:39.530704 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and total_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 20

[0m18:55:39.531524 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:55:39.537941 [debug] [Thread-4 (]: On test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"} */

  
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
where event_id is null



  
  limit 20

[0m18:55:39.544129 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"} */

  
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:39.544974 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:39.551028 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"} */

  
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:39.551845 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:39.552560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.555553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:41.001138 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5fcf9d84-e10b-49cc-a17f-a888ff020c5d&page=queryresults
[0m18:55:41.158427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a33684c4-04cb-4599-a654-f73662c86350&page=queryresults
[0m18:55:41.159408 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a33684c4-04cb-4599-a654-f73662c86350&page=queryresults
[0m18:55:41.166558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0d0ac2e8-392b-4250-bcc2-48c72067b33a&page=queryresults
[0m18:55:41.168835 [debug] [Thread-3 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11]
[0m18:55:41.169651 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0d0ac2e8-392b-4250-bcc2-48c72067b33a&page=queryresults
[0m18:55:41.170930 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:55:41.173271 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:55:41.174130 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11].
[0m18:55:41.176432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a, now test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f)
[0m18:55:41.180672 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11]
[0m18:55:41.181378 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:55:41.182438 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:55:41.190902 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:55:41.191839 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:55:41.192708 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11].
[0m18:55:41.193780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec, now test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121)
[0m18:55:41.194867 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:55:41.195487 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:55:41.203115 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:55:41.211823 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"} */

  
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:41.212838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:41.249608 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:55:41.257833 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"} */

  
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:41.258755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:41.348610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:25730834-a182-47fd-a3a1-deaf29c5bda7&page=queryresults
[0m18:55:41.349880 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:25730834-a182-47fd-a3a1-deaf29c5bda7&page=queryresults
[0m18:55:41.359147 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11]
[0m18:55:41.360632 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:55:41.361596 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:55:41.362471 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11].
[0m18:55:41.363396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867, now test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731)
[0m18:55:41.364367 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:55:41.376894 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:55:41.378293 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:55:41.388487 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"} */

  
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:41.389714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:41.896514 [debug] [Thread-4 (]: Finished running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:55:41.897254 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:55:41.898054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a, now test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80)
[0m18:55:41.898642 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:55:41.906574 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:55:41.907559 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:55:41.913856 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"} */

  
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:55:41.914560 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:42.658488 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:672b2baa-028c-4c4c-a095-e472402fb372&page=queryresults
[0m18:55:42.659409 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:672b2baa-028c-4c4c-a095-e472402fb372&page=queryresults
[0m18:55:42.665699 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11]
[0m18:55:42.666888 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:55:42.667807 [debug] [Thread-3 (]: Began running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:55:42.668687 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11].
[0m18:55:42.669382 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f, now test.glramira.unique_stg_fact_orders_event_id.a749b832a4)
[0m18:55:42.670379 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:591469a7-17c5-4624-9343-efa969b49eaa&page=queryresults
[0m18:55:42.671567 [debug] [Thread-3 (]: Began compiling node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:55:42.672369 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:591469a7-17c5-4624-9343-efa969b49eaa&page=queryresults
[0m18:55:42.683503 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:55:42.689362 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11]
[0m18:55:42.690534 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:55:42.691464 [debug] [Thread-3 (]: Began executing node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:55:42.692351 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11].
[0m18:55:42.699035 [debug] [Thread-3 (]: On test.glramira.unique_stg_fact_orders_event_id.a749b832a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"} */

  
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 20

[0m18:55:42.700083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:42.744072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d32317bd-3237-411d-bb00-cc1ce7407848&page=queryresults
[0m18:55:42.745260 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d32317bd-3237-411d-bb00-cc1ce7407848&page=queryresults
[0m18:55:42.754176 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11]
[0m18:55:42.755739 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:55:42.756935 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11].
[0m18:55:43.256032 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5362cd08-b353-4ac1-88be-87d6629a602f&page=queryresults
[0m18:55:43.256870 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5362cd08-b353-4ac1-88be-87d6629a602f&page=queryresults
[0m18:55:43.262485 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:55:43.263567 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:55:43.264621 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11].
[0m18:55:43.449480 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bbe3f908-2c90-49e2-a650-22a02ac19b38&page=queryresults
[0m18:55:44.310691 [debug] [Thread-3 (]: Finished running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:55:44.311715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:44.312516 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' was properly closed.
[0m18:55:44.313400 [debug] [MainThread]: Connection 'test.glramira.unique_stg_fact_orders_event_id.a749b832a4' was properly closed.
[0m18:55:44.313866 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' was properly closed.
[0m18:55:44.314290 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' was properly closed.
[0m18:55:44.315005 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
    Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:55:44.315985 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:55:44.317445 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 13.645749, "process_in_blocks": "0", "process_kernel_time": 0.852587, "process_mem_max_rss": "414700", "process_out_blocks": "3792", "process_user_time": 8.844856}
[0m18:55:44.318126 [debug] [MainThread]: Command `dbt show` failed at 18:55:44.317952 after 13.65 seconds
[0m18:55:44.318760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bef414850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcecd7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf3775150>]}
[0m18:55:44.319312 [debug] [MainThread]: Flushing usage events
[0m18:55:44.513139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:04.334629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a5a06750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a2e558d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a2f1ef10>]}


============================== 18:56:04.339284 | a6b0807e-636a-47ec-a49a-259fee9a7df0 ==============================
[0m18:56:04.339284 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:56:04.340249 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'empty': 'None', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m18:56:07.796291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33835384d0>]}
[0m18:56:07.882497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a5a25950>]}
[0m18:56:07.898210 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:56:08.142933 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:56:08.326768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:56:08.328025 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:56:08.798977 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:56:08.799894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3382ed6b90>]}
[0m18:56:08.976664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:56:08.996527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338258acd0>]}
[0m18:56:09.133156 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:56:09.136210 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:56:09.142190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33830fb210>]}
[0m18:56:09.142981 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:56:09.143560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3382d46c90>]}
[0m18:56:09.146146 [info ] [MainThread]: 
[0m18:56:09.146709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:56:09.147132 [info ] [MainThread]: 
[0m18:56:09.147917 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:56:09.154400 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:56:09.155328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:09.608090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6b0807e-636a-47ec-a49a-259fee9a7df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33825e4450>]}
[0m18:56:09.608926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:09.616119 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:56:09.617048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:56:09.617672 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:56:09.628995 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:56:09.630134 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:56:09.642448 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        -- cast(e1.device_id as int64) as raw_device_id
        -- cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        -- COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:56:09.643252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:11.442699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6c1065b4-cf20-47fd-b754-46c08fb34644&page=queryresults
[0m18:56:12.889236 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:56:12.891214 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:56:12.892050 [debug] [Thread-4 (]: Began running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:56:12.892919 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a'
[0m18:56:12.893523 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:56:12.894187 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:56:12.895005 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a'
[0m18:56:12.895801 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:56:12.896719 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec'
[0m18:56:12.897420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_fact_orders, now test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867)
[0m18:56:12.898035 [debug] [Thread-4 (]: Began compiling node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:56:12.905767 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:56:12.906556 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:56:12.907515 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:56:12.921182 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:56:12.929230 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:56:12.935507 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:56:12.938040 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:56:12.944573 [debug] [Thread-4 (]: Began executing node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:56:12.945446 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:56:12.948054 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and total_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 20

[0m18:56:12.959624 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"} */

  
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:12.960433 [debug] [Thread-4 (]: On test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"} */

  
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
where event_id is null



  
  limit 20

[0m18:56:12.961064 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:56:12.961781 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:56:12.962547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:56:12.963230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:56:12.969767 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"} */

  
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:13.047449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:14.359619 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2891a387-332a-4289-b471-dcaa11590e1f&page=queryresults
[0m18:56:14.432728 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:23e9b185-674d-4da2-897c-da1a7760147e&page=queryresults
[0m18:56:14.433773 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:23e9b185-674d-4da2-897c-da1a7760147e&page=queryresults
[0m18:56:14.440936 [debug] [Thread-3 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11]
[0m18:56:14.442207 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:56:14.442925 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:56:14.443757 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11].
[0m18:56:14.444618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a, now test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f)
[0m18:56:14.446291 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:56:14.454745 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:56:14.455965 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:56:14.462259 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"} */

  
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:14.463048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:56:14.545064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e882a514-d3a6-4d64-ab90-97a8f527595a&page=queryresults
[0m18:56:14.546002 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e882a514-d3a6-4d64-ab90-97a8f527595a&page=queryresults
[0m18:56:14.552434 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11]
[0m18:56:14.553574 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:56:14.554393 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:56:14.555106 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11].
[0m18:56:14.555796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867, now test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121)
[0m18:56:14.557351 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:56:14.570266 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:56:14.571701 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:56:14.572618 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:494ca6a7-a2ec-4e31-830b-82d30741f86f&page=queryresults
[0m18:56:14.579920 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"} */

  
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:14.581060 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:494ca6a7-a2ec-4e31-830b-82d30741f86f&page=queryresults
[0m18:56:14.582169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:14.590309 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11]
[0m18:56:14.592124 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:56:14.631109 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:56:14.633221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec, now test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731)
[0m18:56:14.634359 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11].
[0m18:56:14.634978 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:56:14.645657 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:56:14.649299 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:56:14.656416 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"} */

  
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:14.657473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:56:15.232333 [debug] [Thread-4 (]: Finished running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:56:15.233117 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:56:15.234024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a, now test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80)
[0m18:56:15.234634 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:56:15.243165 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:56:15.244242 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:56:15.250475 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"} */

  
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:56:15.251198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:56:15.882207 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a6e1b620-010d-4167-a0cb-0809b46b1b32&page=queryresults
[0m18:56:15.883135 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a6e1b620-010d-4167-a0cb-0809b46b1b32&page=queryresults
[0m18:56:15.888978 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11]
[0m18:56:15.890195 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:56:15.891023 [debug] [Thread-3 (]: Began running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:56:15.891821 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11].
[0m18:56:15.892524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f, now test.glramira.unique_stg_fact_orders_event_id.a749b832a4)
[0m18:56:15.893338 [debug] [Thread-3 (]: Began compiling node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:56:15.904382 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:56:15.905315 [debug] [Thread-3 (]: Began executing node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:56:15.911591 [debug] [Thread-3 (]: On test.glramira.unique_stg_fact_orders_event_id.a749b832a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"} */

  
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 20

[0m18:56:15.912263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:56:15.955599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a620ed69-8af5-4d02-a184-5fb95e37ca61&page=queryresults
[0m18:56:15.956536 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a620ed69-8af5-4d02-a184-5fb95e37ca61&page=queryresults
[0m18:56:15.962283 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11]
[0m18:56:15.963323 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:56:15.964219 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11].
[0m18:56:16.065410 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dc6c083c-1cfe-4182-8273-6324ce9954e1&page=queryresults
[0m18:56:16.066315 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dc6c083c-1cfe-4182-8273-6324ce9954e1&page=queryresults
[0m18:56:16.071700 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11]
[0m18:56:16.072793 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:56:16.073654 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11].
[0m18:56:16.548602 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:798c017f-4537-49f2-8346-23a77ece022f&page=queryresults
[0m18:56:16.549565 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:798c017f-4537-49f2-8346-23a77ece022f&page=queryresults
[0m18:56:16.555327 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:56:16.556390 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:56:16.557253 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11].
[0m18:56:16.655723 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:64162591-1789-4123-8c8c-519c611ea71b&page=queryresults
[0m18:56:17.514159 [debug] [Thread-3 (]: Finished running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:56:17.515296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:17.515924 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' was properly closed.
[0m18:56:17.516358 [debug] [MainThread]: Connection 'test.glramira.unique_stg_fact_orders_event_id.a749b832a4' was properly closed.
[0m18:56:17.516777 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' was properly closed.
[0m18:56:17.517203 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' was properly closed.
[0m18:56:17.517960 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
    Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:56:17.518852 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:56:17.520279 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 13.261575, "process_in_blocks": "0", "process_kernel_time": 0.877519, "process_mem_max_rss": "414528", "process_out_blocks": "3792", "process_user_time": 8.662131}
[0m18:56:17.521034 [debug] [MainThread]: Command `dbt show` failed at 18:56:17.520876 after 13.26 seconds
[0m18:56:17.521612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a70134d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a5a068d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3382548bd0>]}
[0m18:56:17.522226 [debug] [MainThread]: Flushing usage events
[0m18:56:17.683582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:57.234820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af0ca110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af0cb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af0cb250>]}


============================== 18:56:57.239181 | dc5f3afe-9e16-4281-8460-af534553a6ed ==============================
[0m18:56:57.239181 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:56:57.240147 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m18:57:00.592045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af68a4d0>]}
[0m18:57:00.684426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b1c45910>]}
[0m18:57:00.700247 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:57:00.947901 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:57:01.132669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:01.133923 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:57:01.604490 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:57:01.605369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708e700510>]}
[0m18:57:01.781258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:57:01.801939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708f0f0a90>]}
[0m18:57:01.950094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:57:01.953186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:57:01.960041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708f1fd790>]}
[0m18:57:01.960937 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:57:01.961606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708f76f250>]}
[0m18:57:01.964310 [info ] [MainThread]: 
[0m18:57:01.964929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:01.965463 [info ] [MainThread]: 
[0m18:57:01.966329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:57:01.973560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:57:01.974390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:02.448015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc5f3afe-9e16-4281-8460-af534553a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708ef4ef10>]}
[0m18:57:02.448811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:02.455793 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:57:02.456780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:57:02.457371 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:57:02.468343 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:57:02.469367 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:57:02.481594 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as int64) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as int64) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:57:02.482483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:04.334538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:48289fa6-4828-4333-b7f7-872e6326258e&page=queryresults
[0m18:57:04.783141 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:48289fa6-4828-4333-b7f7-872e6326258e&page=queryresults
[0m18:57:04.790182 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Bad int64 value: 25a32cd7-1846-4027-8271-f4068d28...
[0m18:57:04.791541 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:57:04.792544 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Bad int64 value: 25a32cd7-1846-4027-8271-f4068d28....
[0m18:57:04.794258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:04.795267 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:57:04.796072 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Bad int64 value: 25a32cd7-1846-4027-8271-f4068d28...
[0m18:57:04.797068 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:57:04.798607 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 7.6354103, "process_in_blocks": "0", "process_kernel_time": 0.734366, "process_mem_max_rss": "403764", "process_out_blocks": "3672", "process_user_time": 6.735427}
[0m18:57:04.799340 [debug] [MainThread]: Command `dbt show` failed at 18:57:04.799162 after 7.64 seconds
[0m18:57:04.800001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af0c2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70af0c2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708e754fd0>]}
[0m18:57:04.800618 [debug] [MainThread]: Flushing usage events
[0m18:57:04.989663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:54.944012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44a8ff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44a8ff490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44a8ff590>]}


============================== 18:57:54.948588 | 0d33e8dc-5173-4478-8245-270568d3fc17 ==============================
[0m18:57:54.948588 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:57:54.949501 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None'}
[0m18:57:58.576668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42af11910>]}
[0m18:57:58.666530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d515610>]}
[0m18:57:58.683302 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:57:58.941788 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:57:59.130560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:59.131922 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m18:57:59.607814 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m18:57:59.608694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42a9c25d0>]}
[0m18:57:59.789417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:57:59.809337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42ac2f010>]}
[0m18:57:59.943850 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:57:59.946846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:57:59.952838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42a87e4d0>]}
[0m18:57:59.953695 [info ] [MainThread]: Found 10 models, 24 data tests, 3 sources, 762 macros
[0m18:57:59.954346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44cd51e50>]}
[0m18:57:59.957037 [info ] [MainThread]: 
[0m18:57:59.957667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:59.958268 [info ] [MainThread]: 
[0m18:57:59.959091 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:57:59.966051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:57:59.966854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:00.432482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d33e8dc-5173-4478-8245-270568d3fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42a9d2550>]}
[0m18:58:00.433297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:00.440517 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:58:00.441329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:58:00.441918 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:58:00.452862 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:58:00.453849 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:58:00.465795 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:58:00.466680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:02.269243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:cc284b2c-437e-4bfa-9436-b70991d5ab3a&page=queryresults
[0m18:58:03.901276 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:58:03.903001 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:58:03.904250 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a'
[0m18:58:03.905030 [debug] [Thread-4 (]: Began running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:58:03.905652 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:58:03.906230 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:58:03.906997 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:58:03.907886 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a'
[0m18:58:03.915865 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"
[0m18:58:03.916855 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec'
[0m18:58:03.917692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_fact_orders, now test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867)
[0m18:58:03.918473 [debug] [Thread-4 (]: Began compiling node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:58:03.919523 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:58:03.920297 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:58:03.920934 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:58:03.934021 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"
[0m18:58:03.941790 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"
[0m18:58:03.948347 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and total_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 20

[0m18:58:03.957566 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"
[0m18:58:03.959183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:03.959902 [debug] [Thread-4 (]: Began executing node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:58:03.960934 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:58:03.961815 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:58:03.968428 [debug] [Thread-4 (]: On test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a"} */

  
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
where event_id is null



  
  limit 20

[0m18:58:04.013092 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec"} */

  
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:04.022040 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867"} */

  
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:04.023146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:04.024109 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:58:04.024792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:05.380708 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:c1fafe25-abde-4470-a4cf-5b78f2707251&page=queryresults
[0m18:58:05.573406 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:eae69ed1-9c76-4652-b9fd-b7a06b24a07e&page=queryresults
[0m18:58:05.574401 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:eae69ed1-9c76-4652-b9fd-b7a06b24a07e&page=queryresults
[0m18:58:05.582129 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11]
[0m18:58:05.583431 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec
[0m18:58:05.584188 [debug] [Thread-2 (]: Began running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:58:05.585050 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_ (models/staging/source.yml)
  Unrecognized name: date_id at [11:11].
[0m18:58:05.585879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_date_id__date_id__ref_stg_dim_date_.99d25dd5ec, now test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f)
[0m18:58:05.587698 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:58:05.597473 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"
[0m18:58:05.598654 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:58:05.607243 [debug] [Thread-2 (]: On test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f"} */

  
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:05.608076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:05.646662 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e63fa291-dc4e-4160-960c-c4156b4abbd8&page=queryresults
[0m18:58:05.648730 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e63fa291-dc4e-4160-960c-c4156b4abbd8&page=queryresults
[0m18:58:05.650785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4b3612fe-d718-4e65-8fd5-e1681d5b656d&page=queryresults
[0m18:58:05.654934 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4b3612fe-d718-4e65-8fd5-e1681d5b656d&page=queryresults
[0m18:58:05.663552 [debug] [Thread-3 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11]
[0m18:58:05.664717 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a
[0m18:58:05.667456 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11]
[0m18:58:05.668436 [debug] [Thread-3 (]: Began running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:58:05.669758 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True (models/staging/source.yml)
  Unrecognized name: total_amount at [17:11].
[0m18:58:05.671229 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867
[0m18:58:05.672307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_stg_fact_orders_total_amount__0__True.97c79a584a, now test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121)
[0m18:58:05.673433 [debug] [Thread-1 (]: Began running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:58:05.674309 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_ (models/staging/source.yml)
  Unrecognized name: device_id at [11:11].
[0m18:58:05.674942 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:58:05.675972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_device_id__device_id__ref_stg_dim_device_.24e55fe867, now test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731)
[0m18:58:05.684691 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"
[0m18:58:05.685631 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:58:05.697297 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:58:05.699309 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"
[0m18:58:05.706434 [debug] [Thread-3 (]: On test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121"} */

  
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:05.708061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:05.708919 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:58:05.717288 [debug] [Thread-1 (]: On test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731"} */

  
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:05.718490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.414850 [debug] [Thread-4 (]: Finished running node test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a
[0m18:58:06.415757 [debug] [Thread-4 (]: Began running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:58:06.416727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_stg_fact_orders_event_id.cfff6ae30a, now test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80)
[0m18:58:06.417414 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:58:06.426032 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"
[0m18:58:06.427267 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:58:06.433746 [debug] [Thread-4 (]: On test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80"} */

  
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 20

[0m18:58:06.434610 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:07.029758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e5bd6e66-33ea-4466-95e3-bcdb503e3407&page=queryresults
[0m18:58:07.030776 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e5bd6e66-33ea-4466-95e3-bcdb503e3407&page=queryresults
[0m18:58:07.037039 [debug] [Thread-2 (]: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11]
[0m18:58:07.038379 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f
[0m18:58:07.039443 [debug] [Thread-2 (]: Began running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:58:07.040304 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_ (models/staging/source.yml)
  Unrecognized name: location_id at [11:11].
[0m18:58:07.041130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_stg_fact_orders_location_id__location_id__ref_stg_dim_location_.6877a76a0f, now test.glramira.unique_stg_fact_orders_event_id.a749b832a4)
[0m18:58:07.042038 [debug] [Thread-2 (]: Began compiling node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:58:07.057604 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"
[0m18:58:07.059106 [debug] [Thread-2 (]: Began executing node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:58:07.069916 [debug] [Thread-2 (]: On test.glramira.unique_stg_fact_orders_event_id.a749b832a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_fact_orders_event_id.a749b832a4"} */

  
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 20

[0m18:58:07.071039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:07.164139 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bf4d7c57-c1c4-4bf2-b159-d267f22bed14&page=queryresults
[0m18:58:07.165489 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bf4d7c57-c1c4-4bf2-b159-d267f22bed14&page=queryresults
[0m18:58:07.175251 [debug] [Thread-3 (]: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11]
[0m18:58:07.176875 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121
[0m18:58:07.178257 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_ (models/staging/source.yml)
  Unrecognized name: product_id at [11:11].
[0m18:58:07.179492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:686629ee-bcb9-4514-a3e7-70667a1fc603&page=queryresults
[0m18:58:07.180622 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:686629ee-bcb9-4514-a3e7-70667a1fc603&page=queryresults
[0m18:58:07.189285 [debug] [Thread-1 (]: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11]
[0m18:58:07.190585 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731
[0m18:58:07.191783 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_ (models/staging/source.yml)
  Unrecognized name: store_id at [11:11].
[0m18:58:07.748349 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:eb86d91d-f948-4acc-bbcb-6eef8273007c&page=queryresults
[0m18:58:07.749267 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:eb86d91d-f948-4acc-bbcb-6eef8273007c&page=queryresults
[0m18:58:07.754991 [debug] [Thread-4 (]: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:58:07.756163 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80
[0m18:58:07.757219 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
  Unrecognized name: user_id; Did you mean order_id? at [11:11].
[0m18:58:07.857438 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:11d5063c-a31e-4d77-aeaa-0681e80afc0f&page=queryresults
[0m18:58:08.717973 [debug] [Thread-2 (]: Finished running node test.glramira.unique_stg_fact_orders_event_id.a749b832a4
[0m18:58:08.718997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:08.719770 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_store_id__store_id__ref_stg_dim_store_.6c2db6f731' was properly closed.
[0m18:58:08.720580 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_product_id__product_id__ref_stg_dim_product_.2b5188c121' was properly closed.
[0m18:58:08.721191 [debug] [MainThread]: Connection 'test.glramira.relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_.94a97a4e80' was properly closed.
[0m18:58:08.721697 [debug] [MainThread]: Connection 'test.glramira.unique_stg_fact_orders_event_id.a749b832a4' was properly closed.
[0m18:58:08.722482 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test relationships_stg_fact_orders_user_id__user_id__ref_stg_dim_user_ (models/staging/source.yml)
    Unrecognized name: user_id; Did you mean order_id? at [11:11]
[0m18:58:08.723516 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:58:08.725096 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 13.861525, "process_in_blocks": "0", "process_kernel_time": 0.857289, "process_mem_max_rss": "416520", "process_out_blocks": "3792", "process_user_time": 9.036185}
[0m18:58:08.725791 [debug] [MainThread]: Command `dbt show` failed at 18:58:08.725626 after 13.86 seconds
[0m18:58:08.726399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44a76bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44a76bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42a0ae010>]}
[0m18:58:08.726977 [debug] [MainThread]: Flushing usage events
[0m18:58:08.933417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:58.844878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901a907150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901a905a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901a906e90>]}


============================== 18:58:58.849415 | 5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d ==============================
[0m18:58:58.849415 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:58:58.850309 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False'}
[0m18:59:02.334698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb0fe350>]}
[0m18:59:02.424664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901d4e10d0>]}
[0m18:59:02.440344 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:59:02.696460 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:59:02.882354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:02.884002 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/source.yml
[0m18:59:03.316111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m18:59:03.334996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffac0ec90>]}
[0m18:59:03.468567 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:59:03.471672 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:59:03.476953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffacf8150>]}
[0m18:59:03.477892 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m18:59:03.478670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901ae72210>]}
[0m18:59:03.481132 [info ] [MainThread]: 
[0m18:59:03.481758 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:03.482266 [info ] [MainThread]: 
[0m18:59:03.483098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:59:03.490024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m18:59:03.490886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:03.950233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ffc9db8-fdd7-4149-bb34-f6b4f3d6481d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb1b4990>]}
[0m18:59:03.951027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:03.958404 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m18:59:03.959241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m18:59:03.959865 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m18:59:03.971236 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m18:59:03.972263 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m18:59:03.983474 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
            CONCAT(
                CAST(e1.order_id AS STRING),
                CAST(cp.product_id AS STRING),
                CAST(e1.device_id AS STRING)
            )
        ) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m18:59:03.984399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:04.729911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:10a8519f-2864-4530-a54a-07efb4731512&page=queryresults
[0m18:59:05.677582 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m18:59:05.679886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:05.680557 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m18:59:05.681588 [debug] [MainThread]: Command end result
[0m18:59:05.732740 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m18:59:05.735639 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m18:59:05.744852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m18:59:05.745985 [info ] [MainThread]: Previewing node 'stg_fact_orders':
|             event_id | order_id | product_id | raw_device_id        | date_id | store_id | ... |
| -------------------- | -------- | ---------- | -------------------- | ------- | -------- | --- |
|                      |          | 109988     | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 89600      | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 109988     | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 89600      | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 109988     | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 89600      | 441a578f-14d6-414... | 5282020 | 29       | ... |
|                      |          | 92339      | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 109805     | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 92339      | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 109805     | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 92339      | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 109805     | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 92339      | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 109805     | 71532f9c-a208-4fc... | 5272020 | 29       | ... |
|                      |          | 85809      | 13bb4b88-fa01-463... | 5282020 | 29       | ... |
|                      |          | 89569      | 13bb4b88-fa01-463... | 5282020 | 29       | ... |
|                      |          | 109988     | 13bb4b88-fa01-463... | 5282020 | 29       | ... |
|                      |          | 99537      | 302dd241-8196-479... | 5282020 | 29       | ... |
| -1953497068201958137 |          | 84878      | efe18703-9a2a-491... | 5272020 | 41       | ... |
|  8305029919436422657 |          | 109805     | efe18703-9a2a-491... | 5272020 | 41       | ... |

[0m18:59:05.748034 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 6.976217, "process_in_blocks": "0", "process_kernel_time": 0.758089, "process_mem_max_rss": "406956", "process_out_blocks": "5264", "process_user_time": 6.731608}
[0m18:59:05.748758 [debug] [MainThread]: Command `dbt show` succeeded at 18:59:05.748584 after 6.98 seconds
[0m18:59:05.749387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901a773d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901a770f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901eb984d0>]}
[0m18:59:05.749997 [debug] [MainThread]: Flushing usage events
[0m18:59:05.915252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:23.052922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0129f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0152290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0151e10>]}


============================== 19:00:23.057341 | e0f872ee-576c-4f37-a4e5-b7dad4425c80 ==============================
[0m19:00:23.057341 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:00:23.058235 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'target_path': 'None', 'warn_error': 'None', 'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True'}
[0m19:00:26.431957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b09c0bd0>]}
[0m19:00:26.519001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d2d25c50>]}
[0m19:00:26.534639 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:00:26.783852 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:00:27.023002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:27.024103 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:00:27.482395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:00:27.502040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b00150d0>]}
[0m19:00:27.640550 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:00:27.643482 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:00:27.648805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b00c9850>]}
[0m19:00:27.649653 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:00:27.650269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0077890>]}
[0m19:00:27.652608 [info ] [MainThread]: 
[0m19:00:27.653194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:27.653675 [info ] [MainThread]: 
[0m19:00:27.654492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:27.661001 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m19:00:27.661694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:28.116732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f872ee-576c-4f37-a4e5-b7dad4425c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b03f9a50>]}
[0m19:00:28.117591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:28.124317 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:00:28.125208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:00:28.125788 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:00:28.137054 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:00:28.138099 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:00:28.149586 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id
        -- cast(e1.ip as string) as ip_address,
        -- cast(cp.price as float64) as price,
        -- cast(cp.amount as float64) as amount,
        -- cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        -- cast(e1.is_paypal as float64) as is_paypal,
        -- cast(e2.country as string) as country,
        -- cast(e2.country_code as string) as country_code,
        -- cast(e2.region as string) as region,
        -- cast(e2.city as string) as city,
        -- farm_fingerprint(
        --     concat(
        --         coalesce(cast(e2.country as string), ''),
        --         coalesce(cast(e2.country_code as string), ''),
        --         coalesce(cast(e2.region as string), ''),
        --         coalesce(cast(e2.city as string), '')
        --     )
        -- ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m19:00:28.150392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.954491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a0f7e2b5-f1b0-4531-b8c4-d9834ea6f220&page=queryresults
[0m19:00:31.425357 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:00:31.427564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:31.428263 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:00:31.429372 [debug] [MainThread]: Command end result
[0m19:00:31.481300 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:00:31.484303 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:00:31.493501 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:00:31.494504 [info ] [MainThread]: Previewing node 'stg_fact_orders':
|             event_id | order_id | product_id | raw_device_id        | date_id | store_id | ... |
| -------------------- | -------- | ---------- | -------------------- | ------- | -------- | --- |
|  3096012471666000008 |          | 95503      | 138ff9e0-7fbb-446... | 4232020 | 29       | ... |
|  3096012471666000008 |          | 95503      | 138ff9e0-7fbb-446... | 4232020 | 29       | ... |
|  4977703538497586622 |          | 98267      | a5cd0891-36ea-4eb... | 4232020 | 68       | ... |
| -7032775415375547840 |          | 95500      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -4359516298069477292 |          | 92364      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -7032775415375547840 |          | 95500      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -4359516298069477292 |          | 92364      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -7032775415375547840 |          | 95500      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -4359516298069477292 |          | 92364      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -7032775415375547840 |          | 95500      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
| -4359516298069477292 |          | 92364      | a37913b4-594b-4fa... | 4232020 | 41       | ... |
|  8064731686935678379 |          | 103486     | 04c5782c-bcef-44d... | 4232020 | 65       | ... |
|  8064731686935678379 |          | 103486     | 04c5782c-bcef-44d... | 4232020 | 65       | ... |
|  4920396056758659947 |          | 97371      | cc9e4a39-d3db-4e8... | 4232020 | 41       | ... |
|  6465987124401534195 |          | 89593      | 1bca4ef9-de89-4d8... | 4232020 | 41       | ... |
|  6465987124401534195 |          | 89593      | 1bca4ef9-de89-4d8... | 4232020 | 41       | ... |
|  6465987124401534195 |          | 89593      | 1bca4ef9-de89-4d8... | 4232020 | 41       | ... |
|  5461080788978728555 |          | 103347     | e883d842-e4f6-46e... | 4232020 | 12       | ... |
|  -782290034143314783 |          | 91026      | e883d842-e4f6-46e... | 4232020 | 12       | ... |
|  8068543477613255700 |          | 103426     | e883d842-e4f6-46e... | 4232020 | 12       | ... |

[0m19:00:31.496209 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 8.515735, "process_in_blocks": "0", "process_kernel_time": 0.814535, "process_mem_max_rss": "406380", "process_out_blocks": "5264", "process_user_time": 6.602184}
[0m19:00:31.496988 [debug] [MainThread]: Command `dbt show` succeeded at 19:00:31.496800 after 8.52 seconds
[0m19:00:31.497610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0153510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0151990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d43d0450>]}
[0m19:00:31.498307 [debug] [MainThread]: Flushing usage events
[0m19:00:31.734020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:54.275191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086df1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086f99a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086dea890>]}


============================== 19:00:54.279632 | 435f8a99-3261-4929-9a7a-9095ee75bfde ==============================
[0m19:00:54.279632 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:00:54.280491 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m19:00:57.758156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06732bf50>]}
[0m19:00:57.844277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0899ddc90>]}
[0m19:00:57.859662 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:00:58.103159 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:00:58.288297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:58.289430 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:00:58.731877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:00:58.751864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06739ed50>]}
[0m19:00:58.892178 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:00:58.895272 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:00:58.900694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc066e5d790>]}
[0m19:00:58.901622 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:00:58.902314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc066312390>]}
[0m19:00:58.904585 [info ] [MainThread]: 
[0m19:00:58.905204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:58.905708 [info ] [MainThread]: 
[0m19:00:58.906546 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:58.913112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m19:00:58.914063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:59.367689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435f8a99-3261-4929-9a7a-9095ee75bfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc066e278d0>]}
[0m19:00:59.368596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:59.376175 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:00:59.377112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:00:59.377779 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:00:59.389016 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:00:59.390252 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:00:59.402377 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as float64) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m19:00:59.403256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:00.326662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dce6ecaa-9e4f-42d1-b7f2-12cc3b87c011&page=queryresults
[0m19:01:00.327684 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:dce6ecaa-9e4f-42d1-b7f2-12cc3b87c011&page=queryresults
[0m19:01:00.334560 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m19:01:00.335870 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:01:00.336761 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m19:01:00.338154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:00.338996 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:01:00.339870 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m19:01:00.341305 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.1397734, "process_in_blocks": "0", "process_kernel_time": 0.830562, "process_mem_max_rss": "401140", "process_out_blocks": "3560", "process_user_time": 6.521653}
[0m19:01:00.342018 [debug] [MainThread]: Command `dbt show` failed at 19:01:00.341861 after 6.14 seconds
[0m19:01:00.342591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086e5fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08afb7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08afb7390>]}
[0m19:01:00.343191 [debug] [MainThread]: Flushing usage events
[0m19:01:00.507477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:30.757213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c2c6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c46a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c2c7390>]}


============================== 19:02:30.761990 | 1b448235-9f5a-4a7d-9275-ecc33a2dfa30 ==============================
[0m19:02:30.761990 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:02:30.762852 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'empty': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m19:02:34.310975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e5c9cf7d0>]}
[0m19:02:34.406232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7ee59cd0>]}
[0m19:02:34.423272 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:02:34.673179 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:02:34.860439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:34.861577 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:02:35.308570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:02:35.327580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c86be10>]}
[0m19:02:35.463091 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:02:35.466668 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:02:35.471936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e5c51abd0>]}
[0m19:02:35.472772 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:02:35.473321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7cbee350>]}
[0m19:02:35.475620 [info ] [MainThread]: 
[0m19:02:35.476153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:35.476655 [info ] [MainThread]: 
[0m19:02:35.477482 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:35.484114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m19:02:35.485038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:35.961767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b448235-9f5a-4a7d-9275-ecc33a2dfa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e5c8505d0>]}
[0m19:02:35.962637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:35.969803 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:02:35.970688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:02:35.971278 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:02:35.982986 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:02:35.984122 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:02:35.995262 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        -- cast(coalesce(cp.amount, 0) * coalesce(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m19:02:35.996153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:37.829879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3d9eebef-0603-4061-b1f1-d090bea861f7&page=queryresults
[0m19:02:39.675847 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:02:39.678503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:39.679153 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:02:39.680295 [debug] [MainThread]: Command end result
[0m19:02:39.735516 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:02:39.738552 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:02:39.747760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:02:39.748763 [info ] [MainThread]: Previewing node 'stg_fact_orders':
|             event_id | order_id | product_id | raw_device_id        | date_id | store_id | ... |
| -------------------- | -------- | ---------- | -------------------- | ------- | -------- | --- |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
|  8301764247875907234 |          | 109814     | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
|  8301764247875907234 |          | 109814     | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -6706113137619292638 |          | 92368      | 23abc856-44cc-4af... | 5062020 | 14       | ... |
|  8301764247875907234 |          | 109814     | 23abc856-44cc-4af... | 5062020 | 14       | ... |
| -8731258986160880055 |          | 106097     | 21619121-82cb-448... | 5062020 | 85       | ... |
| -7912548369970837384 |          | 103725     | 21619121-82cb-448... | 5062020 | 85       | ... |
|  2987075691108340547 |          | 98127      | e73d4bbb-517a-469... | 5062020 | 38       | ... |
|  6282358174237062764 |          | 102928     | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
|  2997998992048977850 |          | 92433      | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
| -4881321210144706777 |          | 110538     | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
| -7688214913381508975 |          | 99819      | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
|  1475123698009733120 |          | 109806     | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
|  6282358174237062764 |          | 102928     | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
|  2997998992048977850 |          | 92433      | 4718e98e-1faa-41b... | 5062020 | 6        | ... |
| -4881321210144706777 |          | 110538     | 4718e98e-1faa-41b... | 5062020 | 6        | ... |

[0m19:02:39.750429 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 9.06813, "process_in_blocks": "0", "process_kernel_time": 0.850575, "process_mem_max_rss": "405064", "process_out_blocks": "5264", "process_user_time": 6.715724}
[0m19:02:39.751205 [debug] [MainThread]: Command `dbt show` succeeded at 19:02:39.751025 after 9.07 seconds
[0m19:02:39.751843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c134810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7c135e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e805084d0>]}
[0m19:02:39.752530 [debug] [MainThread]: Flushing usage events
[0m19:02:39.945171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:10.151327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc551522810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc551521e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5515217d0>]}


============================== 19:03:10.155735 | bb5a675b-2182-4236-b818-cb498b6aa3d7 ==============================
[0m19:03:10.155735 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:03:10.156734 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m19:03:13.607597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc531b58450>]}
[0m19:03:13.693851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5540420d0>]}
[0m19:03:13.710086 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:03:13.956457 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:03:14.144500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:14.145663 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:03:14.597748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:03:14.617298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc531a52dd0>]}
[0m19:03:14.752072 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:03:14.754990 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:03:14.760185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5318b4650>]}
[0m19:03:14.760987 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:03:14.761575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc531a0ce50>]}
[0m19:03:14.763856 [info ] [MainThread]: 
[0m19:03:14.764394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:14.764850 [info ] [MainThread]: 
[0m19:03:14.765665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:14.772622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m19:03:14.773474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:15.224859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5a675b-2182-4236-b818-cb498b6aa3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5316c9650>]}
[0m19:03:15.225738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:15.234037 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:03:15.234911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:03:15.235602 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:03:15.250750 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:03:15.263829 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:03:15.282244 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(cp.amount, 0) * COALESCE(cp.price, 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m19:03:15.283468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:16.751971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:18cd1d88-4352-42ef-8c69-0ebd1db0fd7a&page=queryresults
[0m19:03:16.752978 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:18cd1d88-4352-42ef-8c69-0ebd1db0fd7a&page=queryresults
[0m19:03:16.760047 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39]
[0m19:03:16.761454 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:03:16.762438 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: STRING, INT64
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [23:39].
[0m19:03:16.763936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:16.764723 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:03:16.765513 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    No matching signature for function COALESCE
      Argument types: STRING, INT64
      Signature: COALESCE([T1, ...])
        Unable to find common supertype for templated argument <T1>
          Input types for <T1>: {INT64, STRING} at [23:39]
[0m19:03:16.766904 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.6898193, "process_in_blocks": "0", "process_kernel_time": 0.720659, "process_mem_max_rss": "399508", "process_out_blocks": "3552", "process_user_time": 6.703871}
[0m19:03:16.767601 [debug] [MainThread]: Command `dbt show` failed at 19:03:16.767441 after 6.69 seconds
[0m19:03:16.768153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc551530ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5316ca710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5317a32d0>]}
[0m19:03:16.768745 [debug] [MainThread]: Flushing usage events
[0m19:03:16.932537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:07.818750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e388c3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e3891e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e3891f2d0>]}


============================== 19:04:07.823358 | cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e ==============================
[0m19:04:07.823358 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:04:07.824318 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False'}
[0m19:04:11.270723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e38910350>]}
[0m19:04:11.356641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e3b4c5410>]}
[0m19:04:11.372622 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:04:11.627155 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:04:11.809667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:11.810782 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:04:12.250411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:04:12.269649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e13d20710>]}
[0m19:04:12.402856 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:04:12.405869 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:04:12.411066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e39860d90>]}
[0m19:04:12.411977 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:04:12.412660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e18789c50>]}
[0m19:04:12.415051 [info ] [MainThread]: 
[0m19:04:12.415771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:12.416305 [info ] [MainThread]: 
[0m19:04:12.417179 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:12.423871 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m19:04:12.424673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:12.884007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9fa68d-05d7-4c0e-ab7e-c1a118e7e25e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e18843150>]}
[0m19:04:12.884833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:12.892808 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:04:12.893727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:04:12.894484 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:04:12.906361 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:04:12.907502 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:04:12.920242 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(cp.price AS FLOAT64), 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base
  
  limit 20

[0m19:04:12.921116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:14.763800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4182df4b-55d4-4ae6-bc85-130988ceee7b&page=queryresults
[0m19:04:16.423688 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:04:16.425917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:16.426671 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:04:16.427904 [debug] [MainThread]: Command end result
[0m19:04:16.482489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:04:16.485302 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:04:16.493985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:04:16.494998 [info ] [MainThread]: Previewing node 'stg_fact_orders':
|             event_id | order_id | product_id | raw_device_id        | date_id | store_id | ... |
| -------------------- | -------- | ---------- | -------------------- | ------- | -------- | --- |
|  8631716239689490471 |          | 98267      | d0d861dd-f0ee-4cf... | 5192020 | 65       | ... |
|  4521410357682438781 |          | 84831      | 5b43caf1-304f-432... | 5192020 | 41       | ... |
| -5795169648740666045 |          | 109925     | 5b43caf1-304f-432... | 5192020 | 41       | ... |
|  2351783627947040833 |          | 97876      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  2603037442289567460 |          | 96064      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  5621876837115086501 |          | 96144      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  6653712976247249963 |          | 102504     | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  4993122360663600220 |          | 96624      | 5708ef44-b486-434... | 5192020 | 12       | ... |
| -7531091832071807029 |          | 89473      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  5293538132176081219 |          | 101990     | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  5239909884507541730 |          | 95588      | 5708ef44-b486-434... | 5192020 | 12       | ... |
| -1036072997375419223 |          | 106526     | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  8414282016831022129 |          | 109940     | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  2351783627947040833 |          | 97876      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  2603037442289567460 |          | 96064      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  5621876837115086501 |          | 96144      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  6653712976247249963 |          | 102504     | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  4993122360663600220 |          | 96624      | 5708ef44-b486-434... | 5192020 | 12       | ... |
|  4847696546014930741 |          | 102003     | 5708ef44-b486-434... | 5192020 | 12       | ... |
| -7531091832071807029 |          | 89473      | 5708ef44-b486-434... | 5192020 | 12       | ... |

[0m19:04:16.496632 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 8.752117, "process_in_blocks": "0", "process_kernel_time": 0.744523, "process_mem_max_rss": "406300", "process_out_blocks": "5272", "process_user_time": 6.716603}
[0m19:04:16.497325 [debug] [MainThread]: Command `dbt show` succeeded at 19:04:16.497141 after 8.75 seconds
[0m19:04:16.497854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e38731b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e38730bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e3caaf210>]}
[0m19:04:16.498406 [debug] [MainThread]: Flushing usage events
[0m19:04:16.680486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:46.048456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7406890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec740d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7407fd0>]}


============================== 19:04:46.053140 | e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5 ==============================
[0m19:04:46.053140 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:04:46.054139 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_fact_order', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True'}
[0m19:04:46.054787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:04:46.055487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7277e10>]}
[0m19:04:49.648809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7427190>]}
[0m19:04:49.735358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec9f61450>]}
[0m19:04:49.736592 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:04:49.997746 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:04:50.184038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:50.184678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:50.193388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:04:50.251433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea7774e10>]}
[0m19:04:50.389206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:04:50.392392 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:04:50.413107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea7aaa210>]}
[0m19:04:50.414024 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:04:50.414650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9f46f6e-6d23-443e-9fce-4d4cc48fd5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea7ab0410>]}
[0m19:04:50.415912 [warn ] [MainThread]: The selection criterion 'stg_fact_order' does not match any enabled nodes
[0m19:04:50.417640 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:04:50.420226 [debug] [MainThread]: Command end result
[0m19:04:50.473786 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:04:50.476640 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:04:50.481316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:04:50.482273 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:04:50.483891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5131454, "process_in_blocks": "0", "process_kernel_time": 0.767342, "process_mem_max_rss": "388372", "process_out_blocks": "3480", "process_user_time": 6.112291}
[0m19:04:50.484962 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:50.484731 after 4.51 seconds
[0m19:04:50.485590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7277e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec7274090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecb610290>]}
[0m19:04:50.486200 [debug] [MainThread]: Flushing usage events
[0m19:04:50.659516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:30.102707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49056ff010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49056ff110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49056fee90>]}


============================== 19:05:30.107630 | bddbf588-6343-4ae6-adc1-68a8e911eebc ==============================
[0m19:05:30.107630 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:05:30.108655 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_fact_orders --target prod', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True'}
[0m19:05:30.112633 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'glramira' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m19:05:30.114211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08705527, "process_in_blocks": "0", "process_kernel_time": 0.331558, "process_mem_max_rss": "99852", "process_out_blocks": "16", "process_user_time": 1.769752}
[0m19:05:30.115085 [debug] [MainThread]: Command `dbt run` failed at 19:05:30.114872 after 0.09 seconds
[0m19:05:30.115904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4905573350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4905573a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4905707ed0>]}
[0m19:05:30.116572 [debug] [MainThread]: Flushing usage events
[0m19:05:30.334557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:05.109730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa5f3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa5f2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa5f1310>]}


============================== 19:06:05.114432 | 4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d ==============================
[0m19:06:05.114432 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:06:05.115354 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs'}
[0m19:06:05.116044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:06:05.116697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa716b50>]}
[0m19:06:08.606956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa7142d0>]}
[0m19:06:08.693686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfd1e9750>]}
[0m19:06:08.694829 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:06:08.940737 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:06:09.126955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:09.127647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:09.135963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:06:09.193504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cda809750>]}
[0m19:06:09.333182 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:06:09.336151 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:06:09.355321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdab1d9d0>]}
[0m19:06:09.356227 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:06:09.356836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cda9d2b50>]}
[0m19:06:09.359172 [info ] [MainThread]: 
[0m19:06:09.359764 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:09.360264 [info ] [MainThread]: 
[0m19:06:09.361129 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:09.363347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m19:06:09.364268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:09.835996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m19:06:09.837127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:10.283065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cda9a9050>]}
[0m19:06:10.284049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:10.293012 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:06:10.294375 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m19:06:10.295609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:06:10.296454 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:06:10.317528 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:06:10.319010 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:06:10.370650 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m19:06:10.372027 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        cast(cp.price as float64) as price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(cp.price AS FLOAT64), 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m19:06:10.372855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:11.117013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7287c702-dced-4623-b792-44799bb147df&page=queryresults
[0m19:06:12.688861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4febf2-4549-4cfe-b9cf-d89a5b64dd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdab54d90>]}
[0m19:06:12.690161 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.39s]
[0m19:06:12.691211 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:06:12.693596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:12.696000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:12.696544 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:06:12.697097 [info ] [MainThread]: 
[0m19:06:12.697667 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m19:06:12.698769 [debug] [MainThread]: Command end result
[0m19:06:12.749741 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:06:12.752625 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:06:12.760782 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:06:12.761365 [info ] [MainThread]: 
[0m19:06:12.762050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:12.762552 [info ] [MainThread]: 
[0m19:06:12.763103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:06:12.763900 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:06:12.765239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7469544, "process_in_blocks": "0", "process_kernel_time": 0.888695, "process_mem_max_rss": "397964", "process_out_blocks": "3528", "process_user_time": 6.581422}
[0m19:06:12.765952 [debug] [MainThread]: Command `dbt run` succeeded at 19:06:12.765798 after 7.75 seconds
[0m19:06:12.766517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa65b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfe7c3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfe8842d0>]}
[0m19:06:12.767084 [debug] [MainThread]: Flushing usage events
[0m19:06:12.931722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:52.641005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55480ff290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5548226a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5548f80210>]}


============================== 19:08:52.645629 | 38b23c6a-1a6e-4ac3-b723-43a48501215d ==============================
[0m19:08:52.645629 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:08:52.646570 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m19:08:52.647255 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:08:52.647963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55482a9bd0>]}
[0m19:08:56.111701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55481173d0>]}
[0m19:08:56.197772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554ace1310>]}
[0m19:08:56.198824 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:08:56.444388 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:08:56.630188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:08:56.631287 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:08:57.078048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:08:57.097492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55285b4b10>]}
[0m19:08:57.231255 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:08:57.234270 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:08:57.254016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55288a0690>]}
[0m19:08:57.254854 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:08:57.255490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55285c3d50>]}
[0m19:08:57.258107 [info ] [MainThread]: 
[0m19:08:57.258722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:08:57.259198 [info ] [MainThread]: 
[0m19:08:57.260030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:08:57.261813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m19:08:57.262597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:57.750357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m19:08:57.751349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:58.203584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f552825a550>]}
[0m19:08:58.204497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:58.212276 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:08:58.213275 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m19:08:58.214100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:08:58.214705 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:08:58.226499 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:08:58.227928 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:08:58.269312 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m19:08:58.270656 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(cp.price AS FLOAT64), 0) AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m19:08:58.271540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:59.184066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b687383a-fd1e-497e-908f-0c780168d39e&page=queryresults
[0m19:09:00.168284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b23c6a-1a6e-4ac3-b723-43a48501215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f552798d1d0>]}
[0m19:09:00.169448 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m19:09:00.170469 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:09:00.172575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:09:00.174870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:00.175416 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:09:00.176049 [info ] [MainThread]: 
[0m19:09:00.176571 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m19:09:00.177739 [debug] [MainThread]: Command end result
[0m19:09:00.229709 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:09:00.232572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:09:00.240252 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:09:00.240810 [info ] [MainThread]: 
[0m19:09:00.241522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:00.242035 [info ] [MainThread]: 
[0m19:09:00.242589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:09:00.243355 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:09:00.244653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6769023, "process_in_blocks": "0", "process_kernel_time": 0.845103, "process_mem_max_rss": "408432", "process_out_blocks": "5280", "process_user_time": 6.763591}
[0m19:09:00.245291 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:00.245145 after 7.68 seconds
[0m19:09:00.245809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55482a9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c3a8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f552807df10>]}
[0m19:09:00.246478 [debug] [MainThread]: Flushing usage events
[0m19:09:00.450917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:15.710947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce9285b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce674f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce674f550>]}


============================== 19:10:15.716214 | dbb8a5f0-1be0-4982-a958-47d34edd8e81 ==============================
[0m19:10:15.716214 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:10:15.717137 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m stg_fact_orders'}
[0m19:10:15.717760 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:10:15.718394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce674dc10>]}
[0m19:10:19.130141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce6cacc50>]}
[0m19:10:19.217944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce92e1490>]}
[0m19:10:19.219048 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:10:19.467762 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:10:19.651809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:10:19.652840 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:10:20.105407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:10:20.125058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc6662d90>]}
[0m19:10:20.262668 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:10:20.265912 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:10:20.286525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc6a46ed0>]}
[0m19:10:20.287482 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:10:20.288196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc6608ad0>]}
[0m19:10:20.290761 [info ] [MainThread]: 
[0m19:10:20.291459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:20.292030 [info ] [MainThread]: 
[0m19:10:20.292948 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:10:20.294617 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m19:10:20.295456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:20.775450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m19:10:20.776264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:21.226728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc6635210>]}
[0m19:10:21.227668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:21.234163 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:10:21.235041 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m19:10:21.235935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:10:21.236520 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:10:21.247865 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:10:21.248902 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:10:21.289083 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m19:10:21.290570 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(
  COALESCE(CAST(REPLACE(cp.amount, ',', '.') AS FLOAT64), 0) *
  COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0)
AS FLOAT64) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m19:10:21.291511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:22.044880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f250ffb1-a8b5-4372-aa1f-3aa3f9414ff7&page=queryresults
[0m19:10:22.321676 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f250ffb1-a8b5-4372-aa1f-3aa3f9414ff7&page=queryresults
[0m19:10:22.332910 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [26:17]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:10:22.335390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb8a5f0-1be0-4982-a958-47d34edd8e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc6d0a050>]}
[0m19:10:22.336625 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.10s]
[0m19:10:22.337592 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:10:22.338495 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [26:17]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m19:10:22.341719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:22.344499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:22.345071 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:10:22.345659 [info ] [MainThread]: 
[0m19:10:22.346272 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m19:10:22.347322 [debug] [MainThread]: Command end result
[0m19:10:22.402678 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:10:22.405662 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:10:22.413590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:10:22.414188 [info ] [MainThread]: 
[0m19:10:22.414843 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:10:22.415545 [info ] [MainThread]: 
[0m19:10:22.416238 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m19:10:22.416915 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [26:17]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:10:22.417472 [info ] [MainThread]: 
[0m19:10:22.418116 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m19:10:22.418611 [info ] [MainThread]: 
[0m19:10:22.419156 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:10:22.420052 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:10:22.421488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7969766, "process_in_blocks": "0", "process_kernel_time": 0.819452, "process_mem_max_rss": "400072", "process_out_blocks": "5288", "process_user_time": 6.795221}
[0m19:10:22.422273 [debug] [MainThread]: Command `dbt run` failed at 19:10:22.422104 after 6.80 seconds
[0m19:10:22.422840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce674efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcea8d72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcea8d7250>]}
[0m19:10:22.423418 [debug] [MainThread]: Flushing usage events
[0m19:10:22.612443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:25.356164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e9cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771eb9db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771eb72150>]}


============================== 19:11:25.360481 | 8eaa02db-f700-4037-b1e1-49bb276dc9c2 ==============================
[0m19:11:25.360481 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:11:25.361350 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_fact_orders', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'introspect': 'True'}
[0m19:11:25.361964 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:11:25.362798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771e82d390>]}
[0m19:11:28.868060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ef9ca50>]}
[0m19:11:28.957416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7721528850>]}
[0m19:11:28.958520 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:11:29.202717 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:11:29.399448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:29.400505 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:11:29.851130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:11:29.870360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff1e81d0>]}
[0m19:11:30.003291 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:11:30.006547 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:11:30.026450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fefb2310>]}
[0m19:11:30.027332 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:11:30.028033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fe133b90>]}
[0m19:11:30.030317 [info ] [MainThread]: 
[0m19:11:30.030960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:30.031539 [info ] [MainThread]: 
[0m19:11:30.032402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:30.033889 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m19:11:30.034526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:30.525580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m19:11:30.526440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:30.978689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fefb2310>]}
[0m19:11:30.979547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:30.986170 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:11:30.987123 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m19:11:30.987999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:11:30.988546 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:11:31.000402 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:11:31.001438 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:11:31.041587 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m19:11:31.042747 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        CAST(COALESCE(REPLACE(cp.amount, ',', '.') AS FLOAT64), 0) AS amount,
        CAST(COALESCE(REPLACE(cp.currency, ',', '.') AS STRING), '') AS currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS FLOAT64) AS final_amount,
        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m19:11:31.043513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:31.711320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:34c0214c-6fc2-4131-9395-88e246e5a42d&page=queryresults
[0m19:11:31.712306 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:34c0214c-6fc2-4131-9395-88e246e5a42d&page=queryresults
[0m19:11:31.721892 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected keyword AS but got "," at [23:63]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:11:31.724267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa02db-f700-4037-b1e1-49bb276dc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fed59250>]}
[0m19:11:31.725254 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.73s]
[0m19:11:31.726160 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:11:31.727083 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected keyword AS but got "," at [23:63]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m19:11:31.730093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:31.732658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:31.733173 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:11:31.733717 [info ] [MainThread]: 
[0m19:11:31.734277 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m19:11:31.735241 [debug] [MainThread]: Command end result
[0m19:11:31.818860 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:11:31.821930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:11:31.829843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:11:31.830509 [info ] [MainThread]: 
[0m19:11:31.831225 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:11:31.831892 [info ] [MainThread]: 
[0m19:11:31.832566 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m19:11:31.833263 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected keyword AS but got "," at [23:63]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:11:31.833813 [info ] [MainThread]: 
[0m19:11:31.834428 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m19:11:31.834959 [info ] [MainThread]: 
[0m19:11:31.835577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:11:31.836548 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:11:31.838225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.557948, "process_in_blocks": "0", "process_kernel_time": 0.821897, "process_mem_max_rss": "402236", "process_out_blocks": "5280", "process_user_time": 6.841627}
[0m19:11:31.838984 [debug] [MainThread]: Command `dbt run` failed at 19:11:31.838823 after 6.56 seconds
[0m19:11:31.839645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7722b2f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771eb71a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7722c78ed0>]}
[0m19:11:31.840235 [debug] [MainThread]: Flushing usage events
[0m19:11:32.033269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:41.526669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5d736110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5d6d1b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5d885c10>]}


============================== 19:11:41.531245 | b734be96-383a-4483-99f3-87cffab20378 ==============================
[0m19:11:41.531245 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:11:41.532116 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'quiet': 'False', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'empty': 'False'}
[0m19:11:41.532707 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:11:41.533424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5d6d1b50>]}
[0m19:11:45.107906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3dd24890>]}
[0m19:11:45.198184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60255890>]}
[0m19:11:45.199278 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:11:45.479610 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:11:45.668253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:45.669308 [debug] [MainThread]: Partial parsing: updated file: glramira://models/staging/stg_fact_orders.sql
[0m19:11:46.109820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m19:11:46.129022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3d6bc110>]}
[0m19:11:46.261824 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:11:46.264718 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:11:46.283738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3dc75b10>]}
[0m19:11:46.284570 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m19:11:46.285108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3d615550>]}
[0m19:11:46.287302 [info ] [MainThread]: 
[0m19:11:46.287841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:46.288345 [info ] [MainThread]: 
[0m19:11:46.289167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:46.290545 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m19:11:46.291169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:46.761453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m19:11:46.762281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:47.211445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3d615550>]}
[0m19:11:47.212376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:47.220705 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m19:11:47.221846 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m19:11:47.222818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m19:11:47.223458 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m19:11:47.235145 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m19:11:47.236275 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m19:11:47.276749 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m19:11:47.277939 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m19:11:47.278730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:48.091322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:27cec2b8-601c-493c-946a-8393b2496806&page=queryresults
[0m19:11:48.092318 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:27cec2b8-601c-493c-946a-8393b2496806&page=queryresults
[0m19:11:48.102659 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:11:48.105311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b734be96-383a-4483-99f3-87cffab20378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a3cdf3d10>]}
[0m19:11:48.106572 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 0.88s]
[0m19:11:48.107590 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m19:11:48.108506 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m19:11:48.111725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:48.114175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:48.114758 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m19:11:48.115340 [info ] [MainThread]: 
[0m19:11:48.115968 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m19:11:48.116981 [debug] [MainThread]: Command end result
[0m19:11:48.169995 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m19:11:48.173055 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m19:11:48.180558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m19:11:48.181207 [info ] [MainThread]: 
[0m19:11:48.181863 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:11:48.182401 [info ] [MainThread]: 
[0m19:11:48.183022 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m19:11:48.183884 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m19:11:48.184576 [info ] [MainThread]: 
[0m19:11:48.185383 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m19:11:48.186066 [info ] [MainThread]: 
[0m19:11:48.186815 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:11:48.187990 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:11:48.189801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7399487, "process_in_blocks": "0", "process_kernel_time": 0.887086, "process_mem_max_rss": "401172", "process_out_blocks": "5272", "process_user_time": 6.85353}
[0m19:11:48.190723 [debug] [MainThread]: Command `dbt run` failed at 19:11:48.190519 after 6.74 seconds
[0m19:11:48.191600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5d6d2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a61873210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a61873190>]}
[0m19:11:48.192415 [debug] [MainThread]: Flushing usage events
[0m19:11:48.356809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:01:52.598048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80c15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80ba0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8266290>]}


============================== 06:01:52.604398 | 46d0c4d3-58cd-4379-8170-c085b44b7f05 ==============================
[0m06:01:52.604398 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:01:52.605223 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'invocation_command': 'dbt ', 'printer_width': '80', 'fail_fast': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None'}
[0m06:01:52.778165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d0c4d3-58cd-4379-8170-c085b44b7f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80c3490>]}
[0m06:01:52.814174 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-do73nzhj'
[0m06:01:52.814869 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:01:52.943794 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:01:52.946585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m06:01:53.029340 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m06:01:53.032644 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m06:01:53.033473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46d0c4d3-58cd-4379-8170-c085b44b7f05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7f2c9d0>]}
[0m06:01:53.037797 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m06:01:53.122690 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m06:01:53.128339 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m06:01:53.597517 [info ] [MainThread]: Installed from version 0.10.4
[0m06:01:53.598200 [info ] [MainThread]: Up to date!
[0m06:01:53.598730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '46d0c4d3-58cd-4379-8170-c085b44b7f05', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8f38410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b811d250>]}
[0m06:01:53.599390 [info ] [MainThread]: Installing calogica/dbt_date
[0m06:01:53.766455 [info ] [MainThread]: Installed from version 0.10.1
[0m06:01:53.767080 [info ] [MainThread]: Up to date!
[0m06:01:53.767775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '46d0c4d3-58cd-4379-8170-c085b44b7f05', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7e3f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8018e90>]}
[0m06:01:53.769897 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:01:53.771605 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2551388, "process_in_blocks": "0", "process_kernel_time": 0.439656, "process_mem_max_rss": "111240", "process_out_blocks": "20848", "process_user_time": 2.537423}
[0m06:01:53.772476 [debug] [MainThread]: Command `cli deps` succeeded at 06:01:53.772273 after 1.26 seconds
[0m06:01:53.772976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80ba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b80b9a50>]}
[0m06:01:53.773513 [debug] [MainThread]: Flushing usage events
[0m06:01:53.952106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:03:35.406805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0f72ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0f7b1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0f462250>]}


============================== 06:03:35.411298 | a7c874d2-d5f9-4f64-bf36-b4ff297d6611 ==============================
[0m06:03:35.411298 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:03:35.412203 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_fact_orders', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True'}
[0m06:03:35.412844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:03:35.413464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0f7b1d90>]}
[0m06:03:38.955494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79efb6c510>]}
[0m06:03:39.050275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a121e5850>]}
[0m06:03:39.051535 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:03:39.336539 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:03:39.528240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:03:39.528916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:03:39.537617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:03:39.598336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ef9a7310>]}
[0m06:03:39.737255 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:03:39.740403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:03:39.761565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ef9b91d0>]}
[0m06:03:39.762428 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:03:39.763053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ef80d6d0>]}
[0m06:03:39.765490 [info ] [MainThread]: 
[0m06:03:39.766130 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:03:39.766685 [info ] [MainThread]: 
[0m06:03:39.767621 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:03:39.769805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:03:39.770695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:40.293691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:03:40.294551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:40.761266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0f8b1e10>]}
[0m06:03:40.762187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:40.770057 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:03:40.771059 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:03:40.772053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:03:40.772597 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:03:40.786182 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:03:40.787271 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:03:40.829537 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:03:40.830934 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
    CONCAT(
        COALESCE(CAST(e1.order_id AS STRING), ''),
        COALESCE(CAST(cp.product_id AS STRING), ''),
        COALESCE(CAST(e1.device_id AS STRING), '')
    )
) AS event_id,
        cast(e1.order_id as STRING) as order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        cast(e1.device_id as STRING) as raw_device_id,
        cast(format_timestamp('%m%d%Y', timestamp_seconds(e1.time_stamp)) as int64) as date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(coalesce(cast(e1.email_address as string), '')) as user_id,
        cast(e1.ip as string) as ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        cast(cp.amount as float64) as amount,
        cast(cp.currency as string) as currency,
        CAST(COALESCE(CAST(cp.amount AS FLOAT64), 0) * COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS final_amount,
        cast(e1.is_paypal as string) as is_paypal,
        cast(e2.country as string) as country,
        cast(e2.country_code as string) as country_code,
        cast(e2.region as string) as region,
        cast(e2.city as string) as city,
        farm_fingerprint(
            concat(
                coalesce(cast(e2.country as string), ''),
                coalesce(cast(e2.country_code as string), ''),
                coalesce(cast(e2.region as string), ''),
                coalesce(cast(e2.city as string), '')
            )
        ) as location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join UNNEST(e1.cart_products) AS cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m06:03:40.831776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:41.997380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:ec30e316-9ab7-4eaa-abbd-397a07f58fbc&page=queryresults
[0m06:03:41.998550 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:ec30e316-9ab7-4eaa-abbd-397a07f58fbc&page=queryresults
[0m06:03:42.011486 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:03:42.013912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c874d2-d5f9-4f64-bf36-b4ff297d6611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ef441790>]}
[0m06:03:42.015008 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.24s]
[0m06:03:42.016069 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:03:42.016887 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m06:03:42.020354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:42.023122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:42.023792 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:03:42.024341 [info ] [MainThread]: 
[0m06:03:42.024916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m06:03:42.025991 [debug] [MainThread]: Command end result
[0m06:03:42.082480 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:03:42.085296 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:03:42.093405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:03:42.093973 [info ] [MainThread]: 
[0m06:03:42.094666 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:03:42.095257 [info ] [MainThread]: 
[0m06:03:42.095929 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m06:03:42.096579 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" or keyword FORMAT but got "," at [25:129]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:03:42.097124 [info ] [MainThread]: 
[0m06:03:42.097726 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m06:03:42.098256 [info ] [MainThread]: 
[0m06:03:42.098804 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m06:03:42.099685 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:03:42.101339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7699714, "process_in_blocks": "0", "process_kernel_time": 0.833546, "process_mem_max_rss": "393740", "process_out_blocks": "3528", "process_user_time": 6.548079}
[0m06:03:42.102300 [debug] [MainThread]: Command `dbt run` failed at 06:03:42.102100 after 6.77 seconds
[0m06:03:42.103111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a137cb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1051a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a13914f10>]}
[0m06:03:42.103902 [debug] [MainThread]: Flushing usage events
[0m06:03:42.268780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:04:45.792006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec43e7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec441a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec45919d0>]}


============================== 06:04:45.796413 | c20ff8e3-0dec-48c9-a7bb-e8978f92eb35 ==============================
[0m06:04:45.796413 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:04:45.797304 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_fact_orders', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m06:04:45.797953 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:04:45.798595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec4452ed0>]}
[0m06:04:49.403495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec4418fd0>]}
[0m06:04:49.495143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec6f5c950>]}
[0m06:04:49.496244 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:04:49.757617 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:04:49.965394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:04:49.966147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:04:49.975328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:04:50.036222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea45bc190>]}
[0m06:04:50.182665 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:04:50.185629 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:04:50.206156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea4760710>]}
[0m06:04:50.207045 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:04:50.207757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea4580d50>]}
[0m06:04:50.210136 [info ] [MainThread]: 
[0m06:04:50.210664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:04:50.211144 [info ] [MainThread]: 
[0m06:04:50.211912 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:04:50.214109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:04:50.215108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:04:50.702247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:04:50.703198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:04:51.150879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec615bb90>]}
[0m06:04:51.152007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:04:51.161334 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:04:51.162686 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:04:51.163892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:04:51.164744 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:04:51.185931 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:04:51.187482 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:04:51.236857 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:04:51.238168 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        CAST(e1.order_id AS STRING) AS order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0) AS price,
        CAST(cp.amount AS FLOAT64) AS amount,
        CAST(cp.currency AS STRING) AS currency,
        CAST(
            COALESCE(CAST(cp.amount AS FLOAT64), 0) *
            COALESCE(CAST(REPLACE(cp.price, ',', '.') AS FLOAT64), 0)
            AS FLOAT64
        ) AS final_amount,
        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)
select * from base;


[0m06:04:51.239052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:52.775881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:c1f1b3d3-622d-4f2a-afe7-ce2d4545f5ef&page=queryresults
[0m06:04:53.920178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20ff8e3-0dec-48c9-a7bb-e8978f92eb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea439b710>]}
[0m06:04:53.921416 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m06:04:53.922865 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:04:53.925094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:04:53.927724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:53.928617 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:04:53.929315 [info ] [MainThread]: 
[0m06:04:53.930411 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m06:04:53.931573 [debug] [MainThread]: Command end result
[0m06:04:53.988316 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:04:53.991347 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:04:54.000145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:04:54.000865 [info ] [MainThread]: 
[0m06:04:54.001793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:54.002443 [info ] [MainThread]: 
[0m06:04:54.003156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:04:54.004132 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:04:54.005595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.286604, "process_in_blocks": "0", "process_kernel_time": 0.832683, "process_mem_max_rss": "397348", "process_out_blocks": "3520", "process_user_time": 6.734219}
[0m06:04:54.006342 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:54.006173 after 8.29 seconds
[0m06:04:54.006988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec4450b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec886e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ec859b290>]}
[0m06:04:54.007710 [debug] [MainThread]: Flushing usage events
[0m06:04:54.241687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:07:52.563141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4be3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4be3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4be2b10>]}


============================== 06:07:52.567603 | d454797b-8445-4186-adc0-cc576ca2b48e ==============================
[0m06:07:52.567603 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:07:52.568524 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'version_check': 'True'}
[0m06:07:52.569148 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:07:52.569803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4d8e450>]}
[0m06:07:56.029053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5380090>]}
[0m06:07:56.116507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e7855690>]}
[0m06:07:56.117589 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:07:56.390414 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:07:56.577193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:07:56.577887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:07:56.586818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:07:56.645650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c4e73c50>]}
[0m06:07:56.783011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:07:56.785906 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:07:56.805756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5207a50>]}
[0m06:07:56.806628 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:07:56.807275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c53a9910>]}
[0m06:07:56.809738 [info ] [MainThread]: 
[0m06:07:56.810368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:07:56.810922 [info ] [MainThread]: 
[0m06:07:56.811953 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:07:56.814158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:07:56.814838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:57.286523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:07:57.287591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:57.737228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e781a2d0>]}
[0m06:07:57.738110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:07:57.746361 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:07:57.747404 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:07:57.748282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:07:57.748946 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:07:57.762426 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:07:57.763712 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:07:57.803980 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:07:57.805342 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS STRING) AS order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số: giá tiền có thể bị lỗi "8.503.00" hoặc "406,00"
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(REPLACE(cp.price, ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(REPLACE(cp.amount, ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn, không lỗi kiểu dữ liệu
        CAST(
            COALESCE(
                SAFE_CAST(
                    REGEXP_REPLACE(REPLACE(cp.amount, ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REGEXP_REPLACE(REPLACE(cp.price, ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,

        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)

select *
from base;


[0m06:07:57.806202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:58.828162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:164b820d-6b47-40b3-aa58-1857d709b8a9&page=queryresults
[0m06:07:59.106807 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:164b820d-6b47-40b3-aa58-1857d709b8a9&page=queryresults
[0m06:07:59.117282 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [35:32]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:07:59.119799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd454797b-8445-4186-adc0-cc576ca2b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c4c87290>]}
[0m06:07:59.120888 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.37s]
[0m06:07:59.121901 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:07:59.122793 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [35:32]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m06:07:59.126379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:59.129031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:59.129579 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:07:59.130125 [info ] [MainThread]: 
[0m06:07:59.130699 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m06:07:59.131791 [debug] [MainThread]: Command end result
[0m06:07:59.187120 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:07:59.189996 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:07:59.197938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:07:59.198589 [info ] [MainThread]: 
[0m06:07:59.199278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:07:59.199895 [info ] [MainThread]: 
[0m06:07:59.200534 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m06:07:59.201147 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function REPLACE
    Argument types: INT64, STRING, STRING
    Signature: REPLACE(STRING, STRING, STRING)
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: REPLACE(BYTES, BYTES, BYTES)
      Argument 1: Unable to coerce type INT64 to expected type BYTES at [35:32]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:07:59.201707 [info ] [MainThread]: 
[0m06:07:59.202330 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m06:07:59.202833 [info ] [MainThread]: 
[0m06:07:59.203419 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m06:07:59.204311 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:07:59.205876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7195454, "process_in_blocks": "0", "process_kernel_time": 0.733607, "process_mem_max_rss": "393884", "process_out_blocks": "3544", "process_user_time": 6.484397}
[0m06:07:59.206646 [debug] [MainThread]: Command `dbt run` failed at 06:07:59.206476 after 6.72 seconds
[0m06:07:59.207228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e5c23390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8fe9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e793b150>]}
[0m06:07:59.207811 [debug] [MainThread]: Flushing usage events
[0m06:07:59.401568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:09:06.154504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3d1d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3cf6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3cf6190>]}


============================== 06:09:06.159046 | 2d9af2d8-30cd-4c6d-bb79-3f9786970db0 ==============================
[0m06:09:06.159046 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:09:06.160019 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'empty': 'False', 'no_print': 'None'}
[0m06:09:06.160653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:09:06.161325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3d1ead0>]}
[0m06:09:09.583639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d43ed490>]}
[0m06:09:09.673259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f68c5650>]}
[0m06:09:09.674364 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:09:09.955242 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:09:10.149052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:09:10.149760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:09:10.158230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:09:10.219247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d423edd0>]}
[0m06:09:10.361519 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:09:10.364365 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:09:10.383685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d4280950>]}
[0m06:09:10.384532 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:09:10.385124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d3ec5010>]}
[0m06:09:10.387770 [info ] [MainThread]: 
[0m06:09:10.388491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:09:10.388980 [info ] [MainThread]: 
[0m06:09:10.389796 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:09:10.391340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:09:10.392225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:09:10.881153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:09:10.882156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:09:11.340345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d43a2ad0>]}
[0m06:09:11.341459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:09:11.411359 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:09:11.412480 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:09:11.413447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:09:11.414099 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:09:11.433430 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:09:11.434763 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:09:11.490985 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:09:11.492753 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS STRING) AS order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số (ép sang string trước khi replace)
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(REPLACE(CAST(cp.price AS STRING), ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(REPLACE(CAST(cp.amount AS STRING), ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn, không lỗi kiểu dữ liệu
        CAST(
            COALESCE(
                SAFE_CAST(
                    REGEXP_REPLACE(REPLACE(CAST(cp.amount AS STRING), ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REGEXP_REPLACE(REPLACE(CAST(cp.price AS STRING), ',', '.'), r'\.(?=.*\.)', '') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,

        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)

select *
from base;


[0m06:09:11.493957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:09:12.512614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1fefb4fe-ee91-406f-9ec5-13a306195019&page=queryresults
[0m06:09:13.131490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d9af2d8-30cd-4c6d-bb79-3f9786970db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d3cfd810>]}
[0m06:09:13.132633 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m06:09:13.133651 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:09:13.136041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:09:13.138260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:09:13.138825 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:09:13.139426 [info ] [MainThread]: 
[0m06:09:13.139971 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m06:09:13.141162 [debug] [MainThread]: Command end result
[0m06:09:13.194421 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:09:13.197280 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:09:13.205408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:09:13.206022 [info ] [MainThread]: 
[0m06:09:13.206790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:09:13.207405 [info ] [MainThread]: 
[0m06:09:13.208033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:09:13.208865 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:09:13.210404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.131003, "process_in_blocks": "0", "process_kernel_time": 0.742796, "process_mem_max_rss": "397120", "process_out_blocks": "3544", "process_user_time": 6.725312}
[0m06:09:13.211111 [debug] [MainThread]: Command `dbt run` succeeded at 06:09:13.210949 after 7.13 seconds
[0m06:09:13.211817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3cba250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f3b33350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f7f70290>]}
[0m06:09:13.212377 [debug] [MainThread]: Flushing usage events
[0m06:09:13.404488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:10:22.424302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a523550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe747b919d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe747b91a10>]}


============================== 06:10:22.428863 | 02427c96-eb85-44f3-8b67-b3d116deed1c ==============================
[0m06:10:22.428863 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:10:22.429767 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False'}
[0m06:10:22.430387 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:10:22.431033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe747a4fe50>]}
[0m06:10:25.828962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe727f0c790>]}
[0m06:10:25.915776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a55dad0>]}
[0m06:10:25.916856 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:10:26.198576 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:10:26.387436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:10:26.388106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:10:26.396605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:10:26.453729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe727d92790>]}
[0m06:10:26.590918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:10:26.593779 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:10:26.613840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe727da7610>]}
[0m06:10:26.614658 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:10:26.615267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe727dd4d50>]}
[0m06:10:26.617565 [info ] [MainThread]: 
[0m06:10:26.618163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:10:26.618684 [info ] [MainThread]: 
[0m06:10:26.619539 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:10:26.621620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:10:26.622445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:27.090677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:10:27.091566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:10:27.533747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7489e7790>]}
[0m06:10:27.534627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:10:27.542216 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:10:27.543155 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:10:27.544087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:10:27.544653 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:10:27.558842 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:10:27.559894 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:10:27.601713 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:10:27.603263 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS STRING) AS order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số an toàn: xóa dấu ngăn cách nghìn và chuẩn hóa dấu thập phân
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,

        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
)

select *
from base;


[0m06:10:27.604121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:10:28.525217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d01be874-b2b1-4005-a405-222d17ff8901&page=queryresults
[0m06:10:29.153115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02427c96-eb85-44f3-8b67-b3d116deed1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe727f0e2d0>]}
[0m06:10:29.154315 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m06:10:29.155301 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:10:29.157958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:10:29.160443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:10:29.160973 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:10:29.161458 [info ] [MainThread]: 
[0m06:10:29.162044 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m06:10:29.163229 [debug] [MainThread]: Command end result
[0m06:10:29.214826 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:10:29.217785 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:10:29.225700 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:10:29.226339 [info ] [MainThread]: 
[0m06:10:29.227108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:10:29.227696 [info ] [MainThread]: 
[0m06:10:29.228269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:10:29.229260 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:10:29.230698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8799653, "process_in_blocks": "0", "process_kernel_time": 0.746208, "process_mem_max_rss": "397980", "process_out_blocks": "3544", "process_user_time": 6.606817}
[0m06:10:29.231469 [debug] [MainThread]: Command `dbt run` succeeded at 06:10:29.231243 after 6.88 seconds
[0m06:10:29.232096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe747a4fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe747b92410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74bc5c3d0>]}
[0m06:10:29.232674 [debug] [MainThread]: Flushing usage events
[0m06:10:29.423573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:11:36.601371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb45efa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb54781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb45ef950>]}


============================== 06:11:36.606007 | 23357ad6-91a2-409d-b5be-a4e53cc0fde3 ==============================
[0m06:11:36.606007 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:11:36.606939 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'no_print': 'None', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:11:36.607599 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:11:36.608238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb46516d0>]}
[0m06:11:40.034961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94dd2850>]}
[0m06:11:40.123324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94d1a410>]}
[0m06:11:40.124441 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:11:40.397561 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:11:40.582769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:11:40.583432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:11:40.592357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:11:40.650279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94dd0b90>]}
[0m06:11:40.797333 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:11:40.801395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:11:40.864519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc947db410>]}
[0m06:11:40.865419 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:11:40.866098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94a932d0>]}
[0m06:11:40.868549 [info ] [MainThread]: 
[0m06:11:40.869171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:11:40.869678 [info ] [MainThread]: 
[0m06:11:40.870507 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:11:40.872166 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:11:40.872884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:41.419878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:11:41.420778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:41.880749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94a932d0>]}
[0m06:11:41.881664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:41.889776 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:11:41.890766 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:11:41.891718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:11:41.892315 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:11:41.906122 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:11:41.907184 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:11:41.948454 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:11:41.949727 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS STRING) AS order_id,
        COALESCE(CAST(cp.product_id AS STRING), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS STRING), '') AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số an toàn: xóa dấu ngăn cách nghìn và chuẩn hóa dấu thập phân
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal,
        CAST(e2.country AS STRING) AS country,
        CAST(e2.country_code AS STRING) AS country_code,
        CAST(e2.region AS STRING) AS region,
        CAST(e2.city AS STRING) AS city,

        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
    where e1.collection = 'checkout_success'
)

select *
from base;


[0m06:11:41.950636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:42.874259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7c52cf11-0267-4762-a2c9-17bff79bb5d0&page=queryresults
[0m06:11:43.491836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23357ad6-91a2-409d-b5be-a4e53cc0fde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94dd1e90>]}
[0m06:11:43.492979 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m06:11:43.494027 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:11:43.496330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:11:43.498635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:11:43.499200 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:11:43.499837 [info ] [MainThread]: 
[0m06:11:43.500418 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m06:11:43.501634 [debug] [MainThread]: Command end result
[0m06:11:43.553817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:11:43.556651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:11:43.565028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:11:43.565634 [info ] [MainThread]: 
[0m06:11:43.566663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:11:43.567328 [info ] [MainThread]: 
[0m06:11:43.567962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:11:43.568769 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:11:43.570218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.04321, "process_in_blocks": "0", "process_kernel_time": 0.973024, "process_mem_max_rss": "397188", "process_out_blocks": "3544", "process_user_time": 6.595004}
[0m06:11:43.570971 [debug] [MainThread]: Command `dbt run` succeeded at 06:11:43.570806 after 7.04 seconds
[0m06:11:43.571586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb46516d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb4652ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb88dc3d0>]}
[0m06:11:43.572159 [debug] [MainThread]: Flushing usage events
[0m06:11:43.754397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:15:13.773906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602dfaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602fad9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602fadd10>]}


============================== 06:15:13.778297 | 1c10541c-52d8-42d7-b040-1bc2fdb11c08 ==============================
[0m06:15:13.778297 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:15:13.779114 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_fact_orders', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False'}
[0m06:15:13.779839 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:15:13.780496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602c6f890>]}
[0m06:15:17.220373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602e35bd0>]}
[0m06:15:17.306646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06059f1bd0>]}
[0m06:15:17.307750 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:15:17.618597 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:15:17.818520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:15:17.819176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:15:17.827751 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:15:17.887018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e324cd90>]}
[0m06:15:18.047859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:15:18.052280 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:15:18.082196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e3418b10>]}
[0m06:15:18.083488 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:15:18.084396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e3448710>]}
[0m06:15:18.088087 [info ] [MainThread]: 
[0m06:15:18.088994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:15:18.089641 [info ] [MainThread]: 
[0m06:15:18.090754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:15:18.092782 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:15:18.093496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:18.580020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:15:18.580950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:19.020288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0604bd2e90>]}
[0m06:15:19.021431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:15:19.029539 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:15:19.030566 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:15:19.031462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:15:19.032068 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:15:19.046519 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:15:19.047692 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:15:19.088564 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:15:19.089907 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS int64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), '') AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), '') AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số an toàn: xóa dấu ngăn cách nghìn và chuẩn hóa dấu thập phân
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
    where e1.collection = 'checkout_success'
)

select *
from base;


[0m06:15:19.090853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:19.855853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:44c5ac4d-deb6-4cd5-8ca9-dc3af0d804c3&page=queryresults
[0m06:15:20.139311 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:44c5ac4d-deb6-4cd5-8ca9-dc3af0d804c3&page=queryresults
[0m06:15:20.150073 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: INT64, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [17:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:15:20.152602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c10541c-52d8-42d7-b040-1bc2fdb11c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e2e86150>]}
[0m06:15:20.153641 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.12s]
[0m06:15:20.154595 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:15:20.155493 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: INT64, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [17:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m06:15:20.159207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:15:20.162127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:20.162662 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:15:20.163210 [info ] [MainThread]: 
[0m06:15:20.163841 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m06:15:20.165094 [debug] [MainThread]: Command end result
[0m06:15:20.219848 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:15:20.222657 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:15:20.230838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:15:20.231491 [info ] [MainThread]: 
[0m06:15:20.232246 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:15:20.232823 [info ] [MainThread]: 
[0m06:15:20.233464 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m06:15:20.234092 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  No matching signature for function COALESCE
    Argument types: INT64, STRING
    Signature: COALESCE([T1, ...])
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [17:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m06:15:20.234639 [info ] [MainThread]: 
[0m06:15:20.235248 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m06:15:20.235836 [info ] [MainThread]: 
[0m06:15:20.236399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m06:15:20.237377 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:15:20.239052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5367904, "process_in_blocks": "0", "process_kernel_time": 0.873831, "process_mem_max_rss": "393796", "process_out_blocks": "3552", "process_user_time": 6.4685}
[0m06:15:20.240024 [debug] [MainThread]: Command `dbt run` failed at 06:15:20.239833 after 6.54 seconds
[0m06:15:20.240667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602e359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602e36310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06052258d0>]}
[0m06:15:20.241258 [debug] [MainThread]: Flushing usage events
[0m06:15:20.442133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:16:48.615050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3143d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf31d081d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf313d9a90>]}


============================== 06:16:48.619656 | ebec426c-424e-4584-80c5-f44f6423e652 ==============================
[0m06:16:48.619656 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:16:48.620581 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'empty': 'False', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None'}
[0m06:16:48.621341 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:16:48.622036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3143e250>]}
[0m06:16:52.249353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf11ba7d90>]}
[0m06:16:52.339536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf34049490>]}
[0m06:16:52.340673 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:16:52.596018 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:16:52.804336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:16:52.804976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:16:52.813738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:16:52.874025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf118452d0>]}
[0m06:16:53.020845 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:16:53.023702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:16:53.043256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf11bfa890>]}
[0m06:16:53.044159 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:16:53.044776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf11a7abd0>]}
[0m06:16:53.046977 [info ] [MainThread]: 
[0m06:16:53.047593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:16:53.048076 [info ] [MainThread]: 
[0m06:16:53.048879 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:16:53.050919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:16:53.051703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:53.531259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:16:53.532338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:16:53.978860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf331a26d0>]}
[0m06:16:53.979807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:16:53.987758 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:16:53.988804 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:16:53.989681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:16:53.990307 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:16:54.005120 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:16:54.006275 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:16:54.051232 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:16:54.052685 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        CAST(e1.order_id AS int64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số an toàn: xóa dấu ngăn cách nghìn và chuẩn hóa dấu thập phân
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
    where e1.collection = 'checkout_success'
)

select *
from base;


[0m06:16:54.053613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:54.965197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2491e23a-862e-446e-9099-6335cebc6bdc&page=queryresults
[0m06:16:55.771138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebec426c-424e-4584-80c5-f44f6423e652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1147c590>]}
[0m06:16:55.772328 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m06:16:55.773290 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:16:55.775630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:16:55.777829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:55.778292 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:16:55.778871 [info ] [MainThread]: 
[0m06:16:55.779354 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m06:16:55.780524 [debug] [MainThread]: Command end result
[0m06:16:55.835721 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:16:55.838510 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:16:55.846285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:16:55.846904 [info ] [MainThread]: 
[0m06:16:55.847733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:16:55.848301 [info ] [MainThread]: 
[0m06:16:55.848890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:16:55.849742 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:16:55.851234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.312647, "process_in_blocks": "0", "process_kernel_time": 0.952794, "process_mem_max_rss": "397984", "process_out_blocks": "3544", "process_user_time": 6.604249}
[0m06:16:55.851948 [debug] [MainThread]: Command `dbt run` succeeded at 06:16:55.851766 after 7.31 seconds
[0m06:16:55.852498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3143f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3169d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf11c98ad0>]}
[0m06:16:55.853041 [debug] [MainThread]: Flushing usage events
[0m06:16:56.060441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:22:02.950806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa991806810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa991663550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9919ae610>]}


============================== 06:22:02.955160 | 86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d ==============================
[0m06:22:02.955160 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:22:02.956045 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m stg_fact_orders', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:22:02.956700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m06:22:02.957338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9917fe010>]}
[0m06:22:06.313858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa992688e10>]}
[0m06:22:06.399716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa994419b50>]}
[0m06:22:06.400722 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m06:22:06.663886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:22:06.865332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:22:06.865983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:22:06.874600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m06:22:06.931768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa971eb0c50>]}
[0m06:22:07.083034 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:22:07.085868 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:22:07.105498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9718c9e50>]}
[0m06:22:07.106378 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m06:22:07.106998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9719ccc10>]}
[0m06:22:07.109405 [info ] [MainThread]: 
[0m06:22:07.109977 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:22:07.110499 [info ] [MainThread]: 
[0m06:22:07.111353 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:22:07.113628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m06:22:07.114365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:07.695682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m06:22:07.696524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:08.140977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa971bc4d90>]}
[0m06:22:08.141849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:08.149455 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m06:22:08.150455 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m06:22:08.151342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m06:22:08.151980 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m06:22:08.165732 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m06:22:08.166772 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m06:22:08.207601 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m06:22:08.208850 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch dữ liệu số an toàn: xóa dấu ngăn cách nghìn và chuẩn hóa dấu thập phân
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount an toàn
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    left join `project-data-engineer-469310`.`product_info`.`ip_locations` as e2
        on e1.ip = e2.ip
    where e1.collection = 'checkout_success'
)

select *
from base;


[0m06:22:08.209639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:09.138071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:35a42cbc-02c8-4421-bd48-8258ca9815a4&page=queryresults
[0m06:22:09.935015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dfc6a8-ebe5-4bf3-be83-16a2e5cb997d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9717a3ed0>]}
[0m06:22:09.936242 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m06:22:09.937195 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m06:22:09.939684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:09.941943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:09.942513 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m06:22:09.943001 [info ] [MainThread]: 
[0m06:22:09.943547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m06:22:09.944738 [debug] [MainThread]: Command end result
[0m06:22:10.002575 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m06:22:10.005417 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m06:22:10.013324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m06:22:10.013938 [info ] [MainThread]: 
[0m06:22:10.014642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:10.015171 [info ] [MainThread]: 
[0m06:22:10.015810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:22:10.016626 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m06:22:10.018056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.150736, "process_in_blocks": "0", "process_kernel_time": 0.796043, "process_mem_max_rss": "397988", "process_out_blocks": "3544", "process_user_time": 6.481152}
[0m06:22:10.018765 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:10.018612 after 7.15 seconds
[0m06:22:10.019314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9917fe250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa995cda290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97049a290>]}
[0m06:22:10.019946 [debug] [MainThread]: Flushing usage events
[0m06:22:10.221618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:50.378409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450159af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4501592690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450159b150>]}


============================== 08:56:50.384276 | dbe7f502-ecb0-4e0e-96a6-1754f990f843 ==============================
[0m08:56:50.384276 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:56:50.385242 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt ', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'cache_selected_only': 'False'}
[0m08:56:50.557297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbe7f502-ecb0-4e0e-96a6-1754f990f843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4501600110>]}
[0m08:56:50.590289 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g99b57yo'
[0m08:56:50.591084 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:56:50.750887 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:56:50.754382 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m08:56:50.903942 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m08:56:50.907301 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m08:56:50.908151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbe7f502-ecb0-4e0e-96a6-1754f990f843', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45015fa5d0>]}
[0m08:56:50.912259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m08:56:50.991894 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m08:56:50.997346 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m08:56:51.490197 [info ] [MainThread]: Installed from version 0.10.4
[0m08:56:51.490950 [info ] [MainThread]: Up to date!
[0m08:56:51.491704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dbe7f502-ecb0-4e0e-96a6-1754f990f843', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502568d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502593990>]}
[0m08:56:51.492437 [info ] [MainThread]: Installing calogica/dbt_date
[0m08:56:51.664839 [info ] [MainThread]: Installed from version 0.10.1
[0m08:56:51.665682 [info ] [MainThread]: Up to date!
[0m08:56:51.666457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dbe7f502-ecb0-4e0e-96a6-1754f990f843', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450159a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45014c6310>]}
[0m08:56:51.669322 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:56:51.671237 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3716319, "process_in_blocks": "0", "process_kernel_time": 0.417372, "process_mem_max_rss": "111252", "process_out_blocks": "20848", "process_user_time": 2.472856}
[0m08:56:51.672209 [debug] [MainThread]: Command `cli deps` succeeded at 08:56:51.671994 after 1.37 seconds
[0m08:56:51.672902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45015c9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450173d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450173d990>]}
[0m08:56:51.673698 [debug] [MainThread]: Flushing usage events
[0m08:56:51.875564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:59.817184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e743d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e743dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e73dbb90>]}


============================== 08:58:59.821671 | af544969-534d-40b7-8485-5409b125da2b ==============================
[0m08:58:59.821671 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:58:59.822643 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m08:58:59.823297 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:58:59.824024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e744c850>]}
[0m08:59:03.289183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e79c8810>]}
[0m08:59:03.376292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ea055850>]}
[0m08:59:03.377433 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m08:59:03.627349 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:59:03.814814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:03.815496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:03.824084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m08:59:03.881681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7685810>]}
[0m08:59:04.025303 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m08:59:04.028352 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m08:59:04.048234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7a88e50>]}
[0m08:59:04.049123 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m08:59:04.049734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7a88c90>]}
[0m08:59:04.052159 [info ] [MainThread]: 
[0m08:59:04.052713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:59:04.053208 [info ] [MainThread]: 
[0m08:59:04.054036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:59:04.056205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m08:59:04.057131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:04.549497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m08:59:04.550346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:05.006658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7a04450>]}
[0m08:59:05.007554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:05.015295 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m08:59:05.016331 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m08:59:05.017286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m08:59:05.017865 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m08:59:05.031691 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m08:59:05.032765 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m08:59:05.072423 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m08:59:05.073609 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e2.country AS STRING), ''),
                COALESCE(CAST(e2.country_code AS STRING), ''),
                COALESCE(CAST(e2.region AS STRING), ''),
                COALESCE(CAST(e2.city AS STRING), '')
            )
        ) AS location_id,
        cast(`country` as string) as country,
        cast(`country_code` as string) as country_code,
        cast(`region` as string) as region,
        cast(`city` as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m08:59:05.074341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:06.349895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:db293737-7336-4326-8933-43fef0bab72b&page=queryresults
[0m08:59:07.145898 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:db293737-7336-4326-8933-43fef0bab72b&page=queryresults
[0m08:59:07.157225 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: e2 at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m08:59:07.159611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af544969-534d-40b7-8485-5409b125da2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7479950>]}
[0m08:59:07.160704 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 2.14s]
[0m08:59:07.161653 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m08:59:07.162508 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: e2 at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m08:59:07.165446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:07.167823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:07.168467 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m08:59:07.169120 [info ] [MainThread]: 
[0m08:59:07.169713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m08:59:07.170805 [debug] [MainThread]: Command end result
[0m08:59:07.232494 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m08:59:07.235356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m08:59:07.243784 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m08:59:07.244431 [info ] [MainThread]: 
[0m08:59:07.245165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:59:07.245750 [info ] [MainThread]: 
[0m08:59:07.246443 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m08:59:07.247118 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Unrecognized name: e2 at [10:31]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m08:59:07.247726 [info ] [MainThread]: 
[0m08:59:07.248367 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m08:59:07.248946 [info ] [MainThread]: 
[0m08:59:07.249593 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:59:07.250504 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:59:07.252460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.512695, "process_in_blocks": "16", "process_kernel_time": 0.834127, "process_mem_max_rss": "393924", "process_out_blocks": "3536", "process_user_time": 6.413301}
[0m08:59:07.253270 [debug] [MainThread]: Command `dbt run` failed at 08:59:07.253093 after 7.51 seconds
[0m08:59:07.253895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e743e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e8259690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c7b02910>]}
[0m08:59:07.254523 [debug] [MainThread]: Flushing usage events
[0m08:59:07.467705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:29.231769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc57006410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc57006210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc543ff490>]}


============================== 08:59:29.237001 | 4641e641-2ecb-4fc5-bd3f-73322bd1f23d ==============================
[0m08:59:29.237001 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:59:29.238013 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_dim_location', 'target_path': 'None', 'use_colors': 'True'}
[0m08:59:29.238727 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:59:29.239470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc544537d0>]}
[0m08:59:32.619546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc54429a50>]}
[0m08:59:32.707525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc57025690>]}
[0m08:59:32.708758 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m08:59:32.964837 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:59:33.174177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:33.174784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:33.183445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m08:59:33.245204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc34672ed0>]}
[0m08:59:33.391195 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m08:59:33.394434 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m08:59:33.414275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc348849d0>]}
[0m08:59:33.415129 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m08:59:33.415859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc346bd310>]}
[0m08:59:33.418315 [info ] [MainThread]: 
[0m08:59:33.418975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:59:33.419571 [info ] [MainThread]: 
[0m08:59:33.420462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:59:33.422200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m08:59:33.422867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:33.918624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m08:59:33.919463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:34.371719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc34b406d0>]}
[0m08:59:34.372548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:34.380342 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m08:59:34.381270 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m08:59:34.382153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m08:59:34.382694 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m08:59:34.396704 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m08:59:34.397663 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m08:59:34.437887 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m08:59:34.439121 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(region AS STRING), ''),
                COALESCE(CAST(city AS STRING), '')
            )
        ) AS location_id,
        cast(`country` as string) as country,
        cast(`country_code` as string) as country_code,
        cast(`region` as string) as region,
        cast(`city` as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m08:59:34.439883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:35.166943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b5322a9c-e4b6-4956-8f28-bf6d8d24ae30&page=queryresults
[0m08:59:36.545139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4641e641-2ecb-4fc5-bd3f-73322bd1f23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc34a55650>]}
[0m08:59:36.546237 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m08:59:36.547189 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m08:59:36.549717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:36.552079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:36.552625 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m08:59:36.553085 [info ] [MainThread]: 
[0m08:59:36.553646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m08:59:36.554718 [debug] [MainThread]: Command end result
[0m08:59:36.606869 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m08:59:36.609819 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m08:59:36.617524 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m08:59:36.618075 [info ] [MainThread]: 
[0m08:59:36.618793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:36.619350 [info ] [MainThread]: 
[0m08:59:36.619937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:59:36.620739 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:59:36.622077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4637856, "process_in_blocks": "0", "process_kernel_time": 0.824993, "process_mem_max_rss": "397136", "process_out_blocks": "3528", "process_user_time": 6.38813}
[0m08:59:36.622716 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:36.622577 after 7.46 seconds
[0m08:59:36.623213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc54263c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc553b81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc586d8310>]}
[0m08:59:36.623783 [debug] [MainThread]: Flushing usage events
[0m08:59:36.790877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:05.288234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaa3f5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaa3f4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdab288110>]}


============================== 09:12:05.294649 | 7c05fef0-ea84-4692-9658-9d0c5cf59177 ==============================
[0m09:12:05.294649 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:05.295856 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True'}
[0m09:12:05.296748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:12:05.297586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaa457890>]}
[0m09:12:09.102073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8aa1ae10>]}
[0m09:12:09.188987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdad019850>]}
[0m09:12:09.190027 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:12:09.438758 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:12:09.629498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:09.630163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:09.638747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:12:09.695545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a8645d0>]}
[0m09:12:09.831749 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:12:09.834587 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:12:09.854448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a85d6d0>]}
[0m09:12:09.855278 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:12:09.855877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a673090>]}
[0m09:12:09.858111 [info ] [MainThread]: 
[0m09:12:09.858656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:09.859254 [info ] [MainThread]: 
[0m09:12:09.860089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:12:09.861645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m09:12:09.862504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:10.367670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m09:12:10.368469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:10.825197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a6a4410>]}
[0m09:12:10.826362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:10.835244 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m09:12:10.836645 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m09:12:10.837787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m09:12:10.838642 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m09:12:10.859724 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m09:12:10.861181 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m09:12:10.925394 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m09:12:10.927118 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,

        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Chuẩn hóa dữ liệu số
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m09:12:10.928216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:11.887515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3c8ca3fc-3db7-4217-8e36-7dd181400b83&page=queryresults
[0m09:12:12.694099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c05fef0-ea84-4692-9658-9d0c5cf59177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a4b1450>]}
[0m09:12:12.695324 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m09:12:12.696390 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m09:12:12.698634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:12.701000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:12.701601 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m09:12:12.702325 [info ] [MainThread]: 
[0m09:12:12.702989 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m09:12:12.704392 [debug] [MainThread]: Command end result
[0m09:12:12.758391 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:12:12.761200 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:12:12.769251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m09:12:12.769849 [info ] [MainThread]: 
[0m09:12:12.770548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:12.771169 [info ] [MainThread]: 
[0m09:12:12.771770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:12:12.772718 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:12:12.774104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.587091, "process_in_blocks": "5696", "process_kernel_time": 1.040607, "process_mem_max_rss": "397196", "process_out_blocks": "3536", "process_user_time": 6.51978}
[0m09:12:12.774921 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:12.774758 after 7.59 seconds
[0m09:12:12.775499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaa5a1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaa45c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdae6c42d0>]}
[0m09:12:12.776070 [debug] [MainThread]: Flushing usage events
[0m09:12:12.963217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:24.890791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2de9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2f82c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2de8b10>]}


============================== 09:16:24.895679 | f146a011-5110-43ca-bbca-8e1acff3a047 ==============================
[0m09:16:24.895679 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:16:24.896773 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/home/quakinh943/.dbt', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m09:16:28.702450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68337a450>]}
[0m09:16:28.790697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a59d5c50>]}
[0m09:16:28.807138 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:16:29.050169 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:16:29.235868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:29.236593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:29.245756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:16:29.306346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68301c990>]}
[0m09:16:29.444464 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:16:29.447586 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:16:29.452879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6830eba10>]}
[0m09:16:29.453789 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:16:29.454398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a4bc8ed0>]}
[0m09:16:29.456904 [info ] [MainThread]: 
[0m09:16:29.457575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:29.458091 [info ] [MainThread]: 
[0m09:16:29.459034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:16:29.466475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m09:16:29.467316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:29.931846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f146a011-5110-43ca-bbca-8e1acff3a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68345cd10>]}
[0m09:16:29.932703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:29.940647 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m09:16:29.941617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m09:16:29.942315 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m09:16:29.956369 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m09:16:29.957473 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m09:16:29.969535 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with 
ip_data as (
    select
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),
base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(`product_id` AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,

        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Chuẩn hóa dữ liệu số
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip
  
  limit 20

[0m09:16:29.970535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:30.901668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4e4dcc91-3cbf-4bfc-9f87-21e777ed6bbc&page=queryresults
[0m09:16:30.902700 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4e4dcc91-3cbf-4bfc-9f87-21e777ed6bbc&page=queryresults
[0m09:16:30.910732 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [24:23]
[0m09:16:30.911952 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m09:16:30.913028 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Column name product_id is ambiguous at [24:23].
[0m09:16:30.914758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:30.915730 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m09:16:30.916601 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Column name product_id is ambiguous at [24:23]
[0m09:16:30.918037 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.101463, "process_in_blocks": "4960", "process_kernel_time": 0.97361, "process_mem_max_rss": "393828", "process_out_blocks": "1816", "process_user_time": 6.400008}
[0m09:16:30.918670 [debug] [MainThread]: Command `dbt show` failed at 09:16:30.918529 after 6.10 seconds
[0m09:16:30.919263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2de27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2de2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683023a90>]}
[0m09:16:30.919856 [debug] [MainThread]: Flushing usage events
[0m09:16:31.102751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:22.799355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56312b1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56312a9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56313d69d0>]}


============================== 09:19:22.804470 | 304a04d0-ba63-470d-9918-6214ad5bc160 ==============================
[0m09:19:22.804470 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:19:22.805490 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None'}
[0m09:19:26.435188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631bea490>]}
[0m09:19:26.523330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633e45390>]}
[0m09:19:26.541682 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:19:26.802108 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:19:27.006912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:19:27.007622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:19:27.016137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:19:27.074316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56115083d0>]}
[0m09:19:27.225603 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:19:27.228711 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:19:27.233927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5611303a50>]}
[0m09:19:27.234814 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:19:27.235451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633060e90>]}
[0m09:19:27.237858 [info ] [MainThread]: 
[0m09:19:27.238418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:27.238892 [info ] [MainThread]: 
[0m09:19:27.239731 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:19:27.246149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m09:19:27.246984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.723697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304a04d0-ba63-470d-9918-6214ad5bc160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5611300e50>]}
[0m09:19:27.724435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:27.731880 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m09:19:27.732717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m09:19:27.733259 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m09:19:27.746454 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m09:19:27.747477 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m09:19:27.759318 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with 
ip_data as (
    select
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,

        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Chuẩn hóa dữ liệu số
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip
  
  limit 20

[0m09:19:27.760393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:28.884780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4da9eb8f-aed5-4f92-bc20-70caa7adfdd4&page=queryresults
[0m09:19:28.885830 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4da9eb8f-aed5-4f92-bc20-70caa7adfdd4&page=queryresults
[0m09:19:28.893223 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name ip not found inside e2 at [86:26]
[0m09:19:28.894418 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m09:19:28.895359 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Name ip not found inside e2 at [86:26].
[0m09:19:28.896957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:28.897758 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m09:19:28.898675 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Name ip not found inside e2 at [86:26]
[0m09:19:28.900081 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.1755476, "process_in_blocks": "0", "process_kernel_time": 1.019233, "process_mem_max_rss": "394156", "process_out_blocks": "1816", "process_user_time": 6.192589}
[0m09:19:28.900833 [debug] [MainThread]: Command `dbt show` failed at 09:19:28.900639 after 6.18 seconds
[0m09:19:28.901419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631442b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561151eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563545f350>]}
[0m09:19:28.902068 [debug] [MainThread]: Flushing usage events
[0m09:19:29.126593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:37.560991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fc9ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fc95a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fc96210>]}


============================== 09:20:37.565713 | 6736cf53-a86b-4038-bb48-4866adfcb1d8 ==============================
[0m09:20:37.565713 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:20:37.566671 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'empty': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True'}
[0m09:20:41.269734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fcab650>]}
[0m09:20:41.358731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5228c9390>]}
[0m09:20:41.376618 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:20:41.632667 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:20:41.836240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:20:41.836898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:20:41.847255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:20:41.906586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ffd25b90>]}
[0m09:20:42.052368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:20:42.055203 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:20:42.060172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ffc74110>]}
[0m09:20:42.060991 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:20:42.061638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ffc53f90>]}
[0m09:20:42.063883 [info ] [MainThread]: 
[0m09:20:42.064482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:42.064993 [info ] [MainThread]: 
[0m09:20:42.065843 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:20:42.072678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m09:20:42.073510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:42.557186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6736cf53-a86b-4038-bb48-4866adfcb1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ffcb4990>]}
[0m09:20:42.557990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:42.564505 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m09:20:42.565397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m09:20:42.566057 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m09:20:42.579417 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m09:20:42.580548 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m09:20:42.592216 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with 
ip_data as (
    select
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,

        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Chuẩn hóa dữ liệu số
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
  
  limit 20

[0m09:20:42.593149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:43.690854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7a22e751-b406-47c1-9b09-6e3a4d11cbb9&page=queryresults
[0m09:20:43.691930 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7a22e751-b406-47c1-9b09-6e3a4d11cbb9&page=queryresults
[0m09:20:43.698855 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unrecognized name: e2 at [78:22]
[0m09:20:43.700197 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m09:20:43.701153 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Unrecognized name: e2 at [78:22].
[0m09:20:43.702587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:43.703138 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m09:20:43.704073 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
    Unrecognized name: e2 at [78:22]
[0m09:20:43.705729 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 6.218064, "process_in_blocks": "0", "process_kernel_time": 1.053109, "process_mem_max_rss": "392060", "process_out_blocks": "1816", "process_user_time": 6.182467}
[0m09:20:43.706420 [debug] [MainThread]: Command `dbt show` failed at 09:20:43.706255 after 6.22 seconds
[0m09:20:43.706983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fd08a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fd0b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51fc9fe50>]}
[0m09:20:43.707608 [debug] [MainThread]: Flushing usage events
[0m09:20:43.890088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:44.444422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbe53ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbe417390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbe4174d0>]}


============================== 09:21:44.449200 | 8869537e-7a09-4184-b1ff-370dda6e09da ==============================
[0m09:21:44.449200 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:21:44.450172 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt show --select stg_fact_orders --limit 20', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'None', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False'}
[0m09:21:47.791183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9ea31990>]}
[0m09:21:47.876686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc1005950>]}
[0m09:21:47.892296 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:21:48.153770 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:21:48.347766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:48.348444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:48.357466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:21:48.418003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9e559e50>]}
[0m09:21:48.562753 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:21:48.565703 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:21:48.570969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9e52b050>]}
[0m09:21:48.571857 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:21:48.572504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc0024f50>]}
[0m09:21:48.574785 [info ] [MainThread]: 
[0m09:21:48.575403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:21:48.575956 [info ] [MainThread]: 
[0m09:21:48.576843 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:21:48.583656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m09:21:48.584417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:49.061293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8869537e-7a09-4184-b1ff-370dda6e09da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9e51e790>]}
[0m09:21:49.062105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:49.069741 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m09:21:49.070705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m09:21:49.071332 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m09:21:49.084835 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m09:21:49.085907 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m09:21:49.097852 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */

  
  with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,

        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,

        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Chuẩn hóa dữ liệu số
        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS price,

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ Tính final_amount
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip
  
  limit 20

[0m09:21:49.098822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:51.105404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1fd133c6-ed14-4a9b-91ea-ba3d39a9bf2f&page=queryresults
[0m09:21:52.601466 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m09:21:52.603864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:52.604507 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m09:21:52.605509 [debug] [MainThread]: Command end result
[0m09:21:52.657553 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:21:52.660396 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:21:52.669386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m09:21:52.670372 [info ] [MainThread]: Previewing node 'stg_fact_orders':
|             event_id |   order_id | product_id | raw_device_id        | date_id | store_id | ... |
| -------------------- | ---------- | ---------- | -------------------- | ------- | -------- | --- |
|  -537657231171609409 | 1452040490 |      98785 | 2661a514-7890-4b1... | 4212020 |       14 | ... |
| -7518714828824045925 |  720249518 |      96442 | f1bcab82-0436-4c7... | 5062020 |        7 | ... |
|  1581331687316634752 |  720249518 |     109814 | f1bcab82-0436-4c7... | 5062020 |        7 | ... |
| -1018956458694332491 | 1072033583 |      91092 | 1ba98eaa-37d7-46e... | 5112020 |       10 | ... |
| -4116545122325300736 |  620293397 |     109936 | 4c18528f-60e0-405... | 5082020 |        6 | ... |
| -8759341004648155524 |  620293397 |      90931 | 4c18528f-60e0-405... | 5082020 |        6 | ... |
|  6274444379629047816 | 6004509956 |      92296 | 58d4361c-d2ab-400... | 4282020 |       60 | ... |
|  -752311460885352175 | 4162047092 |     102856 | a2fb43a1-eb93-4f8... | 4222020 |       41 | ... |
|  5817529027141324753 | 1452040336 |     103896 | 64641593-8d48-410... | 4162020 |       14 | ... |
| -7300497806497148586 | 4162048348 |      84783 | a9c630d1-f20b-430... | 5152020 |       41 | ... |
|  8901065798061426625 | 1072033052 |      91092 | a10f8d16-4217-490... | 4262020 |       10 | ... |
|  7972781616565842212 | 4162047576 |     109127 | 272d572a-445e-43c... | 5022020 |       41 | ... |
|  4963264970998154470 | 8501021486 |      94244 | 5b9048fb-0bb0-4cf... | 4272020 |       85 | ... |
| -7212943269247387215 |  720248186 |      92261 | 05e79b8a-44f0-48b... | 4142020 |        7 | ... |
| -4320942019529758658 | 1250090069 |      90475 | d8c52f08-d7b7-4fc... | 5242020 |       12 | ... |
|  5917737363132402659 | 3451007508 |      86703 | e4cd9c63-2ced-435... | 5242020 |       34 | ... |
|  5674780245083661346 | 1250089407 |     104331 | b02cad69-d74b-43c... | 5102020 |       12 | ... |
|  3179345098462357689 | 1250089407 |      92280 | b02cad69-d74b-43c... | 5102020 |       12 | ... |
| -5724774819852512502 |  620294484 |      92790 | 45f2ca85-c4d1-43b... | 5172020 |        6 | ... |
|  -445457743717610831 | 1350071714 |      90733 | 3b2f1b0d-f1d8-49d... | 5312020 |       13 | ... |

[0m09:21:52.672001 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 8.301171, "process_in_blocks": "0", "process_kernel_time": 0.779409, "process_mem_max_rss": "397852", "process_out_blocks": "3536", "process_user_time": 6.26776}
[0m09:21:52.672723 [debug] [MainThread]: Command `dbt show` succeeded at 09:21:52.672562 after 8.30 seconds
[0m09:21:52.673298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc26b8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc2740f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc2740950>]}
[0m09:21:52.673900 [debug] [MainThread]: Flushing usage events
[0m09:21:52.902841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:42.938137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f212ecf85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f212ed236d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f212ed22790>]}


============================== 09:32:42.945991 | cd03b878-f7c3-4513-a7cf-fe139929f5d7 ==============================
[0m09:32:42.945991 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:32:42.947062 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt show --select stg_dim_device --limit 20', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:48.950595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210f22b190>]}
[0m09:32:49.042759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2131859610>]}
[0m09:32:49.064124 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m09:32:49.328959 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:32:49.537985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:32:49.538652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:32:49.547512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m09:32:49.606258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210ef00090>]}
[0m09:32:49.746046 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:32:49.749282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:32:49.754576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210ec9c1d0>]}
[0m09:32:49.755477 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m09:32:49.756105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2130a6d250>]}
[0m09:32:49.758653 [info ] [MainThread]: 
[0m09:32:49.759244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:32:49.759803 [info ] [MainThread]: 
[0m09:32:49.760789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:32:49.767518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m09:32:49.768268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:50.295145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd03b878-f7c3-4513-a7cf-fe139929f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210ecdb450>]}
[0m09:32:50.296049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:50.304504 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_device
[0m09:32:50.305463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_device)
[0m09:32:50.306071 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_device
[0m09:32:50.324748 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m09:32:50.326129 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_device
[0m09:32:50.341024 [debug] [Thread-1 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */

  
  with device as (
    select distinct
        farm_fingerprint(
            concat(
                coalesce(device_id, ''),
                coalesce(user_agent, ''),
                coalesce(resolution, '')
            )
        ) as device_id,

        cast(device_id as string) as raw_device_id,
        cast(resolution as string) as resolution,
        cast(user_agent as string) as user_agent,

        -- detect os
        case
            when regexp_contains(`user_agent`, r'Windows NT [0-9._]+') 
                then regexp_extract(`user_agent`, r'Windows NT [0-9._]+')
            when regexp_contains(`user_agent`, r'Android\s+[0-9._]+') 
                then regexp_extract(`user_agent`, r'Android\s+[0-9._]+')
            when regexp_contains(`user_agent`, r'iPhone OS [0-9_]+') 
                then replace(regexp_extract(`user_agent`, r'iPhone OS [0-9_]+'), '_', '.')
            when regexp_contains(`user_agent`, r'Mac OS X [0-9_]+') 
                then replace(regexp_extract(`user_agent`, r'Mac OS X [0-9_]+'), '_', '.')
            when regexp_contains(`user_agent`, r'Linux') then 'Linux'
            else 'Other'
        end as os,

        -- detect device model
        case
            when regexp_contains(`user_agent`, r'SM-[^;\)]+') 
                then regexp_extract(`user_agent`, r'SM-[^;\)]+')
            when regexp_contains(`user_agent`, r'LG-[^;\)]+') 
                then regexp_extract(`user_agent`, r'LG-[^;\)]+')
            when regexp_contains(`user_agent`, r'MI [^;\)]+') 
                then regexp_extract(`user_agent`, r'MI [^;\)]+')
            when regexp_contains(`user_agent`, r'Windows') 
                then 'PC Windows'
            when regexp_contains(`user_agent`, r'Macintosh') then 'Mac'
            when regexp_contains(`user_agent`, r'iPhone') then 'iPhone'
            when regexp_contains(`user_agent`, r'iPad') then 'iPad'
            else 'Unknown'
        end as device_model,

        -- device type
        case 
            when regexp_contains(`user_agent`, r'Mobile') then 'Mobile'
            when regexp_contains(`user_agent`, r'Tablet') then 'Tablet'
            else 'Desktop'
        end as device_type

    from `project-data-engineer-469310`.`product_info`.`event`
)
select * from device
  
  limit 20

[0m09:32:50.342429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:52.325807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:72ea439f-1d88-4e26-a58f-77e408d87e21&page=queryresults
[0m09:32:53.448932 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_device
[0m09:32:53.450701 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a
[0m09:32:53.451705 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a'
[0m09:32:53.452432 [debug] [Thread-4 (]: Began running node test.glramira.not_null_stg_dim_device_device_id.d6c84030cf
[0m09:32:53.453090 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a
[0m09:32:53.453738 [debug] [Thread-2 (]: Began running node test.glramira.unique_stg_dim_device_device_id.77df63ae14
[0m09:32:53.454680 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.not_null_stg_dim_device_device_id.d6c84030cf'
[0m09:32:53.477492 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.unique_stg_dim_device_device_id.77df63ae14'
[0m09:32:53.479490 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a"
[0m09:32:53.480399 [debug] [Thread-4 (]: Began compiling node test.glramira.not_null_stg_dim_device_device_id.d6c84030cf
[0m09:32:53.481144 [debug] [Thread-2 (]: Began compiling node test.glramira.unique_stg_dim_device_device_id.77df63ae14
[0m09:32:53.495355 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.not_null_stg_dim_device_device_id.d6c84030cf"
[0m09:32:53.501481 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a
[0m09:32:53.506308 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.unique_stg_dim_device_device_id.77df63ae14"
[0m09:32:53.512732 [debug] [Thread-4 (]: Began executing node test.glramira.not_null_stg_dim_device_device_id.d6c84030cf
[0m09:32:53.515661 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a"} */

  
  




    with grouped_expression as (
    select
        
        
    
  user_agent is not null as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  limit 20

[0m09:32:53.526721 [debug] [Thread-4 (]: On test.glramira.not_null_stg_dim_device_device_id.d6c84030cf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_stg_dim_device_device_id.d6c84030cf"} */

  
  
    
    



select device_id
from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
where device_id is null



  
  limit 20

[0m09:32:53.527865 [debug] [Thread-2 (]: Began executing node test.glramira.unique_stg_dim_device_device_id.77df63ae14
[0m09:32:53.528735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:32:53.529439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:32:53.536112 [debug] [Thread-2 (]: On test.glramira.unique_stg_dim_device_device_id.77df63ae14: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_stg_dim_device_device_id.77df63ae14"} */

  
  
    
    

with dbt_test__target as (

  select device_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  where device_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 20

[0m09:32:53.575523 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:32:55.265948 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:12878e4e-4962-4d3c-8062-377a1b715239&page=queryresults
[0m09:32:55.404671 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:2497b8e9-8ef7-4544-8885-9fb02159192b&page=queryresults
[0m09:32:55.939683 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0e7feaed-b80d-4704-a7b4-89aaa5856808&page=queryresults
[0m09:32:56.159806 [debug] [Thread-4 (]: Finished running node test.glramira.not_null_stg_dim_device_device_id.d6c84030cf
[0m09:32:56.279105 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a
[0m09:32:57.608601 [debug] [Thread-2 (]: Finished running node test.glramira.unique_stg_dim_device_device_id.77df63ae14
[0m09:32:57.610863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:57.611560 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m09:32:57.612081 [debug] [MainThread]: Connection 'test.glramira.dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent.b22db3350a' was properly closed.
[0m09:32:57.612571 [debug] [MainThread]: Connection 'test.glramira.not_null_stg_dim_device_device_id.d6c84030cf' was properly closed.
[0m09:32:57.613032 [debug] [MainThread]: Connection 'test.glramira.unique_stg_dim_device_device_id.77df63ae14' was properly closed.
[0m09:32:57.614550 [debug] [MainThread]: Command end result
[0m09:32:57.676004 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m09:32:57.679160 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m09:32:57.688970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m09:32:57.689666 [debug] [MainThread]: Excluded node 'not_null_stg_dim_device_device_id' from results
[0m09:32:57.690188 [debug] [MainThread]: Excluded node 'dbt_expectations_expect_column_values_to_not_be_null_stg_dim_device_user_agent' from results
[0m09:32:57.690688 [debug] [MainThread]: Excluded node 'unique_stg_dim_device_device_id' from results
[0m09:32:57.691632 [info ] [MainThread]: Previewing node 'stg_dim_device':
|            device_id | raw_device_id        | resolution | user_agent           | os               | device_model         | ... |
| -------------------- | -------------------- | ---------- | -------------------- | ---------------- | -------------------- | --- |
|  2046263439243653058 | e54d95ad-d52e-42e... | 360x640    | Mozilla/5.0 (Linu... | Android 8.0.0    | SM-G930F Build/R16NW | ... |
|  8825889788156402419 | f1f10d6d-3d69-44e... | 412x846    | Mozilla/5.0 (Linu... | Android 10       | SM-N960U             | ... |
| -1995297620445487323 | 0bc8d61f-334b-476... | 375x812    | Mozilla/5.0 (iPho... | iPhone OS 13.3.1 | iPhone               | ... |
| -3864432315664294049 | 4d830da5-b243-411... | 375x667    | Mozilla/5.0 (iPho... | iPhone OS 11.2.2 | iPhone               | ... |
|  4385748782058501701 | 5740a509-58ed-4c4... | 360x740    | Mozilla/5.0 (Linu... | Android 10       | SM-G960F Build/QP... | ... |
|   664341916437048019 | d2fb5175-fa54-4c3... | 1920x1080  | Mozilla/5.0 (Wind... | Windows NT 10.0  | PC Windows           | ... |
| -6283033899741076109 | 2eb3c74c-deeb-464... | 360x640    | Mozilla/5.0 (Linu... | Android 8.1.0    | SM-J260F Build/M1AJB | ... |
|  7153964198824156431 | 4b3b8c53-6c53-401... | 375x667    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
|  5309252800698246242 | 7dd68e05-e2fe-498... | 414x896    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
| -3145379171507541533 | a90933da-2173-4f5... | 360x740    | Mozilla/5.0 (Linu... | Android 10       | SM-G960F             | ... |
|  4249543119629294688 | 770ee180-5ed8-4ff... | 412x869    | Mozilla/5.0 (Linu... | Android 9        | SM-A105FN Build/P... | ... |
| -1192250897891253685 | 1c8f01cd-3eac-40b... | 375x812    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
|  9197483308832838190 | 664ea56f-be33-4cb... | 360x720    | Mozilla/5.0 (Linu... | Android 8.1.0    | Unknown              | ... |
| -5466118434276596066 | f8afe13d-7254-4af... | 320x570    | Mozilla/5.0 (Linu... | Android 8.1.0    | Unknown              | ... |
| -7146019825792214115 | 7897cdde-0a8d-472... | 869x412    | Mozilla/5.0 (Linu... | Android 10       | SM-G975F             | ... |
| -5837705076214972629 | 94505a3f-7183-4f1... | 375x812    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
|  9180049758223079258 | 9754872e-9094-4ff... | 375x667    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
|  4688600377293446996 | 5cf6865a-9fbd-454... | 414x736    | Mozilla/5.0 (iPho... | iPhone OS 13.4.1 | iPhone               | ... |
|  9114325869180148407 | bffa3b6c-dedf-49c... | 360x640    | Mozilla/5.0 (Linu... | Android 8.0.0    | SM-G930F             | ... |
|  2345809813466009092 | 7a52de68-c1b2-4de... | 360x760    | Mozilla/5.0 (Linu... | Android 9        | Unknown              | ... |

[0m09:32:57.693556 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 14.836875, "process_in_blocks": "66832", "process_kernel_time": 2.175304, "process_mem_max_rss": "404164", "process_out_blocks": "3592", "process_user_time": 8.178757}
[0m09:32:57.694271 [debug] [MainThread]: Command `dbt show` succeeded at 09:32:57.694110 after 14.84 seconds
[0m09:32:57.694826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f212eb37650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f212eb37e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2132f24450>]}
[0m09:32:57.695547 [debug] [MainThread]: Flushing usage events
[0m09:32:57.914939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:05.428585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc427fa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4292aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4541b3d0>]}


============================== 11:40:05.440502 | 136d09c0-9345-44fe-87d8-67efd0c10648 ==============================
[0m11:40:05.440502 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:40:05.441497 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_fact_orders', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:40:05.442178 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m11:40:05.442808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4266de10>]}
[0m11:40:11.859733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc42dc2ad0>]}
[0m11:40:11.949588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc45455710>]}
[0m11:40:11.950766 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:40:12.218129 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:40:12.431316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:12.432065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:12.440913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m11:40:12.500568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc22fa92d0>]}
[0m11:40:12.648226 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:40:12.651783 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:40:12.699694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc22aa21d0>]}
[0m11:40:12.700683 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m11:40:12.701351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc22ec9b10>]}
[0m11:40:12.703642 [info ] [MainThread]: 
[0m11:40:12.704256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:12.704770 [info ] [MainThread]: 
[0m11:40:12.705594 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:40:12.707333 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m11:40:12.708102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:13.233623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m11:40:13.234518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:13.694675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc22e6d310>]}
[0m11:40:13.695573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:13.704375 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m11:40:13.705335 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m11:40:13.706164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m11:40:13.706764 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m11:40:13.720429 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m11:40:13.724175 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m11:40:13.765646 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m11:40:13.769422 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),
base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS int64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,

        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS int64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS FLOAT64
            ) AS price

        COALESCE(
            SAFE_CAST(
                REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
            ),
            0
        ) AS amount,
        CAST(cp.currency AS STRING) AS currency,
        CAST(
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.amount AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            ) *
            COALESCE(
                SAFE_CAST(
                    REPLACE(REPLACE(CAST(cp.price AS STRING), '.', ''), ',', '.') AS FLOAT64
                ),
                0
            )
            AS FLOAT64
        ) AS final_amount,
        CAST(e1.is_paypal AS STRING) AS is_paypal
    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)
select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m11:40:13.770372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:14.918048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:cde224ff-8ce7-4110-add3-c4dd672c04aa&page=queryresults
[0m11:40:14.919189 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:cde224ff-8ce7-4110-add3-c4dd672c04aa&page=queryresults
[0m11:40:14.943360 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got identifier "COALESCE" at [40:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m11:40:14.946683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136d09c0-9345-44fe-87d8-67efd0c10648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc22870290>]}
[0m11:40:14.948135 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.24s]
[0m11:40:14.949114 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m11:40:14.950026 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got identifier "COALESCE" at [40:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m11:40:14.953204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:14.955608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:14.956168 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m11:40:14.956745 [info ] [MainThread]: 
[0m11:40:14.957316 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m11:40:14.958305 [debug] [MainThread]: Command end result
[0m11:40:15.012850 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:40:15.015727 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:40:15.023902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m11:40:15.024522 [info ] [MainThread]: 
[0m11:40:15.025244 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:40:15.025815 [info ] [MainThread]: 
[0m11:40:15.026508 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m11:40:15.027179 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Syntax error: Expected ")" but got identifier "COALESCE" at [40:9]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m11:40:15.027724 [info ] [MainThread]: 
[0m11:40:15.028399 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m11:40:15.028899 [info ] [MainThread]: 
[0m11:40:15.029487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:40:15.030358 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:40:15.032779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.68871, "process_in_blocks": "233048", "process_kernel_time": 2.122864, "process_mem_max_rss": "393104", "process_out_blocks": "3528", "process_user_time": 7.178721}
[0m11:40:15.033513 [debug] [MainThread]: Command `dbt run` failed at 11:40:15.033344 after 9.69 seconds
[0m11:40:15.034096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4266de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4266fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc46ba5110>]}
[0m11:40:15.034640 [debug] [MainThread]: Flushing usage events
[0m11:40:15.206615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:07.788961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe3f9f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe4146190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe4145d90>]}


============================== 11:42:07.793629 | e3c8b0ea-99c5-44c4-949f-52e857d6c3a2 ==============================
[0m11:42:07.793629 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:42:07.794503 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -m stg_fact_orders', 'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False'}
[0m11:42:07.795085 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m11:42:07.795757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe3fda610>]}
[0m11:42:11.365439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe3fbd490>]}
[0m11:42:11.452518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe6b60a50>]}
[0m11:42:11.453567 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:42:11.701981 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:42:11.894372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:11.895059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:11.903430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m11:42:11.959230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc4379090>]}
[0m11:42:12.147165 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:42:12.157706 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:42:12.183946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc4511a10>]}
[0m11:42:12.184833 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m11:42:12.185437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc4383710>]}
[0m11:42:12.187860 [info ] [MainThread]: 
[0m11:42:12.188429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:42:12.188951 [info ] [MainThread]: 
[0m11:42:12.189769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:12.191868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m11:42:12.192538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:12.746843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m11:42:12.747719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:13.194496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe3e84910>]}
[0m11:42:13.195297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:13.202112 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m11:42:13.203078 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m11:42:13.203982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m11:42:13.204549 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m11:42:13.218463 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m11:42:13.219566 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m11:42:13.259398 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m11:42:13.260696 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch giá: bỏ .00, ký tự, currency → giữ lại số thuần
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS FLOAT64
        ) AS price,

        -- ✅ Làm sạch amount tương tự
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS FLOAT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ final_amount = price * amount (chuẩn hoá)
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS FLOAT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS FLOAT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m11:42:13.261554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:14.510636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:af52f92b-e9d4-4595-a19c-0226f721e89b&page=queryresults
[0m11:42:15.669918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c8b0ea-99c5-44c4-949f-52e857d6c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc418db50>]}
[0m11:42:15.671208 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m11:42:15.672381 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m11:42:15.674753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:15.677050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:15.677673 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m11:42:15.678220 [info ] [MainThread]: 
[0m11:42:15.678818 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m11:42:15.679939 [debug] [MainThread]: Command end result
[0m11:42:15.735024 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:42:15.737768 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:42:15.745651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m11:42:15.746188 [info ] [MainThread]: 
[0m11:42:15.746943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:15.747487 [info ] [MainThread]: 
[0m11:42:15.748050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:42:15.748865 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:42:15.750260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.033775, "process_in_blocks": "200", "process_kernel_time": 0.951043, "process_mem_max_rss": "396920", "process_out_blocks": "3528", "process_user_time": 6.544379}
[0m11:42:15.750980 [debug] [MainThread]: Command `dbt run` succeeded at 11:42:15.750826 after 8.03 seconds
[0m11:42:15.751591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe4254a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe4145d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe8208290>]}
[0m11:42:15.752167 [debug] [MainThread]: Flushing usage events
[0m11:42:15.967761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:41.539780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6417e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea65c1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6272d10>]}


============================== 11:45:41.544695 | 34e206c0-e081-4453-bd8f-32c0f18cf437 ==============================
[0m11:45:41.544695 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:45:41.545619 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'invocation_command': 'dbt run -m stg_fact_orders', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:45:41.546231 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m11:45:41.546877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea627cc90>]}
[0m11:45:45.112308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6449d90>]}
[0m11:45:45.202345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea9005b90>]}
[0m11:45:45.203521 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:45:45.459127 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:45:45.666818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:45.667497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:45.676171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m11:45:45.737023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e868c5190>]}
[0m11:45:45.884728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:45:45.888066 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:45:45.909633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e865a8810>]}
[0m11:45:45.910583 [info ] [MainThread]: Found 10 models, 15 data tests, 3 sources, 762 macros
[0m11:45:45.911341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e868d3390>]}
[0m11:45:45.913717 [info ] [MainThread]: 
[0m11:45:45.914367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:45:45.914930 [info ] [MainThread]: 
[0m11:45:45.915930 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:45:45.917726 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m11:45:45.918684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:46.406008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m11:45:46.407090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:46.864799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e86b506d0>]}
[0m11:45:46.865690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:46.872862 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m11:45:46.873755 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m11:45:46.874612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m11:45:46.875166 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m11:45:46.889509 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m11:45:46.890617 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m11:45:46.931301 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m11:45:46.932632 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch giá: bỏ .00, ký tự, currency → giữ lại số thuần
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS FLOAT64
        ) AS price,

        -- ✅ Làm sạch amount tương tự
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ final_amount = price * amount (chuẩn hoá)
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT6464
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m11:45:46.933531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:47.709276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7ddaf5b6-863c-4b6b-a98c-b2cb29cbbcb0&page=queryresults
[0m11:45:47.986189 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7ddaf5b6-863c-4b6b-a98c-b2cb29cbbcb0&page=queryresults
[0m11:45:47.996880 [debug] [Thread-1 (]: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Type not found: INT6464 at [69:22]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m11:45:47.999437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e206c0-e081-4453-bd8f-32c0f18cf437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e86488f50>]}
[0m11:45:48.000562 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_fact_orders .............. [[31mERROR[0m in 1.12s]
[0m11:45:48.001585 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m11:45:48.002528 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Type not found: INT6464 at [69:22]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql.
[0m11:45:48.005712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:48.008261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:48.008855 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m11:45:48.009411 [info ] [MainThread]: 
[0m11:45:48.009977 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m11:45:48.011012 [debug] [MainThread]: Command end result
[0m11:45:48.068387 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:45:48.071147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:45:48.080508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m11:45:48.081070 [info ] [MainThread]: 
[0m11:45:48.081673 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:45:48.082226 [info ] [MainThread]: 
[0m11:45:48.082844 [error] [MainThread]: [31mFailure in model stg_fact_orders (models/staging/stg_fact_orders.sql)[0m
[0m11:45:48.083465 [error] [MainThread]:   Database Error in model stg_fact_orders (models/staging/stg_fact_orders.sql)
  Type not found: INT6464 at [69:22]
  compiled code at target/run/glramira/models/staging/stg_fact_orders.sql
[0m11:45:48.083938 [info ] [MainThread]: 
[0m11:45:48.084531 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_fact_orders.sql
[0m11:45:48.084989 [info ] [MainThread]: 
[0m11:45:48.085530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:45:48.086312 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:45:48.087735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.6237516, "process_in_blocks": "0", "process_kernel_time": 0.86607, "process_mem_max_rss": "393328", "process_out_blocks": "3528", "process_user_time": 6.545901}
[0m11:45:48.088589 [debug] [MainThread]: Command `dbt run` failed at 11:45:48.088389 after 6.62 seconds
[0m11:45:48.089221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea65c1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8630efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea90eb7d0>]}
[0m11:45:48.089813 [debug] [MainThread]: Flushing usage events
[0m11:45:48.291130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:18.192550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0c4c7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0c4c5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0c671a10>]}


============================== 11:46:18.197209 | fc1ca0be-2255-4699-a03d-b3fd6b77e149 ==============================
[0m11:46:18.197209 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:46:18.198326 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error': 'None', 'invocation_command': 'dbt run -m stg_fact_orders', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m11:46:18.199065 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m11:46:18.199810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0c4fa390>]}
[0m11:46:21.652352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0c505490>]}
[0m11:46:21.741110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0f041390>]}
[0m11:46:21.742279 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:46:22.041162 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:46:22.225735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:22.226419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:22.234606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m11:46:22.291796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabeca58650>]}
[0m11:46:22.427844 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:46:22.430945 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:46:22.450775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d51f7d0>]}
[0m11:46:22.451681 [info ] [MainThread]: Found 8 models, 15 data tests, 3 sources, 762 macros
[0m11:46:22.452321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d4765d0>]}
[0m11:46:22.454501 [info ] [MainThread]: 
[0m11:46:22.455114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:22.455654 [info ] [MainThread]: 
[0m11:46:22.456509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:46:22.458657 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m11:46:22.459566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:22.938283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m11:46:22.939251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:23.385107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d4765d0>]}
[0m11:46:23.385962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:23.392824 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m11:46:23.393729 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m11:46:23.394538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m11:46:23.395102 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m11:46:23.408727 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m11:46:23.409779 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m11:46:23.450316 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m11:46:23.451640 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch giá: bỏ .00, ký tự, currency → giữ lại số thuần
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS FLOAT64
        ) AS price,

        -- ✅ Làm sạch amount tương tự
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ final_amount = price * amount (chuẩn hoá)
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m11:46:23.452563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:24.182667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:66e45c44-a102-45c1-9ece-3672c226429e&page=queryresults
[0m11:46:25.270049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1ca0be-2255-4699-a03d-b3fd6b77e149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabeca1a410>]}
[0m11:46:25.271182 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m11:46:25.272123 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m11:46:25.274520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:25.276798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:25.277399 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m11:46:25.278069 [info ] [MainThread]: 
[0m11:46:25.278633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m11:46:25.279657 [debug] [MainThread]: Command end result
[0m11:46:25.341116 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:46:25.344066 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:46:25.353352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m11:46:25.353940 [info ] [MainThread]: 
[0m11:46:25.354601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:25.355102 [info ] [MainThread]: 
[0m11:46:25.355706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:46:25.356666 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:46:25.358557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.240478, "process_in_blocks": "0", "process_kernel_time": 0.792216, "process_mem_max_rss": "396912", "process_out_blocks": "3504", "process_user_time": 6.571844}
[0m11:46:25.359587 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:25.359187 after 7.24 seconds
[0m11:46:25.360387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac107643d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac106a32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac106a3310>]}
[0m11:46:25.361295 [debug] [MainThread]: Flushing usage events
[0m11:46:25.526481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:37.126899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37924bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792062290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37921f9dd0>]}


============================== 11:47:37.131893 | 52e97f95-dbe9-488b-9add-10052b5f81c4 ==============================
[0m11:47:37.131893 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:47:37.133326 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_fact_orders', 'profiles_dir': '/home/quakinh943/.dbt', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False'}
[0m11:47:37.134028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m11:47:37.134744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37924b1d90>]}
[0m11:47:40.642097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377281afd0>]}
[0m11:47:40.728007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37729a2410>]}
[0m11:47:40.729064 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:47:40.999766 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:47:41.193858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:41.194512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:41.203105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m11:47:41.259679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37726ef4d0>]}
[0m11:47:41.397414 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:47:41.400522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:47:41.419965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377265c150>]}
[0m11:47:41.420849 [info ] [MainThread]: Found 8 models, 15 data tests, 3 sources, 762 macros
[0m11:47:41.421470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37924bc710>]}
[0m11:47:41.423715 [info ] [MainThread]: 
[0m11:47:41.424286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:47:41.424766 [info ] [MainThread]: 
[0m11:47:41.425592 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:41.427014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m11:47:41.427670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:41.904830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m11:47:41.905693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:42.357550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37723936d0>]}
[0m11:47:42.358444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:42.366288 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m11:47:42.367229 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m11:47:42.368122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m11:47:42.368673 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m11:47:42.382683 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m11:47:42.383752 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m11:47:42.423911 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m11:47:42.425259 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),

base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,

        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,

        -- ✅ Làm sạch giá: bỏ .00, ký tự, currency → giữ lại số thuần
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,

        -- ✅ Làm sạch amount tương tự
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,

        -- ✅ final_amount = price * amount (chuẩn hoá)
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id
from base b
left join ip_data e2
    on b.ip_address = e2.ip;


[0m11:47:42.426119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:43.344696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d48eb0ca-9517-4b00-89d0-4059d229ad26&page=queryresults
[0m11:47:44.142813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e97f95-dbe9-488b-9add-10052b5f81c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377284c990>]}
[0m11:47:44.144013 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m11:47:44.145012 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m11:47:44.147557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:44.150014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:44.150623 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m11:47:44.151250 [info ] [MainThread]: 
[0m11:47:44.151896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m11:47:44.152956 [debug] [MainThread]: Command end result
[0m11:47:44.206608 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m11:47:44.209626 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m11:47:44.217825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m11:47:44.218458 [info ] [MainThread]: 
[0m11:47:44.219270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:44.219878 [info ] [MainThread]: 
[0m11:47:44.220497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:47:44.221514 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:47:44.222928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.168484, "process_in_blocks": "0", "process_kernel_time": 0.921248, "process_mem_max_rss": "397476", "process_out_blocks": "3512", "process_user_time": 6.349378}
[0m11:47:44.223648 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:44.223491 after 7.17 seconds
[0m11:47:44.224227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37924b1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37963c72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37625ea510>]}
[0m11:47:44.224823 [debug] [MainThread]: Flushing usage events
[0m11:47:44.444178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:28.602805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae73e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae566fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae70bed0>]}


============================== 13:40:28.607232 | abdbb24e-6901-481f-b7bf-c13121f7b0fc ==============================
[0m13:40:28.607232 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:40:28.608100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_fact_orders', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False'}
[0m13:40:28.608796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:40:28.609460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae8b21d0>]}
[0m13:40:32.091678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae830f10>]}
[0m13:40:32.182365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b1319310>]}
[0m13:40:32.183549 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:40:32.474883 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:40:32.684314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:32.685067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:32.693844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:40:32.752772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ebdea90>]}
[0m13:40:32.895291 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:40:32.898301 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:40:32.918475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ed25b10>]}
[0m13:40:32.919390 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m13:40:32.920085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38eec4d90>]}
[0m13:40:32.922357 [info ] [MainThread]: 
[0m13:40:32.922948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:32.923467 [info ] [MainThread]: 
[0m13:40:32.924316 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:40:32.926493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:40:32.927398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:33.431439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:40:33.432756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:33.900212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ed9e0d0>]}
[0m13:40:33.901112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:33.908726 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m13:40:33.909739 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m13:40:33.910635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m13:40:33.911208 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m13:40:33.926214 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m13:40:33.927582 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m13:40:33.970107 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m13:40:33.971473 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate as (
    select
        COALESCE(CAST(symbol AS STRING), '') as symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) as exchange_rate
    from `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base as (
    select
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
from base b
left join ip_data e2
    on b.ip_address = e2.ip
left join exchange_rate e3
    on b.currency = e3.symbol;


[0m13:40:33.972320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:34.911416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4fbf8c09-213a-4d31-a85f-9c6334dd6dc9&page=queryresults
[0m13:40:35.722758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdbb24e-6901-481f-b7bf-c13121f7b0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38eead6d0>]}
[0m13:40:35.723934 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m13:40:35.724865 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m13:40:35.727264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:35.729552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:35.730068 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m13:40:35.730597 [info ] [MainThread]: 
[0m13:40:35.731070 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m13:40:35.732234 [debug] [MainThread]: Command end result
[0m13:40:35.781408 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:40:35.784175 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:40:35.791887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:40:35.792463 [info ] [MainThread]: 
[0m13:40:35.793152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:35.793650 [info ] [MainThread]: 
[0m13:40:35.794190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:40:35.795025 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:40:35.796376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2750115, "process_in_blocks": "0", "process_kernel_time": 0.903339, "process_mem_max_rss": "397360", "process_out_blocks": "3512", "process_user_time": 6.611177}
[0m13:40:35.797103 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:35.796940 after 7.28 seconds
[0m13:40:35.797656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae832cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ae7027d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38d4f5d50>]}
[0m13:40:35.798326 [debug] [MainThread]: Flushing usage events
[0m13:40:36.011187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:47.854128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67c10af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67c10b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67c10b210>]}


============================== 13:43:47.858718 | 119e5bc7-6f58-4d7b-9bc3-2f5b94121776 ==============================
[0m13:43:47.858718 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:43:47.859587 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m stg_dim_date', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True'}
[0m13:43:47.860253 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:43:47.860889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67c10ba50>]}
[0m13:43:51.487832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c764050>]}
[0m13:43:51.575896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67ed193d0>]}
[0m13:43:51.577052 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:43:51.843828 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:43:52.031652 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:43:52.032503 [debug] [MainThread]: Partial parsing: deleted file: glramira://models/staging/base_product_info_product.sql
[0m13:43:52.139632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:43:52.160004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c8a86d0>]}
[0m13:43:52.300167 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:43:52.303117 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:43:52.322991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c748e50>]}
[0m13:43:52.323915 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:43:52.324508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c401bd0>]}
[0m13:43:52.326765 [info ] [MainThread]: 
[0m13:43:52.327354 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:52.327861 [info ] [MainThread]: 
[0m13:43:52.328686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:52.330750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:43:52.331474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:52.817200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:43:52.818127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:53.262913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c56c4d0>]}
[0m13:43:53.263830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:53.270614 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m13:43:53.271600 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m13:43:53.272426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m13:43:53.273115 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m13:43:53.344096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:53.354025 [debug] [Thread-1 (]: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:43:53.356578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '119e5bc7-6f58-4d7b-9bc3-2f5b94121776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c991990>]}
[0m13:43:53.357717 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_date ................. [[31mERROR[0m in 0.08s]
[0m13:43:53.358515 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m13:43:53.359234 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:43:53.362088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:53.364471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:53.365035 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m13:43:53.365700 [info ] [MainThread]: 
[0m13:43:53.366243 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m13:43:53.367201 [debug] [MainThread]: Command end result
[0m13:43:53.421857 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:43:53.424585 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:43:53.432729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:43:53.433326 [info ] [MainThread]: 
[0m13:43:53.434012 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:43:53.434566 [info ] [MainThread]: 
[0m13:43:53.435201 [error] [MainThread]: [31mFailure in model stg_dim_date (models/staging/stg_dim_date.sql)[0m
[0m13:43:53.435816 [error] [MainThread]:   Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:43:53.436314 [info ] [MainThread]: 
[0m13:43:53.436845 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:43:53.437621 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:43:53.438998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6587987, "process_in_blocks": "232", "process_kernel_time": 0.861099, "process_mem_max_rss": "393436", "process_out_blocks": "5216", "process_user_time": 6.420201}
[0m13:43:53.439718 [debug] [MainThread]: Command `dbt run` failed at 13:43:53.439564 after 5.66 seconds
[0m13:43:53.440381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6803072d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb680307310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb680307250>]}
[0m13:43:53.441029 [debug] [MainThread]: Flushing usage events
[0m13:43:53.637081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:01.814513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63054e22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630550aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63055098d0>]}


============================== 13:45:01.818957 | a6a3dbf3-74df-4f0f-9629-9afe1256eec7 ==============================
[0m13:45:01.818957 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:45:01.819837 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_fact_orders'}
[0m13:45:01.820481 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:45:01.821120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63055188d0>]}
[0m13:45:05.421424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e5a02b10>]}
[0m13:45:05.512774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63080b1610>]}
[0m13:45:05.513908 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:45:05.767407 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:45:05.972947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:05.973577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:05.982291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:45:06.040985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e58a8d50>]}
[0m13:45:06.188204 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:45:06.191075 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:45:06.211356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e5838910>]}
[0m13:45:06.212286 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:45:06.212877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6305a7c8d0>]}
[0m13:45:06.215197 [info ] [MainThread]: 
[0m13:45:06.215870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:06.216441 [info ] [MainThread]: 
[0m13:45:06.217229 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:06.219456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:45:06.220215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:06.699321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:45:06.700385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:07.155251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e5a80a50>]}
[0m13:45:07.156263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:07.165427 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m13:45:07.166817 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m13:45:07.167970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m13:45:07.168766 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m13:45:07.184351 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m13:45:07.185465 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m13:45:07.227314 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m13:45:07.228712 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select distinct
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate as (
    select
        COALESCE(CAST(symbol AS STRING), '') as symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) as exchange_rate
    from `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base as (
    select distinct
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
from base b
left join ip_data e2
    on b.ip_address = e2.ip
left join exchange_rate e3
    on b.currency = e3.symbol;


[0m13:45:07.229610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:08.314074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e14734ef-5bd9-4422-8f17-da1710caa8ac&page=queryresults
[0m13:45:09.277857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a3dbf3-74df-4f0f-9629-9afe1256eec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e5477e50>]}
[0m13:45:09.279094 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m13:45:09.280166 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m13:45:09.282726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:09.285003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:09.285605 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m13:45:09.286113 [info ] [MainThread]: 
[0m13:45:09.286745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m13:45:09.287928 [debug] [MainThread]: Command end result
[0m13:45:09.342063 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:45:09.344878 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:45:09.353244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:45:09.353855 [info ] [MainThread]: 
[0m13:45:09.354526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:09.355039 [info ] [MainThread]: 
[0m13:45:09.355635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:45:09.356439 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:45:09.357795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6155405, "process_in_blocks": "0", "process_kernel_time": 0.898879, "process_mem_max_rss": "397460", "process_out_blocks": "3504", "process_user_time": 6.666677}
[0m13:45:09.358505 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:09.358338 after 7.62 seconds
[0m13:45:09.359076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63055d2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63096ab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630976c3d0>]}
[0m13:45:09.359679 [debug] [MainThread]: Flushing usage events
[0m13:45:09.570870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:45.509421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48ddfa890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48ddfb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48ddfb110>]}


============================== 13:46:45.513927 | a1c8843f-0a3e-4162-b093-d4187a7a9e08 ==============================
[0m13:46:45.513927 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:46:45.514775 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'invocation_command': 'dbt run -m stg_fact_orders', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m13:46:45.515487 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:46:45.516119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48de363d0>]}
[0m13:46:48.968827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48e40c750>]}
[0m13:46:49.055687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd490a59450>]}
[0m13:46:49.056824 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:46:49.315135 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:46:49.524923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:49.525569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:49.533929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:46:49.592924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e3aedd0>]}
[0m13:46:49.736295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:46:49.739262 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:46:49.758748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46dd78850>]}
[0m13:46:49.759620 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:46:49.760215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e182fd0>]}
[0m13:46:49.762613 [info ] [MainThread]: 
[0m13:46:49.763188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:49.763686 [info ] [MainThread]: 
[0m13:46:49.764497 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:46:49.766566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:46:49.767432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:50.263306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:46:50.264285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:50.712866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e4b8d10>]}
[0m13:46:50.713754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:50.721530 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m13:46:50.722521 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m13:46:50.723360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_fact_orders)
[0m13:46:50.724000 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m13:46:50.738031 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m13:46:50.739144 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m13:46:50.780619 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m13:46:50.782097 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as with 
ip_data as (
    select distinct
        CAST(ip AS STRING) as ip,
        COALESCE(CAST(country AS STRING), '') as country,
        COALESCE(CAST(country_code AS STRING), '') as country_code,
        COALESCE(CAST(region AS STRING), '') as region,
        COALESCE(CAST(city AS STRING), '') as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate as (
    select
        COALESCE(CAST(symbol AS STRING), '') as symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) as exchange_rate
    from `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base as (
    select distinct
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    from `project-data-engineer-469310`.`product_info`.`event` as e1
    cross join unnest(e1.cart_products) as cp
    where e1.collection = 'checkout_success'
)

select
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
from base b
left join ip_data e2
    on b.ip_address = e2.ip
left join exchange_rate e3
    on b.currency = e3.symbol;


[0m13:46:50.783057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:52.047252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a419d53b-e481-4527-9eec-d328419490f7&page=queryresults
[0m13:46:52.850960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c8843f-0a3e-4162-b093-d4187a7a9e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e333d50>]}
[0m13:46:52.852114 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m13:46:52.853022 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m13:46:52.855437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:52.857707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:52.858236 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m13:46:52.858766 [info ] [MainThread]: 
[0m13:46:52.859329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m13:46:52.860500 [debug] [MainThread]: Command end result
[0m13:46:52.917687 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:46:52.920869 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:46:52.928625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:46:52.929251 [info ] [MainThread]: 
[0m13:46:52.929968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:52.930522 [info ] [MainThread]: 
[0m13:46:52.931108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:46:52.931917 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:46:52.933327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4993963, "process_in_blocks": "0", "process_kernel_time": 0.883381, "process_mem_max_rss": "397468", "process_out_blocks": "3496", "process_user_time": 6.540276}
[0m13:46:52.934008 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:52.933856 after 7.50 seconds
[0m13:46:52.934548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48dfada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49206f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd492130290>]}
[0m13:46:52.935123 [debug] [MainThread]: Flushing usage events
[0m13:46:53.130938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:25.927613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3536417010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35365c1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353640de10>]}


============================== 13:47:25.932068 | bdb69050-6170-44f4-a808-335927f09d05 ==============================
[0m13:47:25.932068 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:47:25.932986 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'quiet': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None'}
[0m13:47:25.933609 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:47:25.934288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3536415910>]}
[0m13:47:29.400379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3516cd5490>]}
[0m13:47:29.485201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3539005510>]}
[0m13:47:29.486281 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:47:29.734892 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:47:29.919626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:29.920298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:29.928500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:47:29.985656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35168a1410>]}
[0m13:47:30.119432 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:47:30.122296 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:47:30.141321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35165b0310>]}
[0m13:47:30.142189 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:47:30.142809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3516ab9dd0>]}
[0m13:47:30.145006 [info ] [MainThread]: 
[0m13:47:30.145610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:30.146136 [info ] [MainThread]: 
[0m13:47:30.146980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:30.148457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:47:30.149207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:30.620807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:47:30.621697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:31.064629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35381d49d0>]}
[0m13:47:31.065468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:31.073285 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:47:31.074230 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:47:31.075140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:47:31.075781 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:47:31.089247 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:47:31.090275 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:47:31.130285 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:47:31.131710 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(concat(
        coalesce(cast(country) as string), ''),
        coalesce(cast(country_code) as string), ''),
        coalesce(cast(city) as string), ''),
        coalesce(cast(region) as string), '')
    )) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)

select * from location;


[0m13:47:31.132485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:31.765233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e153e086-317e-4ebd-80c5-72896787f7c4&page=queryresults
[0m13:47:31.766518 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e153e086-317e-4ebd-80c5-72896787f7c4&page=queryresults
[0m13:47:31.776696 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:30]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:47:31.779216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb69050-6170-44f4-a808-335927f09d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35164914d0>]}
[0m13:47:31.780320 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 0.70s]
[0m13:47:31.781221 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:47:31.782152 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:30]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m13:47:31.785546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:31.788421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:31.788994 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:47:31.789554 [info ] [MainThread]: 
[0m13:47:31.790074 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m13:47:31.791146 [debug] [MainThread]: Command end result
[0m13:47:31.844369 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:47:31.847190 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:47:31.855449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:47:31.856075 [info ] [MainThread]: 
[0m13:47:31.856761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:47:31.857347 [info ] [MainThread]: 
[0m13:47:31.857987 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m13:47:31.858544 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:30]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:47:31.859007 [info ] [MainThread]: 
[0m13:47:31.859589 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m13:47:31.860038 [info ] [MainThread]: 
[0m13:47:31.860570 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:47:31.861330 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:47:31.862774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.0088997, "process_in_blocks": "0", "process_kernel_time": 0.826379, "process_mem_max_rss": "393324", "process_out_blocks": "3488", "process_user_time": 6.311438}
[0m13:47:31.863480 [debug] [MainThread]: Command `dbt run` failed at 13:47:31.863282 after 6.01 seconds
[0m13:47:31.864248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35168e1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353a5f7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353a5f6f90>]}
[0m13:47:31.864818 [debug] [MainThread]: Flushing usage events
[0m13:47:32.031940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:02.837369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf814f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf80e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf816b50>]}


============================== 13:52:02.843587 | 38361275-f072-47e8-b430-6329c4b09309 ==============================
[0m13:52:02.843587 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:52:02.844795 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run -m stg_dim_location'}
[0m13:52:02.845695 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:52:02.846665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf9c2050>]}
[0m13:52:06.269181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8ff2d490>]}
[0m13:52:06.355500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb2405350>]}
[0m13:52:06.356596 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:52:06.607093 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:52:06.793180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:06.793771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:06.801884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:52:06.857685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8fca1650>]}
[0m13:52:06.993259 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:52:06.996230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:52:07.016325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb15f9410>]}
[0m13:52:07.017269 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:52:07.017886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8fced610>]}
[0m13:52:07.020208 [info ] [MainThread]: 
[0m13:52:07.020795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:07.021298 [info ] [MainThread]: 
[0m13:52:07.022138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:52:07.023726 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:52:07.024571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:07.506002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:52:07.506865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:07.958525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8f9d20d0>]}
[0m13:52:07.959648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:07.967853 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:52:07.968875 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:52:07.969752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:52:07.970343 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:52:07.983823 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:52:07.984977 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:52:08.029364 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:52:08.030655 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(
            concat(coalesce(cast(country) as string, ''),
                   coalesce(cast(country_code) as string, ''),
                   coalesce(cast(city) as string, ''),
                   coalesce(cast(region) as string, '')
            )
        ) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)
select * from locations;


[0m13:52:08.031534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:08.852703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:222243f2-c3ae-4497-8307-27caff352c2e&page=queryresults
[0m13:52:08.853785 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:222243f2-c3ae-4497-8307-27caff352c2e&page=queryresults
[0m13:52:08.865996 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:52:08.868542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38361275-f072-47e8-b430-6329c4b09309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8fca37d0>]}
[0m13:52:08.869622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 0.90s]
[0m13:52:08.870560 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:52:08.871518 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m13:52:08.874825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:08.877319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:08.877888 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:52:08.878445 [info ] [MainThread]: 
[0m13:52:08.879011 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m13:52:08.880138 [debug] [MainThread]: Command end result
[0m13:52:08.942209 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:52:08.945019 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:52:08.953185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:52:08.953759 [info ] [MainThread]: 
[0m13:52:08.954450 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:52:08.955012 [info ] [MainThread]: 
[0m13:52:08.955653 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m13:52:08.956237 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:52:08.956761 [info ] [MainThread]: 
[0m13:52:08.957384 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m13:52:08.957865 [info ] [MainThread]: 
[0m13:52:08.958429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:52:08.959300 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:52:08.961050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.196639, "process_in_blocks": "0", "process_kernel_time": 0.763272, "process_mem_max_rss": "393304", "process_out_blocks": "3488", "process_user_time": 6.49709}
[0m13:52:08.961735 [debug] [MainThread]: Command `dbt run` failed at 13:52:08.961585 after 6.20 seconds
[0m13:52:08.962362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8ff5c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb39ff010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb07f12d0>]}
[0m13:52:08.962993 [debug] [MainThread]: Flushing usage events
[0m13:52:09.186474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:06.612074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab58210950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5820a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab58213210>]}


============================== 13:53:06.616826 | 18d21560-d734-4524-bbc4-5eebbe2d71e1 ==============================
[0m13:53:06.616826 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:53:06.617677 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_dim_location', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None'}
[0m13:53:06.618472 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:53:06.619119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5820a610>]}
[0m13:53:10.215065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab38860190>]}
[0m13:53:10.308264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5add1490>]}
[0m13:53:10.309548 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:53:10.605186 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:53:10.803428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:10.804079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:10.812779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:53:10.871898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab380d33d0>]}
[0m13:53:11.019066 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:53:11.022172 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:53:11.042845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5a5fef90>]}
[0m13:53:11.043765 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:53:11.044466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab38108bd0>]}
[0m13:53:11.046923 [info ] [MainThread]: 
[0m13:53:11.047639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:11.048174 [info ] [MainThread]: 
[0m13:53:11.049245 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:11.050815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:53:11.051588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:11.610159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:53:11.611387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:12.069051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab59580210>]}
[0m13:53:12.069902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:12.077227 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:53:12.078157 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:53:12.079014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:53:12.079650 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:53:12.093093 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:53:12.094265 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:53:12.134994 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:53:12.136266 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as with location as (
    select distinct
        farm_fingerprint(
            concat(coalesce(cast(country) as string, ''),
                   coalesce(cast(country_code) as string, ''),
                   coalesce(cast(city) as string, ''),
                   coalesce(cast(region) as string, '')
            )
        ) AS location_id,
        cast(country as string) as country,
        cast(country_code as string) as country_code,
        cast(region as string) as region,
        cast(city as string) as city
    from `project-data-engineer-469310`.`product_info`.`ip_locations`
)
select * from location;


[0m13:53:12.136986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:12.948784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:881d40ba-8242-4261-9abe-28e995ffb2fb&page=queryresults
[0m13:53:12.949794 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:881d40ba-8242-4261-9abe-28e995ffb2fb&page=queryresults
[0m13:53:12.959592 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:53:12.962024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d21560-d734-4524-bbc4-5eebbe2d71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab37fe5450>]}
[0m13:53:12.963143 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 0.88s]
[0m13:53:12.964065 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:53:12.964944 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m13:53:12.968424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:12.971242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:12.971830 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:53:12.972325 [info ] [MainThread]: 
[0m13:53:12.972878 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m13:53:12.973861 [debug] [MainThread]: Command end result
[0m13:53:13.037224 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:53:13.040027 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:53:13.048096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:53:13.048689 [info ] [MainThread]: 
[0m13:53:13.049386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:13.049908 [info ] [MainThread]: 
[0m13:53:13.050546 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m13:53:13.051137 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Expected keyword AS but got ")" at [9:41]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:53:13.051632 [info ] [MainThread]: 
[0m13:53:13.052211 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m13:53:13.052685 [info ] [MainThread]: 
[0m13:53:13.053242 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:53:13.054010 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:53:13.055430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5194483, "process_in_blocks": "0", "process_kernel_time": 0.848281, "process_mem_max_rss": "392512", "process_out_blocks": "3496", "process_user_time": 6.618881}
[0m13:53:13.056112 [debug] [MainThread]: Command `dbt run` failed at 13:53:13.055959 after 6.52 seconds
[0m13:53:13.056704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5c3a7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab594f6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab584cc810>]}
[0m13:53:13.057311 [debug] [MainThread]: Flushing usage events
[0m13:53:13.249510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:48.728132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be623d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be620cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be620e2d0>]}


============================== 13:53:48.732854 | 9e4f23c1-952a-4c94-8733-9b472291df2e ==============================
[0m13:53:48.732854 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:53:48.733722 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_dim_location', 'quiet': 'False'}
[0m13:53:48.734363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:53:48.734982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be638e450>]}
[0m13:53:52.223106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc6aa5490>]}
[0m13:53:52.309617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be8e11290>]}
[0m13:53:52.310703 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:53:52.558584 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:53:52.745111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:52.745731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:52.754319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:53:52.875198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc68a8cd0>]}
[0m13:53:53.018230 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:53:53.021558 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:53:53.041701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be8843350>]}
[0m13:53:53.042622 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:53:53.043298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc622bf90>]}
[0m13:53:53.045595 [info ] [MainThread]: 
[0m13:53:53.046246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:53.046837 [info ] [MainThread]: 
[0m13:53:53.047800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:53.049958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:53:53.050789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:53.614058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:53:53.614874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:54.106997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc66daa50>]}
[0m13:53:54.108325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:54.141503 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:53:54.142598 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:53:54.143653 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_location'
[0m13:53:54.144259 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:53:54.158293 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:53:54.159544 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:53:54.200967 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:53:54.202292 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as WITH location AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(city AS STRING), ''),
                COALESCE(CAST(region AS STRING), '')
            )
        ) AS location_id,
        CAST(country AS STRING) AS country,
        CAST(country_code AS STRING) AS country_code,
        CAST(region AS STRING) AS region,
        CAST(city AS STRING) AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
)
SELECT * FROM location;;


[0m13:53:54.203064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:54.852881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:99b11cf7-44d5-4661-9822-040526966bcc&page=queryresults
[0m13:53:54.853940 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:99b11cf7-44d5-4661-9822-040526966bcc&page=queryresults
[0m13:53:54.864300 [debug] [Thread-1 (]: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Unexpected ";" at [22:24]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:53:54.866704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4f23c1-952a-4c94-8733-9b472291df2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc62f0950>]}
[0m13:53:54.867815 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_location ............. [[31mERROR[0m in 0.72s]
[0m13:53:54.868679 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:53:54.869587 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_location' to be skipped because of status 'error'.  Reason: Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Unexpected ";" at [22:24]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql.
[0m13:53:54.872802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:54.875313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:54.875869 [debug] [MainThread]: Connection 'list_project-data-engineer-469310_dbt_glramira' was properly closed.
[0m13:53:54.876333 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:53:54.876849 [info ] [MainThread]: 
[0m13:53:54.877457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m13:53:54.878780 [debug] [MainThread]: Command end result
[0m13:53:54.939010 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:53:54.941898 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:53:54.949765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:53:54.950384 [info ] [MainThread]: 
[0m13:53:54.951139 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:54.951728 [info ] [MainThread]: 
[0m13:53:54.952408 [error] [MainThread]: [31mFailure in model stg_dim_location (models/staging/stg_dim_location.sql)[0m
[0m13:53:54.953009 [error] [MainThread]:   Database Error in model stg_dim_location (models/staging/stg_dim_location.sql)
  Syntax error: Unexpected ";" at [22:24]
  compiled code at target/run/glramira/models/staging/stg_dim_location.sql
[0m13:53:54.953524 [info ] [MainThread]: 
[0m13:53:54.954102 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/staging/stg_dim_location.sql
[0m13:53:54.954609 [info ] [MainThread]: 
[0m13:53:54.955151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:53:54.956058 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:53:54.957559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3079405, "process_in_blocks": "0", "process_kernel_time": 0.810619, "process_mem_max_rss": "393256", "process_out_blocks": "3496", "process_user_time": 6.649323}
[0m13:53:54.958211 [debug] [MainThread]: Command `dbt run` failed at 13:53:54.958073 after 6.31 seconds
[0m13:53:54.958811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bea413110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bea560e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be61e0d10>]}
[0m13:53:54.959355 [debug] [MainThread]: Flushing usage events
[0m13:53:55.128063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:20.114288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda54c1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda54c1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda54c39d0>]}


============================== 13:54:20.119222 | 6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a ==============================
[0m13:54:20.119222 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:54:20.120190 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run -m stg_dim_location', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m13:54:20.120881 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:54:20.121549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda5675950>]}
[0m13:54:23.657797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda5e22010>]}
[0m13:54:23.749058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda80f5c50>]}
[0m13:54:23.750131 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:54:24.006223 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:54:24.197022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:24.197705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:24.206673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:54:24.264618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8563d510>]}
[0m13:54:24.405797 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:54:24.408822 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:54:24.429178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85bde910>]}
[0m13:54:24.430060 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:54:24.430699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85b64590>]}
[0m13:54:24.433309 [info ] [MainThread]: 
[0m13:54:24.433975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:24.434544 [info ] [MainThread]: 
[0m13:54:24.435490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:24.437718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:54:24.438590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:24.909785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:54:24.910671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:25.393539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85851550>]}
[0m13:54:25.394382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:25.402010 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_location
[0m13:54:25.402980 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:54:25.403890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_location)
[0m13:54:25.404469 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_location
[0m13:54:25.417997 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:54:25.419197 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_location
[0m13:54:25.460577 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:54:25.461712 [debug] [Thread-1 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as WITH location AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(city AS STRING), ''),
                COALESCE(CAST(region AS STRING), '')
            )
        ) AS location_id,
        CAST(country AS STRING) AS country,
        CAST(country_code AS STRING) AS country_code,
        CAST(region AS STRING) AS region,
        CAST(city AS STRING) AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
)
SELECT * FROM location;


[0m13:54:25.462387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:26.194156 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6d0e028a-e596-45f8-853a-f55b57daf4ca&page=queryresults
[0m13:54:27.268716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0a1a91-d71b-4db9-b1cd-c1ade7e0af8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd854ba210>]}
[0m13:54:27.269855 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.86s]
[0m13:54:27.270824 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_location
[0m13:54:27.273445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:27.275878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:27.276380 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:54:27.276914 [info ] [MainThread]: 
[0m13:54:27.277538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m13:54:27.278728 [debug] [MainThread]: Command end result
[0m13:54:27.334199 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:54:27.337020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:54:27.345175 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:54:27.345783 [info ] [MainThread]: 
[0m13:54:27.346552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:27.347137 [info ] [MainThread]: 
[0m13:54:27.347764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:54:27.348613 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:54:27.349991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3112636, "process_in_blocks": "0", "process_kernel_time": 0.812977, "process_mem_max_rss": "397488", "process_out_blocks": "3496", "process_user_time": 6.510815}
[0m13:54:27.350659 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:27.350501 after 7.31 seconds
[0m13:54:27.351215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda96ef050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda96eefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97b41d0>]}
[0m13:54:27.351879 [debug] [MainThread]: Flushing usage events
[0m13:54:27.517587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:08.491836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056fefa8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056fefa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056fefbc10>]}


============================== 13:58:08.496441 | 722e73b7-f951-4c83-bb1c-bf8eff5f5707 ==============================
[0m13:58:08.496441 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:58:08.497327 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select glramira.staging', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m13:58:11.997877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056ff2d810>]}
[0m13:58:12.085535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0572adcfd0>]}
[0m13:58:12.086681 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:58:12.331771 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:58:12.521345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:12.522020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:12.530615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:58:12.588889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0550240f10>]}
[0m13:58:12.728029 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:58:12.730899 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:58:12.750373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057230ce10>]}
[0m13:58:12.751358 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:58:12.752016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054fe3f710>]}
[0m13:58:12.754744 [info ] [MainThread]: 
[0m13:58:12.755343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:12.755882 [info ] [MainThread]: 
[0m13:58:12.756751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:12.763273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:58:12.764139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:13.297613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:58:13.298435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:13.770578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054ffc8150>]}
[0m13:58:13.771640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:13.779236 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m13:58:13.780078 [debug] [Thread-2 (]: Began running node model.glramira.stg_dim_device
[0m13:58:13.780949 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m13:58:13.781754 [debug] [Thread-3 (]: Began running node model.glramira.stg_dim_location
[0m13:58:13.782399 [debug] [Thread-4 (]: Began running node model.glramira.stg_dim_product
[0m13:58:13.783125 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m13:58:13.784026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m13:58:13.784788 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:58:13.785669 [info ] [Thread-4 (]: 4 of 7 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m13:58:13.786636 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_device'
[0m13:58:13.787431 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m13:58:13.788431 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_location'
[0m13:58:13.789315 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_product'
[0m13:58:13.789993 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_dim_device
[0m13:58:13.796070 [debug] [Thread-3 (]: Began compiling node model.glramira.stg_dim_location
[0m13:58:13.804548 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_dim_product
[0m13:58:13.805804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:13.811874 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m13:58:13.817205 [debug] [Thread-3 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:58:13.822264 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m13:58:13.826929 [debug] [Thread-2 (]: Began executing node model.glramira.stg_dim_device
[0m13:58:13.828371 [debug] [Thread-3 (]: Began executing node model.glramira.stg_dim_location
[0m13:58:13.873764 [debug] [Thread-4 (]: Began executing node model.glramira.stg_dim_product
[0m13:58:13.917946 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m13:58:13.916544 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m13:58:13.921058 [debug] [Thread-3 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:58:13.924124 [debug] [Thread-4 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as WITH product AS (
      SELECT
        CAST(product_id AS INT64) AS product_id,
        CAST(product_name AS STRING) AS product_name,
        CAST(product_price AS FLOAT64) AS product_price,
        CAST(min_price AS FLOAT64) AS min_price,
        CAST(max_price AS FLOAT64) AS max_price,
        CAST(min_price_format AS STRING) AS min_price_format,
        CAST(max_price_format AS STRING) AS max_price_format

      FROM `project-data-engineer-469310`.`product_info`.`product`
  )
SELECT * FROM product
WHERE product_id != 101993;


[0m13:58:13.925156 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:58:13.926159 [debug] [Thread-2 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as WITH device AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) AS device_id,

        CAST(device_id AS STRING) AS raw_device_id,
        CAST(resolution AS STRING) AS resolution,
        CAST(user_agent AS STRING) AS user_agent,
        CASE
            WHEN regexp_contains(user_agent, r'Windows NT [0-9._]+') 
                THEN regexp_extract(user_agent, r'Windows NT [0-9._]+')
            WHEN regexp_contains(user_agent, r'Android\s+[0-9._]+') 
                THEN regexp_extract(user_agent, r'Android\s+[0-9._]+')
            WHEN regexp_contains(user_agent, r'iPhone OS [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Mac OS X [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,
        CASE
            WHEN regexp_contains(user_agent, r'SM-[^;\)]+') 
                THEN regexp_extract(user_agent, r'SM-[^;\)]+')
            WHEN regexp_contains(user_agent, r'LG-[^;\)]+') 
                THEN regexp_extract(user_agent, r'LG-[^;\)]+')
            WHEN regexp_contains(user_agent, r'MI [^;\)]+') 
                THEN regexp_extract(user_agent, r'MI [^;\)]+')
            WHEN regexp_contains(user_agent, r'Windows') 
                THEN 'PC Windows'
            WHEN regexp_contains(user_agent, r'Macintosh') THEN 'Mac'
            WHEN regexp_contains(user_agent, r'iPhone') THEN 'iPhone'
            WHEN regexp_contains(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
        END AS device_model,
        CASE
            WHEN regexp_contains(user_agent, r'Mobile') THEN 'Mobile'
            WHEN regexp_contains(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM device;


[0m13:58:13.964977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:13.966200 [debug] [Thread-3 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as WITH location AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(city AS STRING), ''),
                COALESCE(CAST(region AS STRING), '')
            )
        ) AS location_id,
        CAST(country AS STRING) AS country,
        CAST(country_code AS STRING) AS country_code,
        CAST(region AS STRING) AS region,
        CAST(city AS STRING) AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
)
SELECT * FROM location;


[0m13:58:14.009402 [debug] [Thread-1 (]: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:14.010242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:58:14.013888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054fe77890>]}
[0m13:58:14.054319 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model dbt_glramira.stg_dim_date ................. [[31mERROR[0m in 0.23s]
[0m13:58:14.055655 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m13:58:14.056660 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_store
[0m13:58:14.057572 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:14.058620 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_glramira.stg_dim_store ......................... [RUN]
[0m13:58:14.061571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_date, now model.glramira.stg_dim_store)
[0m13:58:14.062368 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_store
[0m13:58:14.071764 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_store"
[0m13:58:14.073204 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_store
[0m13:58:14.082940 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_store"
[0m13:58:14.084487 [debug] [Thread-1 (]: On model.glramira.stg_dim_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_store"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  OPTIONS()
  as WITH orders AS (
    SELECT DISTINCT
        CAST(store_id AS INT64) AS store_id,
        CONCAT('glamira_', CAST(store_id AS STRING)) AS store_name
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM orders;


[0m13:58:14.085504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:14.910210 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:88f2e0d3-041d-4a63-aa88-7ef26f3dd626&page=queryresults
[0m13:58:14.913021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:12cb80cd-6186-4ac3-b642-4d409a4117c7&page=queryresults
[0m13:58:14.914093 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:011064ad-d777-435d-80ee-1a6e180a55ed&page=queryresults
[0m13:58:15.076200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bc8e30d0-4248-48cf-a618-4ee93bf22caf&page=queryresults
[0m13:58:15.690656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c411650>]}
[0m13:58:15.691807 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_glramira.stg_dim_store .................... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m13:58:15.692797 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_store
[0m13:58:15.693629 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m13:58:15.694561 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m13:58:15.695304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_store, now model.glramira.stg_dim_user)
[0m13:58:15.695868 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m13:58:15.700842 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m13:58:15.702795 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m13:58:15.707712 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m13:58:15.708747 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as WITH user AS (
    SELECT DISTINCT
        farm_fingerprint(concat(
        coalesce(cast((email_address) as string), '')
    )) AS user_id,
        CAST(email_address AS STRING) AS email_address
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM user;


[0m13:58:15.709364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:15.755201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054fde6590>]}
[0m13:58:15.756793 [info ] [Thread-4 (]: 4 of 7 OK created sql view model dbt_glramira.stg_dim_product .................. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m13:58:15.758109 [debug] [Thread-4 (]: Finished running node model.glramira.stg_dim_product
[0m13:58:15.759006 [debug] [Thread-4 (]: Began running node model.glramira.stg_fact_orders
[0m13:58:15.760369 [info ] [Thread-4 (]: 7 of 7 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m13:58:15.761246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_product, now model.glramira.stg_fact_orders)
[0m13:58:15.761793 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_fact_orders
[0m13:58:15.768234 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m13:58:15.769178 [debug] [Thread-4 (]: Began executing node model.glramira.stg_fact_orders
[0m13:58:15.773835 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m13:58:15.774947 [debug] [Thread-4 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as WITH 
ip_data AS (
    SELECT DISTINCT
        CAST(ip AS STRING) AS ip,
        COALESCE(CAST(country AS STRING), '') AS country,
        COALESCE(CAST(country_code AS STRING), '') AS country_code,
        COALESCE(CAST(region AS STRING), '') AS region,
        COALESCE(CAST(city AS STRING), '') AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate AS (
    SELECT
        COALESCE(CAST(symbol AS STRING), '') AS symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) AS exchange_rate
    FROM `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    FROM `project-data-engineer-469310`.`product_info`.`event` AS e1
    CROSS JOIN UNNEST(e1.cart_products) AS cp
    WHERE e1.collection = 'checkout_success'
)

SELECT
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
FROM base b
LEFT JOIN ip_data e2
    ON b.ip_address = e2.ip
LEFT JOIN exchange_rate e3
    ON b.currency = e3.symbol;


[0m13:58:15.775781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:58:15.907844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054fd81890>]}
[0m13:58:15.913340 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m13:58:15.918009 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054fde6410>]}
[0m13:58:15.919272 [debug] [Thread-2 (]: Finished running node model.glramira.stg_dim_device
[0m13:58:15.921096 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m13:58:15.922875 [debug] [Thread-3 (]: Finished running node model.glramira.stg_dim_location
[0m13:58:16.462199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:26786f5f-05ae-440b-a851-4b89a045b3a3&page=queryresults
[0m13:58:16.514807 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:37b5c2a3-7403-439d-81c7-a7050a71de97&page=queryresults
[0m13:58:17.271660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c2181d0>]}
[0m13:58:17.272872 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m13:58:17.273841 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m13:58:17.331018 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722e73b7-f951-4c83-bb1c-bf8eff5f5707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c218250>]}
[0m13:58:17.332423 [info ] [Thread-4 (]: 7 of 7 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m13:58:17.333483 [debug] [Thread-4 (]: Finished running node model.glramira.stg_fact_orders
[0m13:58:17.335945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:17.338155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:17.338779 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m13:58:17.339204 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m13:58:17.339642 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m13:58:17.340142 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m13:58:17.340766 [info ] [MainThread]: 
[0m13:58:17.341324 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m13:58:17.343233 [debug] [MainThread]: Command end result
[0m13:58:17.399416 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:58:17.402285 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:58:17.410451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:58:17.411092 [info ] [MainThread]: 
[0m13:58:17.411812 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:58:17.412408 [info ] [MainThread]: 
[0m13:58:17.413043 [error] [MainThread]: [31mFailure in model stg_dim_date (models/staging/stg_dim_date.sql)[0m
[0m13:58:17.413645 [error] [MainThread]:   Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.414184 [info ] [MainThread]: 
[0m13:58:17.414722 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:58:17.416216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.006232, "process_in_blocks": "8", "process_kernel_time": 0.857746, "process_mem_max_rss": "403792", "process_out_blocks": "3648", "process_user_time": 8.077925}
[0m13:58:17.416885 [debug] [MainThread]: Command `dbt run` failed at 13:58:17.416743 after 9.01 seconds
[0m13:58:17.417517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056fd64490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05711de390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05740cb010>]}
[0m13:58:17.418157 [debug] [MainThread]: Flushing usage events
[0m13:58:17.650660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:39.897937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129dadd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129dadd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129dadef10>]}


============================== 13:58:39.902445 | 9608f4c4-5458-42ce-a967-fe0ed12f912a ==============================
[0m13:58:39.902445 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:58:39.903310 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -m stg_dim_date', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None'}
[0m13:58:39.903996 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:58:39.904602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a1fce290>]}
[0m13:58:43.514143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127e3c9c10>]}
[0m13:58:43.601654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a0709850>]}
[0m13:58:43.602714 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:58:43.844086 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:58:44.031288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:44.031985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:44.040107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:58:44.097137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127dfd29d0>]}
[0m13:58:44.236100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:58:44.239134 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:58:44.260150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127df36710>]}
[0m13:58:44.261096 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:58:44.261826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127dfad450>]}
[0m13:58:44.264268 [info ] [MainThread]: 
[0m13:58:44.264944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:44.265523 [info ] [MainThread]: 
[0m13:58:44.266404 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:44.268063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:58:44.268803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:44.759128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:58:44.760029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:45.226907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129f853150>]}
[0m13:58:45.227866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:45.236180 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m13:58:45.237177 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m13:58:45.238098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m13:58:45.238676 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m13:58:45.252598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:45.257514 [debug] [Thread-1 (]: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:45.259816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9608f4c4-5458-42ce-a967-fe0ed12f912a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127db8ec10>]}
[0m13:58:45.260875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_glramira.stg_dim_date ................. [[31mERROR[0m in 0.02s]
[0m13:58:45.261732 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m13:58:45.262426 [debug] [Thread-7 (]: Marking all children of 'model.glramira.stg_dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:45.265538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:45.268071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:45.268609 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m13:58:45.269103 [info ] [MainThread]: 
[0m13:58:45.269665 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m13:58:45.270609 [debug] [MainThread]: Command end result
[0m13:58:45.322450 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:58:45.325178 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:58:45.333413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:58:45.334004 [info ] [MainThread]: 
[0m13:58:45.334683 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:58:45.335274 [info ] [MainThread]: 
[0m13:58:45.336013 [error] [MainThread]: [31mFailure in model stg_dim_date (models/staging/stg_dim_date.sql)[0m
[0m13:58:45.336700 [error] [MainThread]:   Compilation Error in model stg_dim_date (models/staging/stg_dim_date.sql)
  'SOURCE' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:45.337217 [info ] [MainThread]: 
[0m13:58:45.337747 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:58:45.338607 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:58:45.340016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5166426, "process_in_blocks": "0", "process_kernel_time": 0.783202, "process_mem_max_rss": "392516", "process_out_blocks": "3472", "process_user_time": 6.337215}
[0m13:58:45.340837 [debug] [MainThread]: Command `dbt run` failed at 13:58:45.340659 after 5.52 seconds
[0m13:58:45.341398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129db48210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a1cf72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a1cf7250>]}
[0m13:58:45.341937 [debug] [MainThread]: Flushing usage events
[0m13:58:45.509268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:20.154124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68957f9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68959a1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68959a1a10>]}


============================== 13:59:20.158832 | 15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3 ==============================
[0m13:59:20.158832 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:59:20.159824 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run -m stg_dim_date', 'quiet': 'False'}
[0m13:59:20.160447 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:59:20.161101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68957f22d0>]}
[0m13:59:23.625483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875f935d0>]}
[0m13:59:23.714415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68983e94d0>]}
[0m13:59:23.715652 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:59:24.034018 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:59:24.234128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:24.234714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:24.243089 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:59:24.301665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875b5d250>]}
[0m13:59:24.447939 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:59:24.450801 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:59:24.470160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6895805c10>]}
[0m13:59:24.471049 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:59:24.471713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875bd0850>]}
[0m13:59:24.473947 [info ] [MainThread]: 
[0m13:59:24.474504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:24.474986 [info ] [MainThread]: 
[0m13:59:24.475824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:24.478756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:59:24.479606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:24.970923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:59:24.971764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:25.419831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875ea13d0>]}
[0m13:59:25.420762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:25.429361 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m13:59:25.430411 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m13:59:25.431359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m13:59:25.431997 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m13:59:25.445304 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m13:59:25.447431 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m13:59:25.488104 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m13:59:25.490234 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as WITH date AS (
    SELECT DISTINCT
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS date_id,
        FORMAT_TIMESTAMP('%m/%d/%Y', TIMESTAMP_SECONDS(time_stamp)) AS full_date,
        CAST(FORMAT_TIMESTAMP('%d', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS day,
        CAST(FORMAT_TIMESTAMP('%m', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS month,
        CAST(FORMAT_TIMESTAMP('%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS year,
        CASE 
            WHEN EXTRACT(DAYOFWEEK FROM TIMESTAMP_SECONDS(time_stamp)) IN (1, 7) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM date;


[0m13:59:25.491028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:26.215487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:934479b8-5efc-472f-858a-3fbcf005d1b5&page=queryresults
[0m13:59:27.284950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d4d4ab-4baa-4db2-a0d3-98fe3a9dcaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875b66a50>]}
[0m13:59:27.286067 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_date ..................... [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m13:59:27.286998 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m13:59:27.289514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:27.292034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:27.292531 [debug] [MainThread]: Connection 'model.glramira.stg_dim_date' was properly closed.
[0m13:59:27.292998 [info ] [MainThread]: 
[0m13:59:27.293667 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m13:59:27.294804 [debug] [MainThread]: Command end result
[0m13:59:27.348936 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:59:27.351876 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:59:27.359594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:59:27.360162 [info ] [MainThread]: 
[0m13:59:27.360851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:27.361461 [info ] [MainThread]: 
[0m13:59:27.362111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:59:27.362987 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:59:27.364774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2900414, "process_in_blocks": "16", "process_kernel_time": 0.935401, "process_mem_max_rss": "397232", "process_out_blocks": "3488", "process_user_time": 6.452642}
[0m13:59:27.365558 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:27.365396 after 7.29 seconds
[0m13:59:27.366159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689591eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6899c9a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68999c3190>]}
[0m13:59:27.366735 [debug] [MainThread]: Flushing usage events
[0m13:59:27.593060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:36.708211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a9f33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a9f3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a9f2d10>]}


============================== 13:59:36.712795 | 4831de19-01e7-4eb9-b328-88bdb5e90ed2 ==============================
[0m13:59:36.712795 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:59:36.713657 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select glramira.staging', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'no_print': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m13:59:40.242926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a9f9910>]}
[0m13:59:40.329301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80d5f9510>]}
[0m13:59:40.330388 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:59:40.571836 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:59:40.753640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:40.754315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:40.762584 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m13:59:40.818693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eae57010>]}
[0m13:59:40.951697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:59:40.954589 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:59:40.974913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eab47350>]}
[0m13:59:40.975797 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m13:59:40.976441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eae6e2d0>]}
[0m13:59:40.979249 [info ] [MainThread]: 
[0m13:59:40.979857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:40.980365 [info ] [MainThread]: 
[0m13:59:40.981270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:40.987995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m13:59:40.988835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:41.444520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m13:59:41.445365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:41.892347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eb1b4f90>]}
[0m13:59:41.893215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:41.901512 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m13:59:41.902346 [debug] [Thread-2 (]: Began running node model.glramira.stg_dim_device
[0m13:59:41.903195 [debug] [Thread-3 (]: Began running node model.glramira.stg_dim_location
[0m13:59:41.904042 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m13:59:41.904975 [debug] [Thread-4 (]: Began running node model.glramira.stg_dim_product
[0m13:59:41.905788 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m13:59:41.906770 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m13:59:41.907773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m13:59:41.908599 [info ] [Thread-4 (]: 4 of 7 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m13:59:41.909566 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_device'
[0m13:59:41.910556 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_location'
[0m13:59:41.911319 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m13:59:41.912283 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_product'
[0m13:59:41.913045 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_dim_device
[0m13:59:41.913702 [debug] [Thread-3 (]: Began compiling node model.glramira.stg_dim_location
[0m13:59:41.927675 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m13:59:41.928572 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_dim_product
[0m13:59:41.934139 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m13:59:41.939772 [debug] [Thread-3 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m13:59:41.945374 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m13:59:41.947035 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m13:59:41.948323 [debug] [Thread-3 (]: Began executing node model.glramira.stg_dim_location
[0m13:59:41.949015 [debug] [Thread-2 (]: Began executing node model.glramira.stg_dim_device
[0m13:59:41.960294 [debug] [Thread-4 (]: Began executing node model.glramira.stg_dim_product
[0m13:59:42.024026 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m13:59:42.028546 [debug] [Thread-3 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m13:59:42.029851 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m13:59:42.034796 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m13:59:42.036293 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as WITH date AS (
    SELECT DISTINCT
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS date_id,
        FORMAT_TIMESTAMP('%m/%d/%Y', TIMESTAMP_SECONDS(time_stamp)) AS full_date,
        CAST(FORMAT_TIMESTAMP('%d', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS day,
        CAST(FORMAT_TIMESTAMP('%m', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS month,
        CAST(FORMAT_TIMESTAMP('%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS year,
        CASE 
            WHEN EXTRACT(DAYOFWEEK FROM TIMESTAMP_SECONDS(time_stamp)) IN (1, 7) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM date;


[0m13:59:42.037672 [debug] [Thread-3 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as WITH location AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(city AS STRING), ''),
                COALESCE(CAST(region AS STRING), '')
            )
        ) AS location_id,
        CAST(country AS STRING) AS country,
        CAST(country_code AS STRING) AS country_code,
        CAST(region AS STRING) AS region,
        CAST(city AS STRING) AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
)
SELECT * FROM location;


[0m13:59:42.039147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:42.039997 [debug] [Thread-4 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as WITH product AS (
      SELECT
        CAST(product_id AS INT64) AS product_id,
        CAST(product_name AS STRING) AS product_name,
        CAST(product_price AS FLOAT64) AS product_price,
        CAST(min_price AS FLOAT64) AS min_price,
        CAST(max_price AS FLOAT64) AS max_price,
        CAST(min_price_format AS STRING) AS min_price_format,
        CAST(max_price_format AS STRING) AS max_price_format

      FROM `project-data-engineer-469310`.`product_info`.`product`
  )
SELECT * FROM product
WHERE product_id != 101993;


[0m13:59:42.040852 [debug] [Thread-2 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as WITH device AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) AS device_id,

        CAST(device_id AS STRING) AS raw_device_id,
        CAST(resolution AS STRING) AS resolution,
        CAST(user_agent AS STRING) AS user_agent,
        CASE
            WHEN regexp_contains(user_agent, r'Windows NT [0-9._]+') 
                THEN regexp_extract(user_agent, r'Windows NT [0-9._]+')
            WHEN regexp_contains(user_agent, r'Android\s+[0-9._]+') 
                THEN regexp_extract(user_agent, r'Android\s+[0-9._]+')
            WHEN regexp_contains(user_agent, r'iPhone OS [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Mac OS X [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,
        CASE
            WHEN regexp_contains(user_agent, r'SM-[^;\)]+') 
                THEN regexp_extract(user_agent, r'SM-[^;\)]+')
            WHEN regexp_contains(user_agent, r'LG-[^;\)]+') 
                THEN regexp_extract(user_agent, r'LG-[^;\)]+')
            WHEN regexp_contains(user_agent, r'MI [^;\)]+') 
                THEN regexp_extract(user_agent, r'MI [^;\)]+')
            WHEN regexp_contains(user_agent, r'Windows') 
                THEN 'PC Windows'
            WHEN regexp_contains(user_agent, r'Macintosh') THEN 'Mac'
            WHEN regexp_contains(user_agent, r'iPhone') THEN 'iPhone'
            WHEN regexp_contains(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
        END AS device_model,
        CASE
            WHEN regexp_contains(user_agent, r'Mobile') THEN 'Mobile'
            WHEN regexp_contains(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM device;


[0m13:59:42.041581 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:42.042507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:59:42.079964 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:42.992414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e25c680b-6767-411d-8912-02292bfa5568&page=queryresults
[0m13:59:43.007924 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:382aa3cd-dc73-4452-a279-5a714688568e&page=queryresults
[0m13:59:43.012327 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e003c752-ed37-4ed8-b7a4-bac89134e0de&page=queryresults
[0m13:59:43.017279 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b690e6b4-93cc-41c5-9528-45f5bf3931c1&page=queryresults
[0m13:59:43.909089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eac76950>]}
[0m13:59:43.912728 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2e9b7d0>]}
[0m13:59:43.914603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e8150250>]}
[0m13:59:43.915269 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eb00b8d0>]}
[0m13:59:43.916494 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m13:59:43.917805 [info ] [Thread-4 (]: 4 of 7 OK created sql view model dbt_glramira.stg_dim_product .................. [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m13:59:43.919324 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_glramira.stg_dim_date ..................... [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m13:59:43.920674 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m13:59:43.921727 [debug] [Thread-3 (]: Finished running node model.glramira.stg_dim_location
[0m13:59:43.922793 [debug] [Thread-4 (]: Finished running node model.glramira.stg_dim_product
[0m13:59:43.924035 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m13:59:43.925211 [debug] [Thread-2 (]: Finished running node model.glramira.stg_dim_device
[0m13:59:43.925993 [debug] [Thread-3 (]: Began running node model.glramira.stg_dim_store
[0m13:59:43.926875 [debug] [Thread-4 (]: Began running node model.glramira.stg_dim_user
[0m13:59:43.927827 [debug] [Thread-1 (]: Began running node model.glramira.stg_fact_orders
[0m13:59:43.929131 [info ] [Thread-3 (]: 5 of 7 START sql view model dbt_glramira.stg_dim_store ......................... [RUN]
[0m13:59:43.930198 [info ] [Thread-4 (]: 6 of 7 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m13:59:43.931096 [info ] [Thread-1 (]: 7 of 7 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m13:59:43.932143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_location, now model.glramira.stg_dim_store)
[0m13:59:43.932900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_product, now model.glramira.stg_dim_user)
[0m13:59:43.933594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_date, now model.glramira.stg_fact_orders)
[0m13:59:43.934332 [debug] [Thread-3 (]: Began compiling node model.glramira.stg_dim_store
[0m13:59:43.935044 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_dim_user
[0m13:59:43.935706 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_fact_orders
[0m13:59:43.942259 [debug] [Thread-3 (]: Writing injected SQL for node "model.glramira.stg_dim_store"
[0m13:59:43.947209 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m13:59:43.953470 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m13:59:43.955330 [debug] [Thread-3 (]: Began executing node model.glramira.stg_dim_store
[0m13:59:43.961343 [debug] [Thread-4 (]: Began executing node model.glramira.stg_dim_user
[0m13:59:43.960688 [debug] [Thread-3 (]: Writing runtime sql for node "model.glramira.stg_dim_store"
[0m13:59:43.962213 [debug] [Thread-1 (]: Began executing node model.glramira.stg_fact_orders
[0m13:59:43.967069 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m13:59:43.972297 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m13:59:43.973236 [debug] [Thread-3 (]: On model.glramira.stg_dim_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_store"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  OPTIONS()
  as WITH orders AS (
    SELECT DISTINCT
        CAST(store_id AS INT64) AS store_id,
        CONCAT('glamira_', CAST(store_id AS STRING)) AS store_name
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM orders;


[0m13:59:43.974375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:43.977874 [debug] [Thread-1 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as WITH 
ip_data AS (
    SELECT DISTINCT
        CAST(ip AS STRING) AS ip,
        COALESCE(CAST(country AS STRING), '') AS country,
        COALESCE(CAST(country_code AS STRING), '') AS country_code,
        COALESCE(CAST(region AS STRING), '') AS region,
        COALESCE(CAST(city AS STRING), '') AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate AS (
    SELECT
        COALESCE(CAST(symbol AS STRING), '') AS symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) AS exchange_rate
    FROM `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    FROM `project-data-engineer-469310`.`product_info`.`event` AS e1
    CROSS JOIN UNNEST(e1.cart_products) AS cp
    WHERE e1.collection = 'checkout_success'
)

SELECT
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
FROM base b
LEFT JOIN ip_data e2
    ON b.ip_address = e2.ip
LEFT JOIN exchange_rate e3
    ON b.currency = e3.symbol;


[0m13:59:44.014049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:44.015189 [debug] [Thread-4 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as WITH user AS (
    SELECT DISTINCT
        farm_fingerprint(concat(
        coalesce(cast((email_address) as string), '')
    )) AS user_id,
        CAST(email_address AS STRING) AS email_address
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM user;


[0m13:59:44.055885 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:59:44.834769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:ef85d575-dc93-4d3e-9b00-5970eaf69b21&page=queryresults
[0m13:59:44.846122 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:90a9972a-69f2-43eb-a538-82989aeec115&page=queryresults
[0m13:59:44.849500 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:442ed375-af86-4b75-afb2-a507c07efed1&page=queryresults
[0m13:59:45.663641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7eae7fe90>]}
[0m13:59:45.671019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2de1f90>]}
[0m13:59:45.675490 [info ] [Thread-3 (]: 5 of 7 OK created sql view model dbt_glramira.stg_dim_store .................... [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m13:59:45.678106 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m13:59:45.681229 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4831de19-01e7-4eb9-b328-88bdb5e90ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2e9b450>]}
[0m13:59:45.682274 [debug] [Thread-3 (]: Finished running node model.glramira.stg_dim_store
[0m13:59:45.683318 [debug] [Thread-1 (]: Finished running node model.glramira.stg_fact_orders
[0m13:59:45.684330 [info ] [Thread-4 (]: 6 of 7 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m13:59:45.685926 [debug] [Thread-4 (]: Finished running node model.glramira.stg_dim_user
[0m13:59:45.688566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:45.690908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:45.691601 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m13:59:45.692302 [debug] [MainThread]: Connection 'model.glramira.stg_dim_device' was properly closed.
[0m13:59:45.692794 [debug] [MainThread]: Connection 'model.glramira.stg_dim_store' was properly closed.
[0m13:59:45.693263 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m13:59:45.693880 [info ] [MainThread]: 
[0m13:59:45.694407 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m13:59:45.696515 [debug] [MainThread]: Command end result
[0m13:59:45.752894 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m13:59:45.755775 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m13:59:45.764381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m13:59:45.765010 [info ] [MainThread]: 
[0m13:59:45.765695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:45.766216 [info ] [MainThread]: 
[0m13:59:45.766787 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:59:45.768152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.134745, "process_in_blocks": "0", "process_kernel_time": 0.815801, "process_mem_max_rss": "404664", "process_out_blocks": "3648", "process_user_time": 8.278262}
[0m13:59:45.768830 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:45.768677 after 9.14 seconds
[0m13:59:45.769466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80aa5c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80ebd7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80ec98210>]}
[0m13:59:45.770044 [debug] [MainThread]: Flushing usage events
[0m13:59:45.966783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:09.684368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0e07310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0e05a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0e06e10>]}


============================== 14:03:09.689181 | 89ebcf02-0a01-4cfd-9b73-766be6d2ebc7 ==============================
[0m14:03:09.689181 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:09.690041 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select glramira.staging', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'partial_parse': 'True'}
[0m14:03:13.268593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d1373850>]}
[0m14:03:13.357154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f39d90d0>]}
[0m14:03:13.358236 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:03:13.608846 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:03:13.793279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:13.793939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:13.802284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.glramira.example
[0m14:03:13.860265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0db2e50>]}
[0m14:03:14.000577 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m14:03:14.003634 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m14:03:14.023938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f2157c10>]}
[0m14:03:14.024819 [info ] [MainThread]: Found 7 models, 15 data tests, 4 sources, 762 macros
[0m14:03:14.025525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f2bb4050>]}
[0m14:03:14.029039 [info ] [MainThread]: 
[0m14:03:14.029681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:14.030189 [info ] [MainThread]: 
[0m14:03:14.031002 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:03:14.037071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m14:03:14.037882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:14.519509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m14:03:14.520420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:14.964973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f13ec9d0>]}
[0m14:03:14.965866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:14.974447 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_date
[0m14:03:14.975297 [debug] [Thread-2 (]: Began running node model.glramira.stg_dim_device
[0m14:03:14.976272 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_glramira.stg_dim_date .......................... [RUN]
[0m14:03:14.977102 [debug] [Thread-3 (]: Began running node model.glramira.stg_dim_location
[0m14:03:14.977793 [debug] [Thread-4 (]: Began running node model.glramira.stg_dim_product
[0m14:03:14.978709 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_glramira.stg_dim_device ........................ [RUN]
[0m14:03:14.979646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_date)
[0m14:03:14.980625 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_glramira.stg_dim_location ...................... [RUN]
[0m14:03:14.981598 [info ] [Thread-4 (]: 4 of 7 START sql view model dbt_glramira.stg_dim_product ....................... [RUN]
[0m14:03:14.982611 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_device'
[0m14:03:14.983286 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_date
[0m14:03:14.984330 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_location'
[0m14:03:14.985147 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.glramira.stg_dim_product'
[0m14:03:14.985794 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_dim_device
[0m14:03:14.999103 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_date"
[0m14:03:14.999965 [debug] [Thread-3 (]: Began compiling node model.glramira.stg_dim_location
[0m14:03:15.000818 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_dim_product
[0m14:03:15.006363 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_dim_device"
[0m14:03:15.011783 [debug] [Thread-3 (]: Writing injected SQL for node "model.glramira.stg_dim_location"
[0m14:03:15.012620 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_date
[0m14:03:15.017487 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_dim_product"
[0m14:03:15.018692 [debug] [Thread-2 (]: Began executing node model.glramira.stg_dim_device
[0m14:03:15.030315 [debug] [Thread-3 (]: Began executing node model.glramira.stg_dim_location
[0m14:03:15.092934 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_date"
[0m14:03:15.093808 [debug] [Thread-4 (]: Began executing node model.glramira.stg_dim_product
[0m14:03:15.094414 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_dim_device"
[0m14:03:15.098384 [debug] [Thread-3 (]: Writing runtime sql for node "model.glramira.stg_dim_location"
[0m14:03:15.103584 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_dim_product"
[0m14:03:15.104520 [debug] [Thread-1 (]: On model.glramira.stg_dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_date"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  OPTIONS()
  as WITH date AS (
    SELECT DISTINCT
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS date_id,
        FORMAT_TIMESTAMP('%m/%d/%Y', TIMESTAMP_SECONDS(time_stamp)) AS full_date,
        CAST(FORMAT_TIMESTAMP('%d', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS day,
        CAST(FORMAT_TIMESTAMP('%m', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS month,
        CAST(FORMAT_TIMESTAMP('%Y', TIMESTAMP_SECONDS(time_stamp)) AS INT64) AS year,
        CASE 
            WHEN EXTRACT(DAYOFWEEK FROM TIMESTAMP_SECONDS(time_stamp)) IN (1, 7) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM date;


[0m14:03:15.105981 [debug] [Thread-2 (]: On model.glramira.stg_dim_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_device"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  OPTIONS()
  as WITH device AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(device_id, ''),
                COALESCE(user_agent, ''),
                COALESCE(resolution, '')
            )
        ) AS device_id,

        CAST(device_id AS STRING) AS raw_device_id,
        CAST(resolution AS STRING) AS resolution,
        CAST(user_agent AS STRING) AS user_agent,
        CASE
            WHEN regexp_contains(user_agent, r'Windows NT [0-9._]+') 
                THEN regexp_extract(user_agent, r'Windows NT [0-9._]+')
            WHEN regexp_contains(user_agent, r'Android\s+[0-9._]+') 
                THEN regexp_extract(user_agent, r'Android\s+[0-9._]+')
            WHEN regexp_contains(user_agent, r'iPhone OS [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'iPhone OS [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Mac OS X [0-9_]+') 
                THEN replace(regexp_extract(user_agent, r'Mac OS X [0-9_]+'), '_', '.')
            WHEN regexp_contains(user_agent, r'Linux') THEN 'Linux'
            ELSE 'Other'
        END AS os,
        CASE
            WHEN regexp_contains(user_agent, r'SM-[^;\)]+') 
                THEN regexp_extract(user_agent, r'SM-[^;\)]+')
            WHEN regexp_contains(user_agent, r'LG-[^;\)]+') 
                THEN regexp_extract(user_agent, r'LG-[^;\)]+')
            WHEN regexp_contains(user_agent, r'MI [^;\)]+') 
                THEN regexp_extract(user_agent, r'MI [^;\)]+')
            WHEN regexp_contains(user_agent, r'Windows') 
                THEN 'PC Windows'
            WHEN regexp_contains(user_agent, r'Macintosh') THEN 'Mac'
            WHEN regexp_contains(user_agent, r'iPhone') THEN 'iPhone'
            WHEN regexp_contains(user_agent, r'iPad') THEN 'iPad'
            ELSE 'Unknown'
        END AS device_model,
        CASE
            WHEN regexp_contains(user_agent, r'Mobile') THEN 'Mobile'
            WHEN regexp_contains(user_agent, r'Tablet') THEN 'Tablet'
            ELSE 'Desktop'
        END AS device_type

    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM device;


[0m14:03:15.107448 [debug] [Thread-3 (]: On model.glramira.stg_dim_location: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_location"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  OPTIONS()
  as WITH location AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(country AS STRING), ''),
                COALESCE(CAST(country_code AS STRING), ''),
                COALESCE(CAST(city AS STRING), ''),
                COALESCE(CAST(region AS STRING), '')
            )
        ) AS location_id,
        CAST(country AS STRING) AS country,
        CAST(country_code AS STRING) AS country_code,
        CAST(region AS STRING) AS region,
        CAST(city AS STRING) AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
)
SELECT * FROM location;


[0m14:03:15.108318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:15.108986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:15.109867 [debug] [Thread-4 (]: On model.glramira.stg_dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_product"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  OPTIONS()
  as WITH product AS (
      SELECT
        CAST(product_id AS INT64) AS product_id,
        CAST(product_name AS STRING) AS product_name,
        CAST(product_price AS FLOAT64) AS product_price,
        CAST(min_price AS FLOAT64) AS min_price,
        CAST(max_price AS FLOAT64) AS max_price,
        CAST(min_price_format AS STRING) AS min_price_format,
        CAST(max_price_format AS STRING) AS max_price_format

      FROM `project-data-engineer-469310`.`product_info`.`product`
  )
SELECT * FROM product
WHERE product_id != 101993;


[0m14:03:15.110498 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:03:15.150159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:03:16.104372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7fdc9e32-5140-4cf5-bda5-40f7c2fc110c&page=queryresults
[0m14:03:16.106860 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:49563d74-60cd-43e4-a6d1-27ba42b74a89&page=queryresults
[0m14:03:16.263641 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:010fe5d9-9738-4cb5-80e0-eb687660791f&page=queryresults
[0m14:03:16.264739 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:78a15533-da93-47fc-bbba-8ac1dcb98abf&page=queryresults
[0m14:03:16.915217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d135b490>]}
[0m14:03:16.917016 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_glramira.stg_dim_device ................... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m14:03:16.918606 [debug] [Thread-2 (]: Finished running node model.glramira.stg_dim_device
[0m14:03:16.920491 [debug] [Thread-2 (]: Began running node model.glramira.stg_dim_store
[0m14:03:16.922747 [info ] [Thread-2 (]: 5 of 7 START sql view model dbt_glramira.stg_dim_store ......................... [RUN]
[0m14:03:16.924373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_device, now model.glramira.stg_dim_store)
[0m14:03:16.930915 [debug] [Thread-2 (]: Began compiling node model.glramira.stg_dim_store
[0m14:03:16.942719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0d7e0d0>]}
[0m14:03:16.947153 [debug] [Thread-2 (]: Writing injected SQL for node "model.glramira.stg_dim_store"
[0m14:03:16.951782 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d1358e90>]}
[0m14:03:16.952888 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_glramira.stg_dim_date ..................... [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m14:03:16.954591 [info ] [Thread-4 (]: 4 of 7 OK created sql view model dbt_glramira.stg_dim_product .................. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m14:03:16.956098 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_date
[0m14:03:16.957335 [debug] [Thread-4 (]: Finished running node model.glramira.stg_dim_product
[0m14:03:16.958208 [debug] [Thread-2 (]: Began executing node model.glramira.stg_dim_store
[0m14:03:16.959047 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m14:03:16.959995 [debug] [Thread-4 (]: Began running node model.glramira.stg_fact_orders
[0m14:03:16.965601 [debug] [Thread-2 (]: Writing runtime sql for node "model.glramira.stg_dim_store"
[0m14:03:16.967477 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m14:03:16.972666 [info ] [Thread-4 (]: 7 of 7 START sql view model dbt_glramira.stg_fact_orders ....................... [RUN]
[0m14:03:16.977607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0d7c9d0>]}
[0m14:03:16.978646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_date, now model.glramira.stg_dim_user)
[0m14:03:16.979762 [debug] [Thread-2 (]: On model.glramira.stg_dim_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_store"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  OPTIONS()
  as WITH orders AS (
    SELECT DISTINCT
        CAST(store_id AS INT64) AS store_id,
        CONCAT('glamira_', CAST(store_id AS STRING)) AS store_name
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM orders;


[0m14:03:16.980658 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.glramira.stg_dim_product, now model.glramira.stg_fact_orders)
[0m14:03:16.981844 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_glramira.stg_dim_location ................. [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m14:03:16.982599 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m14:03:16.983291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:03:16.983969 [debug] [Thread-4 (]: Began compiling node model.glramira.stg_fact_orders
[0m14:03:16.985025 [debug] [Thread-3 (]: Finished running node model.glramira.stg_dim_location
[0m14:03:16.991160 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m14:03:17.035626 [debug] [Thread-4 (]: Writing injected SQL for node "model.glramira.stg_fact_orders"
[0m14:03:17.037555 [debug] [Thread-4 (]: Began executing node model.glramira.stg_fact_orders
[0m14:03:17.038624 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m14:03:17.043728 [debug] [Thread-4 (]: Writing runtime sql for node "model.glramira.stg_fact_orders"
[0m14:03:17.050755 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m14:03:17.052450 [debug] [Thread-4 (]: On model.glramira.stg_fact_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_fact_orders"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  OPTIONS()
  as WITH 
ip_data AS (
    SELECT DISTINCT
        CAST(ip AS STRING) AS ip,
        COALESCE(CAST(country AS STRING), '') AS country,
        COALESCE(CAST(country_code AS STRING), '') AS country_code,
        COALESCE(CAST(region AS STRING), '') AS region,
        COALESCE(CAST(city AS STRING), '') AS city
    FROM `project-data-engineer-469310`.`product_info`.`ip_locations`
),
exchange_rate AS (
    SELECT
        COALESCE(CAST(symbol AS STRING), '') AS symbol,
        COALESCE(CAST(exchange_rate_to_usd AS FLOAT64), 0) AS exchange_rate
    FROM `project-data-engineer-469310`.`product_info`.`exchange_rate`
),
base AS (
    SELECT DISTINCT
        farm_fingerprint(
            CONCAT(
                COALESCE(CAST(e1.order_id AS STRING), ''),
                COALESCE(CAST(cp.product_id AS STRING), ''),
                COALESCE(CAST(e1.device_id AS STRING), '')
            )
        ) AS event_id,
        SAFE_CAST(REPLACE(CAST(e1.order_id AS STRING), '.0', '') AS INT64) AS order_id,
        COALESCE(CAST(cp.product_id AS INT64), 0) AS product_id,
        CAST(e1.device_id AS STRING) AS raw_device_id,
        CAST(FORMAT_TIMESTAMP('%m%d%Y', TIMESTAMP_SECONDS(e1.time_stamp)) AS INT64) AS date_id,
        COALESCE(CAST(e1.store_id AS INT64), 0) AS store_id,
        farm_fingerprint(
            CONCAT(
                COALESCE(e1.device_id, ''),
                COALESCE(e1.user_agent, ''),
                COALESCE(e1.resolution, '')
            )
        ) AS device_id,
        farm_fingerprint(COALESCE(CAST(e1.email_address AS STRING), '')) AS user_id,
        CAST(e1.ip AS STRING) AS ip_address,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS price,
        SAFE_CAST(
            REGEXP_REPLACE(
                REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                r'[^0-9]', ''                                               
            ) AS INT64
        ) AS amount,

        CAST(cp.currency AS STRING) AS currency,
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.price AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        )
        *
        COALESCE(
            SAFE_CAST(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(CAST(cp.amount AS STRING), r'[.,]00\b', ''),  
                    r'[^0-9]', ''                                               
                ) AS INT64
            ),
            0
        ) AS final_amount,

        CAST(e1.is_paypal AS STRING) AS is_paypal

    FROM `project-data-engineer-469310`.`product_info`.`event` AS e1
    CROSS JOIN UNNEST(e1.cart_products) AS cp
    WHERE e1.collection = 'checkout_success'
)

SELECT
    b.*,
    farm_fingerprint(
        CONCAT(
            COALESCE(e2.country, ''),
            COALESCE(e2.country_code, ''),
            COALESCE(e2.region, ''),
            COALESCE(e2.city, '')
        )
    ) AS location_id,
    e3.exchange_rate
FROM base b
LEFT JOIN ip_data e2
    ON b.ip_address = e2.ip
LEFT JOIN exchange_rate e3
    ON b.currency = e3.symbol;


[0m14:03:17.053416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:03:17.054284 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as WITH user AS (
    SELECT DISTINCT
        farm_fingerprint(concat(
        coalesce(cast((email_address) as string), '')
    )) AS user_id,
        CAST(email_address AS STRING) AS email_address
    FROM `project-data-engineer-469310`.`product_info`.`event`
)
SELECT * FROM user;


[0m14:03:17.055149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:17.821301 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fe587496-744b-4c2a-8be0-082400ae91e5&page=queryresults
[0m14:03:17.871562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:60d70a41-4379-4f4d-bca7-defa1be733a4&page=queryresults
[0m14:03:17.900882 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:793b38c2-aa1d-4fe9-bff8-7c7382a57b30&page=queryresults
[0m14:03:18.633671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0c99b90>]}
[0m14:03:18.634835 [info ] [Thread-2 (]: 5 of 7 OK created sql view model dbt_glramira.stg_dim_store .................... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m14:03:18.635773 [debug] [Thread-2 (]: Finished running node model.glramira.stg_dim_store
[0m14:03:18.684230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0bd2210>]}
[0m14:03:18.685428 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m14:03:18.686415 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m14:03:18.712748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ebcf02-0a01-4cfd-9b73-766be6d2ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d0c7f810>]}
[0m14:03:18.713924 [info ] [Thread-4 (]: 7 of 7 OK created sql view model dbt_glramira.stg_fact_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m14:03:18.714885 [debug] [Thread-4 (]: Finished running node model.glramira.stg_fact_orders
[0m14:03:18.717529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:18.720053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:18.720622 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m14:03:18.721130 [debug] [MainThread]: Connection 'model.glramira.stg_dim_store' was properly closed.
[0m14:03:18.721708 [debug] [MainThread]: Connection 'model.glramira.stg_dim_location' was properly closed.
[0m14:03:18.722228 [debug] [MainThread]: Connection 'model.glramira.stg_fact_orders' was properly closed.
[0m14:03:18.722835 [info ] [MainThread]: 
[0m14:03:18.723360 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m14:03:18.725429 [debug] [MainThread]: Command end result
[0m14:03:18.779904 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m14:03:18.782991 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m14:03:18.792151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m14:03:18.792787 [info ] [MainThread]: 
[0m14:03:18.793507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:18.794108 [info ] [MainThread]: 
[0m14:03:18.794653 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:03:18.796164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.187948, "process_in_blocks": "0", "process_kernel_time": 0.861506, "process_mem_max_rss": "404384", "process_out_blocks": "3664", "process_user_time": 8.426215}
[0m14:03:18.796890 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:18.796723 after 9.19 seconds
[0m14:03:18.797486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0dfe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0c6ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4fbb010>]}
[0m14:03:18.798088 [debug] [MainThread]: Flushing usage events
[0m14:03:19.020142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:04.221487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82952e9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829531d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829531d5d0>]}


============================== 15:05:04.227023 | 283bcc0c-bcc2-44b7-84ee-a3f61c43bc5a ==============================
[0m15:05:04.227023 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:05:04.227937 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:05:04.392293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283bcc0c-bcc2-44b7-84ee-a3f61c43bc5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82953542d0>]}
[0m15:05:04.429333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qnkjatpv'
[0m15:05:04.430226 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:05:04.590062 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:05:04.593797 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m15:05:04.698438 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m15:05:04.702798 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m15:05:04.703738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '283bcc0c-bcc2-44b7-84ee-a3f61c43bc5a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8295346c90>]}
[0m15:05:04.708572 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m15:05:04.813811 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m15:05:04.819704 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m15:05:05.270924 [info ] [MainThread]: Installed from version 0.10.4
[0m15:05:05.271734 [info ] [MainThread]: Up to date!
[0m15:05:05.272510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '283bcc0c-bcc2-44b7-84ee-a3f61c43bc5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82962b4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8295062a10>]}
[0m15:05:05.273276 [info ] [MainThread]: Installing calogica/dbt_date
[0m15:05:05.441423 [info ] [MainThread]: Installed from version 0.10.1
[0m15:05:05.442223 [info ] [MainThread]: Up to date!
[0m15:05:05.442897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '283bcc0c-bcc2-44b7-84ee-a3f61c43bc5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82951e0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82962df990>]}
[0m15:05:05.445709 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:05:05.448539 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2995676, "process_in_blocks": "72", "process_kernel_time": 0.296154, "process_mem_max_rss": "111128", "process_out_blocks": "20848", "process_user_time": 2.500762}
[0m15:05:05.449386 [debug] [MainThread]: Command `cli deps` succeeded at 15:05:05.449191 after 1.30 seconds
[0m15:05:05.449999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8299608f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82996090d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82952c7810>]}
[0m15:05:05.450679 [debug] [MainThread]: Flushing usage events
[0m15:05:05.678714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:16.730662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b20f0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b20f2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b20e9d10>]}


============================== 15:05:16.735619 | 8f78f303-0fab-4705-ac32-e73f80a50d84 ==============================
[0m15:05:16.735619 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:05:16.736627 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select glramira.marts', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False'}
[0m15:05:20.173688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b21406d0>]}
[0m15:05:20.278422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b4d15590>]}
[0m15:05:20.279629 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:05:20.532947 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:05:20.723117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:20.723826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:20.787473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b2f69fd0>]}
[0m15:05:20.932739 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:05:20.935881 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:05:20.995628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7920affd0>]}
[0m15:05:20.996566 [info ] [MainThread]: Found 8 models, 27 data tests, 4 sources, 762 macros
[0m15:05:21.000341 [info ] [MainThread]: 
[0m15:05:21.001083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:21.001724 [info ] [MainThread]: 
[0m15:05:21.002824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:05:21.004582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m15:05:21.005499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:21.508165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m15:05:21.509158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:21.967719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792698690>]}
[0m15:05:21.968585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:21.977027 [debug] [Thread-1 (]: Began running node model.glramira.fct_orders
[0m15:05:21.977997 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_glramira.fct_orders .......................... [RUN]
[0m15:05:21.979107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.fct_orders)
[0m15:05:21.979813 [debug] [Thread-1 (]: Began compiling node model.glramira.fct_orders
[0m15:05:21.997221 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.fct_orders"
[0m15:05:21.998307 [debug] [Thread-1 (]: Began executing node model.glramira.fct_orders
[0m15:05:22.053061 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.fct_orders"
[0m15:05:22.054316 [debug] [Thread-1 (]: On model.glramira.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.fct_orders"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
      
    
    

    
    OPTIONS()
    as (
      

WITH
  fact AS (
    SELECT
      event_id,
      order_id,
      product_id,
      device_id,
      user_id,
      date_id,
      store_id,
      location_id,
      currency,
      price,
      amount,
      final_amount,
      exchange_rate,
      CAST(final_amount * COALESCE(exchange_rate, 1) AS FLOAT64) AS final_amount_usd,
      is_paypal
    FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  )
,
  dim_date AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  )
,
  dim_user AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  )
,
  dim_product AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  )
,
  dim_store AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  )
,
  dim_device AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  )
,
  dim_location AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  )

SELECT
  f.event_id,
  f.order_id,
  f.product_id,
  p.product_name,
  p.product_price,
  f.user_id,
  u.email_address AS user_email,
  f.device_id,
  dvc.os AS device_os,
  dvc.device_model,
  dvc.device_type,
  f.date_id,
  dt.full_date,
  dt.day,
  dt.month,
  dt.year,
  dt.is_weekend,
  f.store_id,
  st.store_name,
  f.location_id,
  loc.country,
  loc.country_code,
  loc.region,
  loc.city,
  f.currency,
  f.price,
  f.amount,
  f.final_amount,
  f.exchange_rate,
  f.final_amount_usd,
  f.is_paypal
FROM fact f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_device dvc ON f.device_id = dvc.device_id
LEFT JOIN dim_date dt ON f.date_id = dt.date_id
LEFT JOIN dim_store st ON f.store_id = st.store_id
LEFT JOIN dim_location loc ON f.location_id = loc.location_id
    );
  
[0m15:05:22.055075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:24.124296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:743e0490-12c8-4269-9e79-b862e6cd5ae9&page=queryresults
[0m15:05:29.394272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f78f303-0fab-4705-ac32-e73f80a50d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79265c890>]}
[0m15:05:29.395490 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_glramira.fct_orders ..................... [[32mCREATE TABLE (46.5k rows, 8.9 GiB processed)[0m in 7.41s]
[0m15:05:29.396542 [debug] [Thread-1 (]: Finished running node model.glramira.fct_orders
[0m15:05:29.398418 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:05:29.399186 [debug] [Thread-4 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:05:29.400326 [debug] [Thread-2 (]: Began running node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:05:29.400944 [info ] [Thread-3 (]: 2 of 13 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True  [RUN]
[0m15:05:29.401853 [debug] [Thread-1 (]: Began running node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:05:29.402451 [info ] [Thread-4 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True  [RUN]
[0m15:05:29.403220 [info ] [Thread-2 (]: 4 of 13 START test not_null_fct_orders_event_id ................................ [RUN]
[0m15:05:29.404308 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c'
[0m15:05:29.404992 [info ] [Thread-1 (]: 5 of 13 START test not_null_fct_orders_order_id ................................ [RUN]
[0m15:05:29.405942 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908'
[0m15:05:29.407116 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.not_null_fct_orders_event_id.797f989776'
[0m15:05:29.407846 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:05:29.408648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.fct_orders, now test.glramira.not_null_fct_orders_order_id.4e687af8d0)
[0m15:05:29.409373 [debug] [Thread-4 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:05:29.409993 [debug] [Thread-2 (]: Began compiling node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:05:29.431552 [debug] [Thread-1 (]: Began compiling node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:05:29.439456 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"
[0m15:05:29.447753 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"
[0m15:05:29.470150 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_event_id.797f989776"
[0m15:05:29.470994 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_order_id.4e687af8d0"
[0m15:05:29.472779 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:05:29.473949 [debug] [Thread-2 (]: Began executing node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:05:29.480155 [debug] [Thread-1 (]: Began executing node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:05:29.491945 [debug] [Thread-4 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:05:29.506871 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"
[0m15:05:29.508309 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_event_id.797f989776"
[0m15:05:29.512901 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_order_id.4e687af8d0"
[0m15:05:29.517563 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"
[0m15:05:29.519600 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and final_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:05:29.520727 [debug] [Thread-2 (]: On test.glramira.not_null_fct_orders_event_id.797f989776: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_event_id.797f989776"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:05:29.521867 [debug] [Thread-4 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and final_amount_usd > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:05:29.522630 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:29.523255 [debug] [Thread-1 (]: On test.glramira.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:05:29.524024 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:29.524722 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:29.527946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:30.738299 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:aee9525f-c687-4822-ae19-9813dd19f026&page=queryresults
[0m15:05:30.814587 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a0d3eba9-19c5-4cf7-b032-e23e428e4b88&page=queryresults
[0m15:05:30.816620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:bee0f6c0-7699-4900-a6d8-db52b6b0298d&page=queryresults
[0m15:05:30.821419 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4e3fe5b0-09e8-4453-b5ea-dc1acc50456d&page=queryresults
[0m15:05:31.660330 [error] [Thread-3 (]: 2 of 13 FAIL 7727 dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True  [[31mFAIL 7727[0m in 2.26s]
[0m15:05:31.661731 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:05:31.662806 [debug] [Thread-3 (]: Began running node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:05:31.664004 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c' to be skipped because of status 'fail'.  Reason: Got 7727 results, configured to fail if != 0.
[0m15:05:31.664922 [info ] [Thread-3 (]: 6 of 13 START test not_null_fct_orders_product_id .............................. [RUN]
[0m15:05:31.666854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c, now test.glramira.not_null_fct_orders_product_id.8e73ef4e24)
[0m15:05:31.667713 [debug] [Thread-3 (]: Began compiling node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:05:31.682418 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:05:31.684145 [debug] [Thread-3 (]: Began executing node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:05:31.691717 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:05:31.699225 [info ] [Thread-1 (]: 5 of 13 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 2.29s]
[0m15:05:31.700387 [debug] [Thread-3 (]: On test.glramira.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:05:31.701771 [debug] [Thread-1 (]: Finished running node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:05:31.703250 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:31.704228 [debug] [Thread-1 (]: Began running node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:05:31.711523 [error] [Thread-4 (]: 3 of 13 FAIL 7727 dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True  [[31mFAIL 7727[0m in 2.30s]
[0m15:05:31.766083 [info ] [Thread-1 (]: 7 of 13 START test relationships_fct_orders_date_id__date_id__ref_stg_dim_date_  [RUN]
[0m15:05:31.771022 [info ] [Thread-2 (]: 4 of 13 PASS not_null_fct_orders_event_id ...................................... [[32mPASS[0m in 2.36s]
[0m15:05:31.772176 [debug] [Thread-4 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:05:31.773464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_order_id.4e687af8d0, now test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0)
[0m15:05:31.774735 [debug] [Thread-2 (]: Finished running node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:05:31.775786 [debug] [Thread-4 (]: Began running node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:05:31.776820 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908' to be skipped because of status 'fail'.  Reason: Got 7727 results, configured to fail if != 0.
[0m15:05:31.777971 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:05:31.779117 [debug] [Thread-2 (]: Began running node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:05:31.780034 [info ] [Thread-4 (]: 8 of 13 START test relationships_fct_orders_device_id__device_id__ref_stg_dim_device_  [RUN]
[0m15:05:31.801166 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"
[0m15:05:31.802222 [info ] [Thread-2 (]: 9 of 13 START test relationships_fct_orders_location_id__location_id__ref_stg_dim_location_  [RUN]
[0m15:05:31.803852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908, now test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c)
[0m15:05:31.806352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_event_id.797f989776, now test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed)
[0m15:05:31.807426 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:05:31.808430 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:05:31.809297 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:05:31.829312 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"
[0m15:05:31.831749 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"
[0m15:05:31.845483 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"
[0m15:05:31.847990 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:05:31.849268 [debug] [Thread-1 (]: On test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:31.850202 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:05:31.855532 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"
[0m15:05:31.856617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:31.864604 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"
[0m15:05:31.866545 [debug] [Thread-4 (]: On test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:31.908083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:05:31.911734 [debug] [Thread-2 (]: On test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:31.947266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:32.953381 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e27d6541-a26b-42a2-a5d3-842bd8b44a90&page=queryresults
[0m15:05:33.828485 [info ] [Thread-3 (]: 6 of 13 PASS not_null_fct_orders_product_id .................................... [[32mPASS[0m in 2.16s]
[0m15:05:33.829583 [debug] [Thread-3 (]: Finished running node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:05:33.830245 [debug] [Thread-3 (]: Began running node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:05:33.830992 [info ] [Thread-3 (]: 10 of 13 START test relationships_fct_orders_product_id__product_id__ref_stg_dim_product_  [RUN]
[0m15:05:33.831868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_product_id.8e73ef4e24, now test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608)
[0m15:05:33.832438 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:05:33.841577 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"
[0m15:05:33.842560 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:05:33.847194 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"
[0m15:05:33.848186 [debug] [Thread-3 (]: On test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:33.849428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:34.166437 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3972bcaa-aa61-4fc9-8632-feb41bab56a5&page=queryresults
[0m15:05:34.167602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:26eac4ed-1c0f-426d-8fc1-32b4898efb1e&page=queryresults
[0m15:05:34.217034 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f7eb56bc-9ee3-4731-b478-c00f010fba92&page=queryresults
[0m15:05:35.031913 [info ] [Thread-1 (]: 7 of 13 PASS relationships_fct_orders_date_id__date_id__ref_stg_dim_date_ ...... [[32mPASS[0m in 3.26s]
[0m15:05:35.033748 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:05:35.035469 [debug] [Thread-1 (]: Began running node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:05:35.040189 [info ] [Thread-4 (]: 8 of 13 PASS relationships_fct_orders_device_id__device_id__ref_stg_dim_device_  [[32mPASS[0m in 3.24s]
[0m15:05:35.041093 [info ] [Thread-1 (]: 11 of 13 START test relationships_fct_orders_store_id__store_id__ref_stg_dim_store_  [RUN]
[0m15:05:35.042183 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:05:35.042985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0, now test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44)
[0m15:05:35.043889 [debug] [Thread-4 (]: Began running node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:05:35.044726 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:05:35.045445 [info ] [Thread-4 (]: 12 of 13 START test relationships_fct_orders_user_id__user_id__ref_stg_dim_user_  [RUN]
[0m15:05:35.054753 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"
[0m15:05:35.055834 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c, now test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af)
[0m15:05:35.056777 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:05:35.063330 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:05:35.067315 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"
[0m15:05:35.071825 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"
[0m15:05:35.075892 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:05:35.080692 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"
[0m15:05:35.081882 [debug] [Thread-1 (]: On test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:35.082831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:35.083584 [debug] [Thread-4 (]: On test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:05:35.084565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:05:35.308987 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:74505825-d704-4892-9f44-8c7349ad52fd&page=queryresults
[0m15:05:35.377350 [error] [Thread-2 (]: 9 of 13 FAIL 42589 relationships_fct_orders_location_id__location_id__ref_stg_dim_location_  [[31mFAIL 42589[0m in 3.57s]
[0m15:05:35.378455 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:05:35.379192 [debug] [Thread-2 (]: Began running node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:05:35.380121 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed' to be skipped because of status 'fail'.  Reason: Got 42589 results, configured to fail if != 0.
[0m15:05:35.380700 [info ] [Thread-2 (]: 13 of 13 START test unique_fct_orders_event_id ................................. [RUN]
[0m15:05:35.381938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed, now test.glramira.unique_fct_orders_event_id.055f0c7356)
[0m15:05:35.382561 [debug] [Thread-2 (]: Began compiling node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:05:35.393920 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.unique_fct_orders_event_id.055f0c7356"
[0m15:05:35.394965 [debug] [Thread-2 (]: Began executing node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:05:35.399390 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.unique_fct_orders_event_id.055f0c7356"
[0m15:05:35.400528 [debug] [Thread-2 (]: On test.glramira.unique_fct_orders_event_id.055f0c7356: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_fct_orders_event_id.055f0c7356"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:05:35.401180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:36.172818 [error] [Thread-3 (]: 10 of 13 FAIL 8700 relationships_fct_orders_product_id__product_id__ref_stg_dim_product_  [[31mFAIL 8700[0m in 2.34s]
[0m15:05:36.173943 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:05:36.174831 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608' to be skipped because of status 'fail'.  Reason: Got 8700 results, configured to fail if != 0.
[0m15:05:36.477366 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:41fa4f7c-6aeb-4846-8b4f-744ec3cccb9d&page=queryresults
[0m15:05:36.776713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:361f566f-c3c9-4817-bb13-7c7a9f3233ca&page=queryresults
[0m15:05:36.789505 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:925615df-cf05-4da8-b171-ddebd90c0d41&page=queryresults
[0m15:05:37.335414 [error] [Thread-2 (]: 13 of 13 FAIL 11698 unique_fct_orders_event_id ................................. [[31mFAIL 11698[0m in 1.95s]
[0m15:05:37.336540 [debug] [Thread-2 (]: Finished running node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:05:37.337422 [debug] [Thread-7 (]: Marking all children of 'test.glramira.unique_fct_orders_event_id.055f0c7356' to be skipped because of status 'fail'.  Reason: Got 11698 results, configured to fail if != 0.
[0m15:05:37.642927 [info ] [Thread-4 (]: 12 of 13 PASS relationships_fct_orders_user_id__user_id__ref_stg_dim_user_ ..... [[32mPASS[0m in 2.59s]
[0m15:05:37.644879 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:05:37.650436 [info ] [Thread-1 (]: 11 of 13 PASS relationships_fct_orders_store_id__store_id__ref_stg_dim_store_ .. [[32mPASS[0m in 2.61s]
[0m15:05:37.652155 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:05:37.654686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:37.657133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:37.657748 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44' was properly closed.
[0m15:05:37.658320 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608' was properly closed.
[0m15:05:37.658855 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af' was properly closed.
[0m15:05:37.659383 [debug] [MainThread]: Connection 'test.glramira.unique_fct_orders_event_id.055f0c7356' was properly closed.
[0m15:05:37.660046 [info ] [MainThread]: 
[0m15:05:37.660612 [info ] [MainThread]: Finished running 1 table model, 12 data tests in 0 hours 0 minutes and 16.66 seconds (16.66s).
[0m15:05:37.663748 [debug] [MainThread]: Command end result
[0m15:05:37.727794 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:05:37.730850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:05:37.740400 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m15:05:37.741077 [info ] [MainThread]: 
[0m15:05:37.741760 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m15:05:37.742355 [info ] [MainThread]: 
[0m15:05:37.743012 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True (models/marts/schema.yml)[0m
[0m15:05:37.743672 [error] [MainThread]:   Got 7727 results, configured to fail if != 0
[0m15:05:37.744157 [info ] [MainThread]: 
[0m15:05:37.744778 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/dbt_expectations_expect_column_016329b3776ad6fc3280c2f5283030f1.sql
[0m15:05:37.745307 [info ] [MainThread]: 
[0m15:05:37.745934 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True (models/marts/schema.yml)[0m
[0m15:05:37.746569 [error] [MainThread]:   Got 7727 results, configured to fail if != 0
[0m15:05:37.747065 [info ] [MainThread]: 
[0m15:05:37.747729 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/dbt_expectations_expect_column_66054eb31576442eb06bc3d0cb18af44.sql
[0m15:05:37.748296 [info ] [MainThread]: 
[0m15:05:37.748989 [error] [MainThread]: [31mFailure in test relationships_fct_orders_location_id__location_id__ref_stg_dim_location_ (models/marts/schema.yml)[0m
[0m15:05:37.749672 [error] [MainThread]:   Got 42589 results, configured to fail if != 0
[0m15:05:37.750137 [info ] [MainThread]: 
[0m15:05:37.750749 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/relationships_fct_orders_1dff4763480198109129417d075d7df7.sql
[0m15:05:37.751247 [info ] [MainThread]: 
[0m15:05:37.751899 [error] [MainThread]: [31mFailure in test relationships_fct_orders_product_id__product_id__ref_stg_dim_product_ (models/marts/schema.yml)[0m
[0m15:05:37.752490 [error] [MainThread]:   Got 8700 results, configured to fail if != 0
[0m15:05:37.752932 [info ] [MainThread]: 
[0m15:05:37.753589 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/relationships_fct_orders_76a8bd920c2a57697c8a05cd2026dbed.sql
[0m15:05:37.754137 [info ] [MainThread]: 
[0m15:05:37.754809 [error] [MainThread]: [31mFailure in test unique_fct_orders_event_id (models/marts/schema.yml)[0m
[0m15:05:37.755569 [error] [MainThread]:   Got 11698 results, configured to fail if != 0
[0m15:05:37.756037 [info ] [MainThread]: 
[0m15:05:37.756600 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/unique_fct_orders_event_id.sql
[0m15:05:37.757161 [info ] [MainThread]: 
[0m15:05:37.757731 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m15:05:37.759321 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 21.104662, "process_in_blocks": "2088", "process_kernel_time": 0.902674, "process_mem_max_rss": "409672", "process_out_blocks": "4056", "process_user_time": 9.622921}
[0m15:05:37.760200 [debug] [MainThread]: Command `dbt build` failed at 15:05:37.760038 after 21.11 seconds
[0m15:05:37.760831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79265d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b63232d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b6323250>]}
[0m15:05:37.761506 [debug] [MainThread]: Flushing usage events
[0m15:05:37.926549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:17.012545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef09e1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0a47450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0a16490>]}


============================== 15:06:17.017054 | c2c81540-fbda-458f-8bc0-dae5e117a478 ==============================
[0m15:06:17.017054 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:06:17.018157 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build --select glramira.marts', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'static_parser': 'True'}
[0m15:06:20.534546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0fc89d0>]}
[0m15:06:20.625239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef3655250>]}
[0m15:06:20.626296 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:06:20.931703 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:06:21.120388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:21.121066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:21.187235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed0c79d10>]}
[0m15:06:21.334264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:06:21.337368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:06:21.381043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed0a9bf90>]}
[0m15:06:21.382007 [info ] [MainThread]: Found 8 models, 27 data tests, 4 sources, 762 macros
[0m15:06:21.385753 [info ] [MainThread]: 
[0m15:06:21.386410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:21.386971 [info ] [MainThread]: 
[0m15:06:21.387883 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:06:21.389442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m15:06:21.390287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:21.877249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m15:06:21.878267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:22.321056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed1ef750>]}
[0m15:06:22.321907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:22.329286 [debug] [Thread-1 (]: Began running node model.glramira.fct_orders
[0m15:06:22.330271 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_glramira.fct_orders .......................... [RUN]
[0m15:06:22.331436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.fct_orders)
[0m15:06:22.332104 [debug] [Thread-1 (]: Began compiling node model.glramira.fct_orders
[0m15:06:22.348887 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.fct_orders"
[0m15:06:22.349994 [debug] [Thread-1 (]: Began executing node model.glramira.fct_orders
[0m15:06:22.371557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:22.843114 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.fct_orders"
[0m15:06:22.844360 [debug] [Thread-1 (]: On model.glramira.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.fct_orders"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
      
    
    

    
    OPTIONS()
    as (
      

WITH
  fact AS (
    SELECT
      event_id,
      order_id,
      product_id,
      device_id,
      user_id,
      date_id,
      store_id,
      location_id,
      currency,
      price,
      amount,
      final_amount,
      exchange_rate,
      CAST(final_amount * COALESCE(exchange_rate, 1) AS FLOAT64) AS final_amount_usd,
      is_paypal
    FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
  )
,
  dim_date AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
  )
,
  dim_user AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  )
,
  dim_product AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
  )
,
  dim_store AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
  )
,
  dim_device AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
  )
,
  dim_location AS (
    SELECT * FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
  )

SELECT
  f.event_id,
  f.order_id,
  f.product_id,
  p.product_name,
  p.product_price,
  f.user_id,
  u.email_address AS user_email,
  f.device_id,
  dvc.os AS device_os,
  dvc.device_model,
  dvc.device_type,
  f.date_id,
  dt.full_date,
  dt.day,
  dt.month,
  dt.year,
  dt.is_weekend,
  f.store_id,
  st.store_name,
  f.location_id,
  loc.country,
  loc.country_code,
  loc.region,
  loc.city,
  f.currency,
  f.price,
  f.amount,
  f.final_amount,
  f.exchange_rate,
  f.final_amount_usd,
  f.is_paypal
FROM fact f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_device dvc ON f.device_id = dvc.device_id
LEFT JOIN dim_date dt ON f.date_id = dt.date_id
LEFT JOIN dim_store st ON f.store_id = st.store_id
LEFT JOIN dim_location loc ON f.location_id = loc.location_id
    );
  
[0m15:06:23.877705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f13f664e-8a09-4e16-a661-d2f8652e773f&page=queryresults
[0m15:06:30.100776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c81540-fbda-458f-8bc0-dae5e117a478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef11af910>]}
[0m15:06:30.101997 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_glramira.fct_orders ..................... [[32mCREATE TABLE (46.5k rows, 8.9 GiB processed)[0m in 7.77s]
[0m15:06:30.103050 [debug] [Thread-1 (]: Finished running node model.glramira.fct_orders
[0m15:06:30.104746 [debug] [Thread-3 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:06:30.105566 [debug] [Thread-4 (]: Began running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:06:30.106372 [debug] [Thread-2 (]: Began running node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:06:30.106985 [info ] [Thread-3 (]: 2 of 13 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True  [RUN]
[0m15:06:30.107852 [debug] [Thread-1 (]: Began running node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:06:30.108563 [info ] [Thread-4 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True  [RUN]
[0m15:06:30.109461 [info ] [Thread-2 (]: 4 of 13 START test not_null_fct_orders_event_id ................................ [RUN]
[0m15:06:30.110638 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c'
[0m15:06:30.111260 [info ] [Thread-1 (]: 5 of 13 START test not_null_fct_orders_order_id ................................ [RUN]
[0m15:06:30.112245 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908'
[0m15:06:30.113082 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.glramira.not_null_fct_orders_event_id.797f989776'
[0m15:06:30.113833 [debug] [Thread-3 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:06:30.114813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.glramira.fct_orders, now test.glramira.not_null_fct_orders_order_id.4e687af8d0)
[0m15:06:30.115751 [debug] [Thread-4 (]: Began compiling node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:06:30.116454 [debug] [Thread-2 (]: Began compiling node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:06:30.137932 [debug] [Thread-1 (]: Began compiling node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:06:30.145601 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"
[0m15:06:30.153367 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"
[0m15:06:30.167332 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_event_id.797f989776"
[0m15:06:30.173897 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_order_id.4e687af8d0"
[0m15:06:30.175021 [debug] [Thread-3 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:06:30.176281 [debug] [Thread-4 (]: Began executing node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:06:30.177060 [debug] [Thread-2 (]: Began executing node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:06:30.193890 [debug] [Thread-1 (]: Began executing node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:06:30.208068 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"
[0m15:06:30.209126 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"
[0m15:06:30.213366 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_event_id.797f989776"
[0m15:06:30.217749 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_order_id.4e687af8d0"
[0m15:06:30.219403 [debug] [Thread-3 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and final_amount > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:06:30.220668 [debug] [Thread-2 (]: On test.glramira.not_null_fct_orders_event_id.797f989776: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_event_id.797f989776"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:06:30.221625 [debug] [Thread-4 (]: On test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and final_amount_usd > 0
)
 as expression


    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:06:30.222464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:06:30.223203 [debug] [Thread-1 (]: On test.glramira.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:06:30.223820 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:06:30.224606 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:06:30.261812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:31.523075 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1205c80d-3350-4717-8e7c-7dcbe927f9ba&page=queryresults
[0m15:06:31.529810 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:c931dd2d-eb07-4c59-af13-03baf91bbc02&page=queryresults
[0m15:06:31.534804 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:b55e2050-7ab5-40a7-816e-375d13ec8c93&page=queryresults
[0m15:06:31.592926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:faf1f5c0-4e2a-4dbc-b7be-6f949ae9c9da&page=queryresults
[0m15:06:32.392744 [error] [Thread-3 (]: 2 of 13 FAIL 7727 dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True  [[31mFAIL 7727[0m in 2.28s]
[0m15:06:32.394582 [debug] [Thread-3 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c
[0m15:06:32.396991 [debug] [Thread-3 (]: Began running node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:06:32.397986 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c' to be skipped because of status 'fail'.  Reason: Got 7727 results, configured to fail if != 0.
[0m15:06:32.400068 [info ] [Thread-3 (]: 6 of 13 START test not_null_fct_orders_product_id .............................. [RUN]
[0m15:06:32.402934 [info ] [Thread-2 (]: 4 of 13 PASS not_null_fct_orders_event_id ...................................... [[32mPASS[0m in 2.29s]
[0m15:06:32.408787 [error] [Thread-4 (]: 3 of 13 FAIL 7727 dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True  [[31mFAIL 7727[0m in 2.30s]
[0m15:06:32.409778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True.d16f2c208c, now test.glramira.not_null_fct_orders_product_id.8e73ef4e24)
[0m15:06:32.410827 [debug] [Thread-2 (]: Finished running node test.glramira.not_null_fct_orders_event_id.797f989776
[0m15:06:32.411748 [debug] [Thread-4 (]: Finished running node test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908
[0m15:06:32.412395 [debug] [Thread-3 (]: Began compiling node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:06:32.413105 [debug] [Thread-2 (]: Began running node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:06:32.413995 [debug] [Thread-4 (]: Began running node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:06:32.414728 [debug] [Thread-7 (]: Marking all children of 'test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908' to be skipped because of status 'fail'.  Reason: Got 7727 results, configured to fail if != 0.
[0m15:06:32.422051 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:06:32.422997 [info ] [Thread-2 (]: 7 of 13 START test relationships_fct_orders_date_id__date_id__ref_stg_dim_date_  [RUN]
[0m15:06:32.423902 [info ] [Thread-4 (]: 8 of 13 START test relationships_fct_orders_device_id__device_id__ref_stg_dim_device_  [RUN]
[0m15:06:32.425311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_event_id.797f989776, now test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0)
[0m15:06:32.426092 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True.a7ec5f1908, now test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c)
[0m15:06:32.426877 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:06:32.427460 [debug] [Thread-3 (]: Began executing node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:06:32.428157 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:06:32.444336 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"
[0m15:06:32.450453 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:06:32.455149 [info ] [Thread-1 (]: 5 of 13 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 2.34s]
[0m15:06:32.464788 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"
[0m15:06:32.466313 [debug] [Thread-3 (]: On test.glramira.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:06:32.467016 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:06:32.468003 [debug] [Thread-1 (]: Finished running node test.glramira.not_null_fct_orders_order_id.4e687af8d0
[0m15:06:32.469022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:32.473702 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"
[0m15:06:32.474364 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:06:32.475188 [debug] [Thread-1 (]: Began running node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:06:32.518043 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"
[0m15:06:32.519095 [debug] [Thread-2 (]: On test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where date_id is not null
),

parent as (
    select date_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:32.520173 [info ] [Thread-1 (]: 9 of 13 START test relationships_fct_orders_location_id__location_id__ref_stg_dim_location_  [RUN]
[0m15:06:32.521864 [debug] [Thread-4 (]: On test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select device_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where device_id is not null
),

parent as (
    select device_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_device`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:32.522774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:32.523651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_order_id.4e687af8d0, now test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed)
[0m15:06:32.524467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:32.562534 [debug] [Thread-1 (]: Began compiling node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:06:32.613535 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"
[0m15:06:32.615168 [debug] [Thread-1 (]: Began executing node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:06:32.620380 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"
[0m15:06:32.622216 [debug] [Thread-1 (]: On test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select location_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where location_id is not null
),

parent as (
    select location_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:32.623081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:33.646406 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:c1b5dd5f-e397-40e3-a7e8-fea237c4e1fe&page=queryresults
[0m15:06:34.322420 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3aa27452-ac63-40d4-a227-17ad13ad788f&page=queryresults
[0m15:06:34.501250 [info ] [Thread-3 (]: 6 of 13 PASS not_null_fct_orders_product_id .................................... [[32mPASS[0m in 2.09s]
[0m15:06:34.502604 [debug] [Thread-3 (]: Finished running node test.glramira.not_null_fct_orders_product_id.8e73ef4e24
[0m15:06:34.503360 [debug] [Thread-3 (]: Began running node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:06:34.504136 [info ] [Thread-3 (]: 10 of 13 START test relationships_fct_orders_product_id__product_id__ref_stg_dim_product_  [RUN]
[0m15:06:34.504921 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.glramira.not_null_fct_orders_product_id.8e73ef4e24, now test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608)
[0m15:06:34.505543 [debug] [Thread-3 (]: Began compiling node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:06:34.515131 [debug] [Thread-3 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"
[0m15:06:34.516385 [debug] [Thread-3 (]: Began executing node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:06:34.521329 [debug] [Thread-3 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"
[0m15:06:34.522513 [debug] [Thread-3 (]: On test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:34.523252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:34.791729 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:87732efc-b1f8-408c-9bc6-70caca8d5815&page=queryresults
[0m15:06:34.909443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:87571eee-b10f-4a73-aca8-2ca1d5f11b57&page=queryresults
[0m15:06:35.187529 [info ] [Thread-4 (]: 8 of 13 PASS relationships_fct_orders_device_id__device_id__ref_stg_dim_device_  [[32mPASS[0m in 2.76s]
[0m15:06:35.188702 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c
[0m15:06:35.189383 [debug] [Thread-4 (]: Began running node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:06:35.190131 [info ] [Thread-4 (]: 11 of 13 START test relationships_fct_orders_store_id__store_id__ref_stg_dim_store_  [RUN]
[0m15:06:35.190964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_device_id__device_id__ref_stg_dim_device_.7051f6e04c, now test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44)
[0m15:06:35.191657 [debug] [Thread-4 (]: Began compiling node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:06:35.201033 [debug] [Thread-4 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"
[0m15:06:35.202199 [debug] [Thread-4 (]: Began executing node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:06:35.207151 [debug] [Thread-4 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"
[0m15:06:35.208393 [debug] [Thread-4 (]: On test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where store_id is not null
),

parent as (
    select store_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_store`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:35.209095 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:35.661574 [info ] [Thread-2 (]: 7 of 13 PASS relationships_fct_orders_date_id__date_id__ref_stg_dim_date_ ...... [[32mPASS[0m in 3.24s]
[0m15:06:35.662656 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0
[0m15:06:35.663316 [debug] [Thread-2 (]: Began running node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:06:35.664100 [info ] [Thread-2 (]: 12 of 13 START test relationships_fct_orders_user_id__user_id__ref_stg_dim_user_  [RUN]
[0m15:06:35.664823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_date_id__date_id__ref_stg_dim_date_.6830860cc0, now test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af)
[0m15:06:35.665440 [debug] [Thread-2 (]: Began compiling node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:06:35.674259 [debug] [Thread-2 (]: Writing injected SQL for node "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"
[0m15:06:35.675517 [debug] [Thread-2 (]: Began executing node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:06:35.680055 [debug] [Thread-2 (]: Writing runtime sql for node "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"
[0m15:06:35.681194 [debug] [Thread-2 (]: On test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:06:35.681953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:35.997415 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5301f7c7-78d0-4f07-b924-0f32d368867a&page=queryresults
[0m15:06:36.044603 [error] [Thread-1 (]: 9 of 13 FAIL 42589 relationships_fct_orders_location_id__location_id__ref_stg_dim_location_  [[31mFAIL 42589[0m in 3.52s]
[0m15:06:36.045911 [debug] [Thread-1 (]: Finished running node test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed
[0m15:06:36.046608 [debug] [Thread-1 (]: Began running node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:06:36.047490 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed' to be skipped because of status 'fail'.  Reason: Got 42589 results, configured to fail if != 0.
[0m15:06:36.048204 [info ] [Thread-1 (]: 13 of 13 START test unique_fct_orders_event_id ................................. [RUN]
[0m15:06:36.049362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.glramira.relationships_fct_orders_location_id__location_id__ref_stg_dim_location_.b28e9a68ed, now test.glramira.unique_fct_orders_event_id.055f0c7356)
[0m15:06:36.049994 [debug] [Thread-1 (]: Began compiling node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:06:36.063251 [debug] [Thread-1 (]: Writing injected SQL for node "test.glramira.unique_fct_orders_event_id.055f0c7356"
[0m15:06:36.064525 [debug] [Thread-1 (]: Began executing node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:06:36.069321 [debug] [Thread-1 (]: Writing runtime sql for node "test.glramira.unique_fct_orders_event_id.055f0c7356"
[0m15:06:36.070530 [debug] [Thread-1 (]: On test.glramira.unique_fct_orders_event_id.055f0c7356: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "test.glramira.unique_fct_orders_event_id.055f0c7356"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `project-data-engineer-469310`.`dbt_glramira`.`fct_orders`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:06:36.071288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:36.846110 [error] [Thread-3 (]: 10 of 13 FAIL 8700 relationships_fct_orders_product_id__product_id__ref_stg_dim_product_  [[31mFAIL 8700[0m in 2.34s]
[0m15:06:36.847490 [debug] [Thread-3 (]: Finished running node test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608
[0m15:06:36.848690 [debug] [Thread-7 (]: Marking all children of 'test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608' to be skipped because of status 'fail'.  Reason: Got 8700 results, configured to fail if != 0.
[0m15:06:36.895781 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:f5cf07a9-185f-44b0-9e5d-087606abeade&page=queryresults
[0m15:06:37.145161 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:601a53fe-19f6-47a5-a08c-68d1ac958ac4&page=queryresults
[0m15:06:37.282607 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:6fe48cd3-f838-4cb9-8a0b-c06ae3ceb1f6&page=queryresults
[0m15:06:37.752742 [info ] [Thread-4 (]: 11 of 13 PASS relationships_fct_orders_store_id__store_id__ref_stg_dim_store_ .. [[32mPASS[0m in 2.56s]
[0m15:06:37.753915 [debug] [Thread-4 (]: Finished running node test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44
[0m15:06:37.999639 [error] [Thread-1 (]: 13 of 13 FAIL 11698 unique_fct_orders_event_id ................................. [[31mFAIL 11698[0m in 1.95s]
[0m15:06:38.000957 [debug] [Thread-1 (]: Finished running node test.glramira.unique_fct_orders_event_id.055f0c7356
[0m15:06:38.001880 [debug] [Thread-7 (]: Marking all children of 'test.glramira.unique_fct_orders_event_id.055f0c7356' to be skipped because of status 'fail'.  Reason: Got 11698 results, configured to fail if != 0.
[0m15:06:38.144500 [info ] [Thread-2 (]: 12 of 13 PASS relationships_fct_orders_user_id__user_id__ref_stg_dim_user_ ..... [[32mPASS[0m in 2.48s]
[0m15:06:38.145653 [debug] [Thread-2 (]: Finished running node test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af
[0m15:06:38.148211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:38.150641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:38.151248 [debug] [MainThread]: Connection 'test.glramira.unique_fct_orders_event_id.055f0c7356' was properly closed.
[0m15:06:38.151791 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_product_id__product_id__ref_stg_dim_product_.5c72063608' was properly closed.
[0m15:06:38.152273 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_store_id__store_id__ref_stg_dim_store_.c48af62c44' was properly closed.
[0m15:06:38.152815 [debug] [MainThread]: Connection 'test.glramira.relationships_fct_orders_user_id__user_id__ref_stg_dim_user_.d7046222af' was properly closed.
[0m15:06:38.153431 [info ] [MainThread]: 
[0m15:06:38.153972 [info ] [MainThread]: Finished running 1 table model, 12 data tests in 0 hours 0 minutes and 16.77 seconds (16.77s).
[0m15:06:38.157083 [debug] [MainThread]: Command end result
[0m15:06:38.222323 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:06:38.225355 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:06:38.234848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m15:06:38.235572 [info ] [MainThread]: 
[0m15:06:38.236235 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m15:06:38.237079 [info ] [MainThread]: 
[0m15:06:38.237888 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount__0__True (models/marts/schema.yml)[0m
[0m15:06:38.238556 [error] [MainThread]:   Got 7727 results, configured to fail if != 0
[0m15:06:38.239057 [info ] [MainThread]: 
[0m15:06:38.239749 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/dbt_expectations_expect_column_016329b3776ad6fc3280c2f5283030f1.sql
[0m15:06:38.240301 [info ] [MainThread]: 
[0m15:06:38.241011 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_fct_orders_final_amount_usd__0__True (models/marts/schema.yml)[0m
[0m15:06:38.241803 [error] [MainThread]:   Got 7727 results, configured to fail if != 0
[0m15:06:38.242263 [info ] [MainThread]: 
[0m15:06:38.242919 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/dbt_expectations_expect_column_66054eb31576442eb06bc3d0cb18af44.sql
[0m15:06:38.243661 [info ] [MainThread]: 
[0m15:06:38.244295 [error] [MainThread]: [31mFailure in test relationships_fct_orders_location_id__location_id__ref_stg_dim_location_ (models/marts/schema.yml)[0m
[0m15:06:38.244887 [error] [MainThread]:   Got 42589 results, configured to fail if != 0
[0m15:06:38.245370 [info ] [MainThread]: 
[0m15:06:38.245985 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/relationships_fct_orders_1dff4763480198109129417d075d7df7.sql
[0m15:06:38.246533 [info ] [MainThread]: 
[0m15:06:38.247281 [error] [MainThread]: [31mFailure in test relationships_fct_orders_product_id__product_id__ref_stg_dim_product_ (models/marts/schema.yml)[0m
[0m15:06:38.247917 [error] [MainThread]:   Got 8700 results, configured to fail if != 0
[0m15:06:38.248512 [info ] [MainThread]: 
[0m15:06:38.249283 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/relationships_fct_orders_76a8bd920c2a57697c8a05cd2026dbed.sql
[0m15:06:38.249903 [info ] [MainThread]: 
[0m15:06:38.250556 [error] [MainThread]: [31mFailure in test unique_fct_orders_event_id (models/marts/schema.yml)[0m
[0m15:06:38.251145 [error] [MainThread]:   Got 11698 results, configured to fail if != 0
[0m15:06:38.251691 [info ] [MainThread]: 
[0m15:06:38.252422 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/schema.yml/unique_fct_orders_event_id.sql
[0m15:06:38.253001 [info ] [MainThread]: 
[0m15:06:38.253715 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m15:06:38.255294 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 21.318026, "process_in_blocks": "0", "process_kernel_time": 0.839034, "process_mem_max_rss": "408688", "process_out_blocks": "4000", "process_user_time": 9.6543}
[0m15:06:38.256014 [debug] [MainThread]: Command `dbt build` failed at 15:06:38.255843 after 21.32 seconds
[0m15:06:38.256607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef19a4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef4c8efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef4c8f010>]}
[0m15:06:38.257228 [debug] [MainThread]: Flushing usage events
[0m15:06:38.457531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:13.986068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d2b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d2b4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d2b70d0>]}


============================== 15:14:13.990561 | cb9d7a90-712c-4984-bf4f-1dd1f6048075 ==============================
[0m15:14:13.990561 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:14:13.991466 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_customer_metrics', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'empty': 'False'}
[0m15:14:13.992121 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:14:13.992743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d459bd0>]}
[0m15:14:17.536165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81d804710>]}
[0m15:14:17.630511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83fedca10>]}
[0m15:14:17.631714 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:14:17.910358 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:14:18.114136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:18.114838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:18.181167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81d6c2ed0>]}
[0m15:14:18.333240 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:14:18.336239 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:14:18.357355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81d511890>]}
[0m15:14:18.358236 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m15:14:18.358886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81dabb190>]}
[0m15:14:18.361247 [info ] [MainThread]: 
[0m15:14:18.361820 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:18.362307 [info ] [MainThread]: 
[0m15:14:18.363110 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:18.364709 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m15:14:18.365504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:18.892666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m15:14:18.893546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:19.348136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81d3c3c50>]}
[0m15:14:19.349031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:19.356203 [debug] [Thread-1 (]: Began running node model.glramira.mart_customer_metrics
[0m15:14:19.357151 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_customer_metrics ................ [RUN]
[0m15:14:19.358019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_customer_metrics)
[0m15:14:19.358625 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_customer_metrics
[0m15:14:19.370570 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_customer_metrics"
[0m15:14:19.371715 [debug] [Thread-1 (]: Began executing node model.glramira.mart_customer_metrics
[0m15:14:19.424034 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_customer_metrics"
[0m15:14:19.425208 [debug] [Thread-1 (]: On model.glramira.mart_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_customer_metrics"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_customer_metrics`
      
    
    

    
    OPTIONS()
    as (
      SELECT
    customer_id,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_usd) AS total_revenue,
    AVG(total_amount_usd) AS avg_order_value
FROM fact_orders
GROUP BY 1
    );
  
[0m15:14:19.425877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.253292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7f00c505-2005-416b-939d-96c72964c07b&page=queryresults
[0m15:14:20.254309 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:7f00c505-2005-416b-939d-96c72964c07b&page=queryresults
[0m15:14:20.267290 [debug] [Thread-1 (]: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Table "fact_orders" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:14:20.269788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb9d7a90-712c-4984-bf4f-1dd1f6048075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81d286550>]}
[0m15:14:20.270910 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_customer_metrics ....... [[31mERROR[0m in 0.91s]
[0m15:14:20.271859 [debug] [Thread-1 (]: Finished running node model.glramira.mart_customer_metrics
[0m15:14:20.272786 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Table "fact_orders" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql.
[0m15:14:20.276061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:20.278624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:20.279269 [debug] [MainThread]: Connection 'model.glramira.mart_customer_metrics' was properly closed.
[0m15:14:20.279849 [info ] [MainThread]: 
[0m15:14:20.280441 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m15:14:20.281677 [debug] [MainThread]: Command end result
[0m15:14:20.348058 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:14:20.350853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:14:20.358784 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m15:14:20.359424 [info ] [MainThread]: 
[0m15:14:20.360160 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:14:20.360724 [info ] [MainThread]: 
[0m15:14:20.361364 [error] [MainThread]: [31mFailure in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)[0m
[0m15:14:20.361965 [error] [MainThread]:   Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Table "fact_orders" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:14:20.362433 [info ] [MainThread]: 
[0m15:14:20.363008 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_customer_metrics.sql
[0m15:14:20.363499 [info ] [MainThread]: 
[0m15:14:20.364038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:14:20.364869 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:14:20.366326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4560466, "process_in_blocks": "0", "process_kernel_time": 0.951527, "process_mem_max_rss": "393516", "process_out_blocks": "3576", "process_user_time": 6.481759}
[0m15:14:20.367155 [debug] [MainThread]: Command `dbt run` failed at 15:14:20.366978 after 6.46 seconds
[0m15:14:20.367795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d45a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8414bf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e5e8c90>]}
[0m15:14:20.368440 [debug] [MainThread]: Flushing usage events
[0m15:14:20.552020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:00.346984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e7643950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e761a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e7792110>]}


============================== 15:17:00.351592 | 6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291 ==============================
[0m15:17:00.351592 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:17:00.352504 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run -m mart_customer_metrics', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m15:17:00.353126 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:00.353800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e7642050>]}
[0m15:17:04.186680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c7d87ed0>]}
[0m15:17:04.276810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ea2592d0>]}
[0m15:17:04.278066 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:17:04.525591 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:17:04.737868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:04.738636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:04.804312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c7ae0c50>]}
[0m15:17:04.948995 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:17:04.951995 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:17:04.971583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c7650850>]}
[0m15:17:04.972447 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m15:17:04.973064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c7ab40d0>]}
[0m15:17:04.975313 [info ] [MainThread]: 
[0m15:17:04.975911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:04.976444 [info ] [MainThread]: 
[0m15:17:04.977397 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:04.978924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m15:17:04.979830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:05.462628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m15:17:05.463548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:05.908912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c7a81f50>]}
[0m15:17:05.909742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:05.916905 [debug] [Thread-1 (]: Began running node model.glramira.mart_customer_metrics
[0m15:17:05.917902 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_customer_metrics ................ [RUN]
[0m15:17:05.918796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_customer_metrics)
[0m15:17:05.919463 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_customer_metrics
[0m15:17:05.932066 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_customer_metrics"
[0m15:17:05.933181 [debug] [Thread-1 (]: Began executing node model.glramira.mart_customer_metrics
[0m15:17:05.984904 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_customer_metrics"
[0m15:17:05.986096 [debug] [Thread-1 (]: On model.glramira.mart_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_customer_metrics"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_customer_metrics`
      
    
    

    
    OPTIONS()
    as (
      SELECT
    customer_id,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_usd) AS total_revenue,
    AVG(total_amount_usd) AS avg_order_value
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
GROUP BY 1
    );
  
[0m15:17:05.986870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:07.363518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5581fa83-0460-41e7-afd7-81bc381ed6e9&page=queryresults
[0m15:17:07.644473 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:5581fa83-0460-41e7-afd7-81bc381ed6e9&page=queryresults
[0m15:17:07.655841 [debug] [Thread-1 (]: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: customer_id; Did you mean store_id? at [15:5]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:07.658736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae3b7ba-23f0-4db6-a7f3-fb0bc5840291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c769ee50>]}
[0m15:17:07.660114 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_customer_metrics ....... [[31mERROR[0m in 1.74s]
[0m15:17:07.661589 [debug] [Thread-1 (]: Finished running node model.glramira.mart_customer_metrics
[0m15:17:07.662775 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: customer_id; Did you mean store_id? at [15:5]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql.
[0m15:17:07.665893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:07.668684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:07.669225 [debug] [MainThread]: Connection 'model.glramira.mart_customer_metrics' was properly closed.
[0m15:17:07.669780 [info ] [MainThread]: 
[0m15:17:07.670345 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m15:17:07.671426 [debug] [MainThread]: Command end result
[0m15:17:07.745703 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:17:07.749743 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:17:07.758556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m15:17:07.759669 [info ] [MainThread]: 
[0m15:17:07.760691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:07.761489 [info ] [MainThread]: 
[0m15:17:07.762331 [error] [MainThread]: [31mFailure in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)[0m
[0m15:17:07.763169 [error] [MainThread]:   Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: customer_id; Did you mean store_id? at [15:5]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:07.763884 [info ] [MainThread]: 
[0m15:17:07.764640 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:07.765313 [info ] [MainThread]: 
[0m15:17:07.766041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:17:07.767218 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:07.769071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.4968705, "process_in_blocks": "0", "process_kernel_time": 1.161956, "process_mem_max_rss": "393620", "process_out_blocks": "3568", "process_user_time": 6.495072}
[0m15:17:07.769967 [debug] [MainThread]: Command `dbt run` failed at 15:17:07.769760 after 7.50 seconds
[0m15:17:07.770695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e7641550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e7642550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80eb87ef90>]}
[0m15:17:07.771397 [debug] [MainThread]: Flushing usage events
[0m15:17:07.979949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:17.285387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855190ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551db3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551902590>]}


============================== 15:17:17.289772 | b6f2cfc2-7dad-451f-837d-e93b8e911594 ==============================
[0m15:17:17.289772 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:17:17.290627 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -m mart_customer_metrics', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True'}
[0m15:17:17.291268 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:17.291969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85517772d0>]}
[0m15:17:20.735096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8532040810>]}
[0m15:17:20.823448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85517ba410>]}
[0m15:17:20.824579 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:17:21.117119 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:17:21.329733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:21.330482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:21.397241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8531b9b050>]}
[0m15:17:21.549598 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:17:21.553226 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:17:21.573246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8531d4c1d0>]}
[0m15:17:21.574163 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m15:17:21.574797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551e8ee90>]}
[0m15:17:21.577272 [info ] [MainThread]: 
[0m15:17:21.577857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:21.578646 [info ] [MainThread]: 
[0m15:17:21.579666 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:21.581831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m15:17:21.582644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:22.068601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m15:17:22.069518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:22.507638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853195e1d0>]}
[0m15:17:22.508774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:22.517056 [debug] [Thread-1 (]: Began running node model.glramira.mart_customer_metrics
[0m15:17:22.518068 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_customer_metrics ................ [RUN]
[0m15:17:22.518976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_customer_metrics)
[0m15:17:22.519619 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_customer_metrics
[0m15:17:22.532475 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_customer_metrics"
[0m15:17:22.533487 [debug] [Thread-1 (]: Began executing node model.glramira.mart_customer_metrics
[0m15:17:22.587622 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_customer_metrics"
[0m15:17:22.588817 [debug] [Thread-1 (]: On model.glramira.mart_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_customer_metrics"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_customer_metrics`
      
    
    

    
    OPTIONS()
    as (
      SELECT
    user_id,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_usd) AS total_revenue,
    AVG(total_amount_usd) AS avg_order_value
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
GROUP BY 1
    );
  
[0m15:17:22.589557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:23.763126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4b9e1c0e-3aac-4ad6-a0b2-cf3e36a77409&page=queryresults
[0m15:17:24.030581 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:4b9e1c0e-3aac-4ad6-a0b2-cf3e36a77409&page=queryresults
[0m15:17:24.042574 [debug] [Thread-1 (]: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: total_amount_usd at [17:9]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:24.045208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f2cfc2-7dad-451f-837d-e93b8e911594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8531b9a4d0>]}
[0m15:17:24.046337 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_customer_metrics ....... [[31mERROR[0m in 1.52s]
[0m15:17:24.047620 [debug] [Thread-1 (]: Finished running node model.glramira.mart_customer_metrics
[0m15:17:24.048778 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: total_amount_usd at [17:9]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql.
[0m15:17:24.052187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:24.054739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:24.055253 [debug] [MainThread]: Connection 'model.glramira.mart_customer_metrics' was properly closed.
[0m15:17:24.055866 [info ] [MainThread]: 
[0m15:17:24.056484 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m15:17:24.057494 [debug] [MainThread]: Command end result
[0m15:17:24.119595 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m15:17:24.122465 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m15:17:24.130927 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m15:17:24.131559 [info ] [MainThread]: 
[0m15:17:24.132277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:24.132822 [info ] [MainThread]: 
[0m15:17:24.133507 [error] [MainThread]: [31mFailure in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)[0m
[0m15:17:24.134181 [error] [MainThread]:   Database Error in model mart_customer_metrics (models/marts/mart_customer_metrics.sql)
  Unrecognized name: total_amount_usd at [17:9]
  compiled code at target/run/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:24.134688 [info ] [MainThread]: 
[0m15:17:24.135438 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_customer_metrics.sql
[0m15:17:24.135991 [info ] [MainThread]: 
[0m15:17:24.136614 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:17:24.137588 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:24.139082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.92877, "process_in_blocks": "0", "process_kernel_time": 0.773644, "process_mem_max_rss": "393680", "process_out_blocks": "3568", "process_user_time": 6.542691}
[0m15:17:24.139815 [debug] [MainThread]: Command `dbt run` failed at 15:17:24.139663 after 6.93 seconds
[0m15:17:24.140415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8552bee4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8555b0f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551bc4950>]}
[0m15:17:24.141012 [debug] [MainThread]: Flushing usage events
[0m15:17:24.308444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:53.305698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096166b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0961932ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096180d810>]}


============================== 16:33:53.312533 | 66cf260e-5060-446d-b091-394814535650 ==============================
[0m16:33:53.312533 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:33:53.313430 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m mart_customer_metrics', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False'}
[0m16:33:53.314081 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:33:53.314763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66cf260e-5060-446d-b091-394814535650', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096180e690>]}
[0m16:33:57.534692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0941d334d0>]}
[0m16:33:57.623464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0964361390>]}
[0m16:33:57.624579 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:33:57.905733 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:33:58.106977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:58.107763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:58.172173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0941b65310>]}
[0m16:33:58.324294 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:33:58.327314 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:33:58.347728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09635712d0>]}
[0m16:33:58.348676 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m16:33:58.349294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0941a2e850>]}
[0m16:33:58.351548 [info ] [MainThread]: 
[0m16:33:58.352108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:58.352587 [info ] [MainThread]: 
[0m16:33:58.353508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:58.355718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m16:33:58.356578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:58.843014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m16:33:58.843948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:59.291255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0941b0fe10>]}
[0m16:33:59.292270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:59.301967 [debug] [Thread-1 (]: Began running node model.glramira.mart_customer_metrics
[0m16:33:59.302973 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_customer_metrics ................ [RUN]
[0m16:33:59.303926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_customer_metrics)
[0m16:33:59.304517 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_customer_metrics
[0m16:33:59.317283 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_customer_metrics"
[0m16:33:59.318364 [debug] [Thread-1 (]: Began executing node model.glramira.mart_customer_metrics
[0m16:33:59.372114 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_customer_metrics"
[0m16:33:59.373391 [debug] [Thread-1 (]: On model.glramira.mart_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_customer_metrics"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_customer_metrics`
      
    
    

    
    OPTIONS()
    as (
      SELECT
    user_id,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(amount*price*exchange_rate) AS total_revenue,
    AVG(amount*price*exchange_rate) AS avg_order_value
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
GROUP BY 1
    );
  
[0m16:33:59.374125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:00.778149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:a2498ddd-c9a1-4af4-9e14-2d88633da0ee&page=queryresults
[0m16:34:06.537319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66cf260e-5060-446d-b091-394814535650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0941ede910>]}
[0m16:34:06.538534 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_glramira.mart_customer_metrics ........... [[32mCREATE TABLE (15.1k rows, 8.9 GiB processed)[0m in 7.23s]
[0m16:34:06.539560 [debug] [Thread-1 (]: Finished running node model.glramira.mart_customer_metrics
[0m16:34:06.542006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:06.544388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:06.545007 [debug] [MainThread]: Connection 'model.glramira.mart_customer_metrics' was properly closed.
[0m16:34:06.545553 [info ] [MainThread]: 
[0m16:34:06.546127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m16:34:06.547287 [debug] [MainThread]: Command end result
[0m16:34:06.606664 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:34:06.609572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:34:06.617548 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m16:34:06.618115 [info ] [MainThread]: 
[0m16:34:06.618887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:06.619433 [info ] [MainThread]: 
[0m16:34:06.620073 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:34:06.620935 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:34:06.623235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.400204, "process_in_blocks": "16176", "process_kernel_time": 1.443526, "process_mem_max_rss": "397768", "process_out_blocks": "3568", "process_user_time": 6.518782}
[0m16:34:06.624060 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:06.623854 after 13.40 seconds
[0m16:34:06.624648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09619b9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0965a141d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0965953010>]}
[0m16:34:06.625267 [debug] [MainThread]: Flushing usage events
[0m16:34:06.885034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:14.908385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2954e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a29540b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2954f850>]}


============================== 16:40:14.913010 | 21d7c3e2-b587-4315-8e65-be25bb17e33c ==============================
[0m16:40:14.913010 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:40:14.913978 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -m stg_dim_user', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m16:40:14.914642 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:40:14.915351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a294f1b50>]}
[0m16:40:18.410143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a09b94610>]}
[0m16:40:18.495942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2c0e0ed0>]}
[0m16:40:18.497179 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:40:18.766151 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:40:18.962210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:18.962882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:19.028968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a09a96a10>]}
[0m16:40:19.177646 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:40:19.180757 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:40:19.200312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a095c7250>]}
[0m16:40:19.201222 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m16:40:19.201908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a09687d90>]}
[0m16:40:19.204341 [info ] [MainThread]: 
[0m16:40:19.204931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:19.205447 [info ] [MainThread]: 
[0m16:40:19.206304 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:40:19.207862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m16:40:19.208677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:19.693880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m16:40:19.694744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:20.143213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2b91b6d0>]}
[0m16:40:20.144210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:20.152315 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m16:40:20.153304 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m16:40:20.154185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_user)
[0m16:40:20.154772 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m16:40:20.168070 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m16:40:20.169345 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m16:40:20.209644 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m16:40:20.211037 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as WITH user AS (
    SELECT DISTINCT
        farm_fingerprint(concat(
        coalesce(cast((email_address) as string), '')
    )) AS user_id,
        CAST(email_address AS STRING) AS email_address
    FROM `project-data-engineer-469310`.`product_info`.`event`
    WHERE email_address IS NOT NULL
)
SELECT * FROM user;


[0m16:40:20.211848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:21.478811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d983cd72-1125-4142-a7a2-4744e68a9add&page=queryresults
[0m16:40:22.280070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d7c3e2-b587-4315-8e65-be25bb17e33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0176ef10>]}
[0m16:40:22.281186 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m16:40:22.282155 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m16:40:22.284692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:22.286969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:22.287490 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m16:40:22.288029 [info ] [MainThread]: 
[0m16:40:22.288646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m16:40:22.289786 [debug] [MainThread]: Command end result
[0m16:40:22.348301 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:40:22.351265 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:40:22.359187 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m16:40:22.359826 [info ] [MainThread]: 
[0m16:40:22.360595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:22.361148 [info ] [MainThread]: 
[0m16:40:22.361749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:22.362647 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:40:22.364063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5323668, "process_in_blocks": "0", "process_kernel_time": 0.807012, "process_mem_max_rss": "397792", "process_out_blocks": "3568", "process_user_time": 6.570871}
[0m16:40:22.364722 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:22.364564 after 7.53 seconds
[0m16:40:22.365280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2969e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2d7ac390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2d831d90>]}
[0m16:40:22.365861 [debug] [MainThread]: Flushing usage events
[0m16:40:22.607157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:32.911296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dbc9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dd6e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dd6d750>]}


============================== 16:42:32.915691 | 1396f507-5fdb-4474-a409-d6d738a5ef1d ==============================
[0m16:42:32.915691 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:42:32.916581 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m stg_dim_user', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None'}
[0m16:42:32.917265 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:42:32.917935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dbfe190>]}
[0m16:42:36.417558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745e16eb90>]}
[0m16:42:36.505940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480759a50>]}
[0m16:42:36.507218 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:42:36.754830 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:42:36.938917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:36.939697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:37.004898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745e2a31d0>]}
[0m16:42:37.147074 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:42:37.150082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:42:37.169054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745df5d210>]}
[0m16:42:37.169927 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m16:42:37.170597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745dda0b50>]}
[0m16:42:37.172828 [info ] [MainThread]: 
[0m16:42:37.173415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:37.173926 [info ] [MainThread]: 
[0m16:42:37.174772 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:37.176909 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m16:42:37.177701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:37.663270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m16:42:37.664251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:38.115221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dbd24d0>]}
[0m16:42:38.116203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:38.123283 [debug] [Thread-1 (]: Began running node model.glramira.stg_dim_user
[0m16:42:38.124234 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_glramira.stg_dim_user .......................... [RUN]
[0m16:42:38.125080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.stg_dim_user)
[0m16:42:38.125675 [debug] [Thread-1 (]: Began compiling node model.glramira.stg_dim_user
[0m16:42:38.138685 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.stg_dim_user"
[0m16:42:38.139803 [debug] [Thread-1 (]: Began executing node model.glramira.stg_dim_user
[0m16:42:38.180346 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.stg_dim_user"
[0m16:42:38.181564 [debug] [Thread-1 (]: On model.glramira.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.stg_dim_user"} */


  create or replace view `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user`
  OPTIONS()
  as WITH user AS (
    SELECT DISTINCT
        farm_fingerprint(concat(
        coalesce(cast((email_address) as string), null)
    )) AS user_id,
        CAST(email_address AS STRING) AS email_address
    FROM `project-data-engineer-469310`.`product_info`.`event`
    WHERE email_address IS NOT NULL
)
SELECT * FROM user;


[0m16:42:38.182299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:39.067620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:aa79b13c-c9a5-4991-a944-07de8340b569&page=queryresults
[0m16:42:40.121529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1396f507-5fdb-4474-a409-d6d738a5ef1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745e2d6590>]}
[0m16:42:40.122717 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_glramira.stg_dim_user ..................... [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m16:42:40.123683 [debug] [Thread-1 (]: Finished running node model.glramira.stg_dim_user
[0m16:42:40.125879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:40.128140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:40.128728 [debug] [MainThread]: Connection 'model.glramira.stg_dim_user' was properly closed.
[0m16:42:40.129277 [info ] [MainThread]: 
[0m16:42:40.129819 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m16:42:40.131247 [debug] [MainThread]: Command end result
[0m16:42:40.197908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m16:42:40.202003 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m16:42:40.214257 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m16:42:40.215258 [info ] [MainThread]: 
[0m16:42:40.216314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:40.217026 [info ] [MainThread]: 
[0m16:42:40.217761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:42:40.218868 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:42:40.220823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3865743, "process_in_blocks": "0", "process_kernel_time": 0.935558, "process_mem_max_rss": "397592", "process_out_blocks": "3568", "process_user_time": 6.555769}
[0m16:42:40.221837 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:40.221604 after 7.39 seconds
[0m16:42:40.222636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dd6d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7481e0c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7481d4b190>]}
[0m16:42:40.223492 [debug] [MainThread]: Flushing usage events
[0m16:42:40.437653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:20.809590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b98514d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b97ee3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b9852dd0>]}


============================== 17:04:20.814215 | 8aff8b07-8526-457d-bd9e-63ca69733686 ==============================
[0m17:04:20.814215 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:04:20.815203 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run -m mart_customer_metrics', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt'}
[0m17:04:20.816003 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:04:20.816764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b9c9f710>]}
[0m17:04:24.325114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b98037d0>]}
[0m17:04:24.412356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0799ea2410>]}
[0m17:04:24.413440 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:04:24.662158 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:04:24.866389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:24.867085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:24.932752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0799a16b90>]}
[0m17:04:25.075684 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:04:25.088459 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:04:25.109033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07bbf80610>]}
[0m17:04:25.109917 [info ] [MainThread]: Found 8 models, 15 data tests, 4 sources, 762 macros
[0m17:04:25.110541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0799a16b10>]}
[0m17:04:25.112847 [info ] [MainThread]: 
[0m17:04:25.113426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:04:25.113928 [info ] [MainThread]: 
[0m17:04:25.114884 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:04:25.117065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:04:25.117884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:25.600712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:04:25.601678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:26.061176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0799bc2090>]}
[0m17:04:26.062071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:26.070866 [debug] [Thread-1 (]: Began running node model.glramira.mart_customer_metrics
[0m17:04:26.072217 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_customer_metrics ................ [RUN]
[0m17:04:26.073333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_customer_metrics)
[0m17:04:26.074144 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_customer_metrics
[0m17:04:26.093603 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_customer_metrics"
[0m17:04:26.095021 [debug] [Thread-1 (]: Began executing node model.glramira.mart_customer_metrics
[0m17:04:26.126734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:26.624569 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_customer_metrics"
[0m17:04:26.625857 [debug] [Thread-1 (]: On model.glramira.mart_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_customer_metrics"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_customer_metrics`
      
    
    

    
    OPTIONS()
    as (
      SELECT
    user_id,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(final_amount*exchange_rate) AS total_revenue,
    AVG(final_amount*exchange_rate) AS avg_order_value
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders`
GROUP BY 1
    );
  
[0m17:04:27.851144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:3b217ac0-7972-44ad-9cf0-a2de19121ea9&page=queryresults
[0m17:04:34.295429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aff8b07-8526-457d-bd9e-63ca69733686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0798461bd0>]}
[0m17:04:34.296685 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_glramira.mart_customer_metrics ........... [[32mCREATE TABLE (15.1k rows, 8.9 GiB processed)[0m in 8.22s]
[0m17:04:34.297725 [debug] [Thread-1 (]: Finished running node model.glramira.mart_customer_metrics
[0m17:04:34.300084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:34.302523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:34.303138 [debug] [MainThread]: Connection 'model.glramira.mart_customer_metrics' was properly closed.
[0m17:04:34.303772 [info ] [MainThread]: 
[0m17:04:34.304553 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m17:04:34.305789 [debug] [MainThread]: Command end result
[0m17:04:34.366484 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:04:34.369477 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:04:34.377397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:04:34.378132 [info ] [MainThread]: 
[0m17:04:34.378891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:34.379484 [info ] [MainThread]: 
[0m17:04:34.380107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:04:34.380994 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:04:34.382523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.667694, "process_in_blocks": "152", "process_kernel_time": 0.783005, "process_mem_max_rss": "398256", "process_out_blocks": "3576", "process_user_time": 6.674734}
[0m17:04:34.383208 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:34.383039 after 13.67 seconds
[0m17:04:34.383881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b97ee590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b99a21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07bda26f90>]}
[0m17:04:34.384532 [debug] [MainThread]: Flushing usage events
[0m17:04:34.606919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:02.421220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a799f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7f338d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a799cb50>]}


============================== 17:13:02.425678 | 233d3ed8-6000-4411-89e1-50d881d52689 ==============================
[0m17:13:02.425678 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:02.426570 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/home/quakinh943/.dbt', 'write_json': 'True', 'invocation_command': 'dbt run -m mart_revenue', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m17:13:02.427262 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:13:02.427900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '233d3ed8-6000-4411-89e1-50d881d52689', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a79d27d0>]}
[0m17:13:05.948863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233d3ed8-6000-4411-89e1-50d881d52689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7f42c90>]}
[0m17:13:06.035295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233d3ed8-6000-4411-89e1-50d881d52689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71aa5bd390>]}
[0m17:13:06.036482 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:13:06.281385 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:13:06.472302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:13:06.473341 [debug] [MainThread]: Partial parsing: added file: glramira://models/marts/mart_user_activity.sql
[0m17:13:06.473963 [debug] [MainThread]: Partial parsing: added file: glramira://models/marts/mart_revenue.sql
[0m17:13:06.741896 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.glramira.mart_user_activity' (models/marts/mart_user_activity.sql) depends on a node named 'dim_user' which was not found
[0m17:13:06.743014 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:13:06.744505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4009576, "process_in_blocks": "0", "process_kernel_time": 0.812206, "process_mem_max_rss": "390800", "process_out_blocks": "16", "process_user_time": 5.946119}
[0m17:13:06.745555 [debug] [MainThread]: Command `dbt run` failed at 17:13:06.745376 after 4.40 seconds
[0m17:13:06.746192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7a0b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71880ddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718792bc50>]}
[0m17:13:06.746829 [debug] [MainThread]: Flushing usage events
[0m17:13:06.966274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:57.303122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747b106fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747b2b99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747b2b9a10>]}


============================== 17:14:57.307303 | 63c0005a-c05c-4ba4-96f9-40f6cadbd3ca ==============================
[0m17:14:57.307303 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:57.308249 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m mart_revenue', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'use_colors': 'True'}
[0m17:14:57.308906 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:14:57.309590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747b2ba1d0>]}
[0m17:15:00.940952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b8ddcd0>]}
[0m17:15:01.032040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747dd29610>]}
[0m17:15:01.033216 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:15:01.311596 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:15:01.525097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:01.525795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:01.592018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b429fd0>]}
[0m17:15:01.745866 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:15:01.749528 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:15:01.769147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b3ec710>]}
[0m17:15:01.770018 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:15:01.770605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b5f1190>]}
[0m17:15:01.772840 [info ] [MainThread]: 
[0m17:15:01.773383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:01.773852 [info ] [MainThread]: 
[0m17:15:01.774702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:15:01.776781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:15:01.777574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:02.292848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:15:02.293688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:02.768343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b3ec9d0>]}
[0m17:15:02.769179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:02.776604 [debug] [Thread-1 (]: Began running node model.glramira.mart_revenue
[0m17:15:02.777596 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_revenue ......................... [RUN]
[0m17:15:02.778518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_revenue)
[0m17:15:02.779114 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_revenue
[0m17:15:02.792422 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_revenue"
[0m17:15:02.842696 [debug] [Thread-1 (]: Began executing node model.glramira.mart_revenue
[0m17:15:02.896283 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_revenue"
[0m17:15:02.897483 [debug] [Thread-1 (]: On model.glramira.mart_revenue: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_revenue"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_revenue`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
  date_id,
  product_name,
  country,
  SUM(final_amount * exchange_rate) AS total_revenue,
  COUNT(DISTINCT order_id) AS total_orders
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product` a2
ON a1.product_id = a2.product_id
GROUP BY 1,2,3
    );
  
[0m17:15:02.898184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:04.283712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fc58ca86-de0b-478a-ad20-05ce0ab5ca0b&page=queryresults
[0m17:15:04.568036 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:fc58ca86-de0b-478a-ad20-05ce0ab5ca0b&page=queryresults
[0m17:15:04.577548 [debug] [Thread-1 (]: Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Unrecognized name: country at [17:3]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql
[0m17:15:04.579986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c0005a-c05c-4ba4-96f9-40f6cadbd3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b5cfb50>]}
[0m17:15:04.581114 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_revenue ................ [[31mERROR[0m in 1.80s]
[0m17:15:04.582092 [debug] [Thread-1 (]: Finished running node model.glramira.mart_revenue
[0m17:15:04.582913 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_revenue' to be skipped because of status 'error'.  Reason: Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Unrecognized name: country at [17:3]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql.
[0m17:15:04.585806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:04.588305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:04.589044 [debug] [MainThread]: Connection 'model.glramira.mart_revenue' was properly closed.
[0m17:15:04.589645 [info ] [MainThread]: 
[0m17:15:04.590232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m17:15:04.591348 [debug] [MainThread]: Command end result
[0m17:15:04.653221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:15:04.656082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:15:04.664284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:15:04.664948 [info ] [MainThread]: 
[0m17:15:04.665687 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:15:04.666298 [info ] [MainThread]: 
[0m17:15:04.667028 [error] [MainThread]: [31mFailure in model mart_revenue (models/marts/mart_revenue.sql)[0m
[0m17:15:04.667724 [error] [MainThread]:   Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Unrecognized name: country at [17:3]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql
[0m17:15:04.668263 [info ] [MainThread]: 
[0m17:15:04.669018 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_revenue.sql
[0m17:15:04.669558 [info ] [MainThread]: 
[0m17:15:04.670177 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:15:04.671159 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:15:04.672736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.444546, "process_in_blocks": "8", "process_kernel_time": 1.101685, "process_mem_max_rss": "393684", "process_out_blocks": "3592", "process_user_time": 6.536214}
[0m17:15:04.673468 [debug] [MainThread]: Command `dbt run` failed at 17:15:04.673316 after 7.45 seconds
[0m17:15:04.674076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747f3272d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747f327250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f747b10fe50>]}
[0m17:15:04.674683 [debug] [MainThread]: Flushing usage events
[0m17:15:04.891089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:00.270123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5ab6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5aae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5a98d0>]}


============================== 17:16:00.274469 | ce38e514-0949-4e39-a994-1feb6c0f8ba3 ==============================
[0m17:16:00.274469 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:16:00.275397 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -m mart_revenue', 'profiles_dir': '/home/quakinh943/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m17:16:00.276070 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:16:00.276724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5e5150>]}
[0m17:16:03.736786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbb25490>]}
[0m17:16:03.822792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1e1dc990>]}
[0m17:16:03.823896 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:16:04.075057 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:16:04.261333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:04.262066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:04.327102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbc21c90>]}
[0m17:16:04.471530 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:16:04.474401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:16:04.493489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1c566690>]}
[0m17:16:04.494369 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:16:04.495048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbcd7e10>]}
[0m17:16:04.497329 [info ] [MainThread]: 
[0m17:16:04.497932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:16:04.498492 [info ] [MainThread]: 
[0m17:16:04.499400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:04.501586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:16:04.502588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:05.008385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310_dbt_glramira'
[0m17:16:05.009612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:05.588466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1d2fc210>]}
[0m17:16:05.589500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:05.597349 [debug] [Thread-1 (]: Began running node model.glramira.mart_revenue
[0m17:16:05.598421 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_revenue ......................... [RUN]
[0m17:16:05.599354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_revenue)
[0m17:16:05.600031 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_revenue
[0m17:16:05.613667 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_revenue"
[0m17:16:05.614832 [debug] [Thread-1 (]: Began executing node model.glramira.mart_revenue
[0m17:16:05.668884 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_revenue"
[0m17:16:05.670478 [debug] [Thread-1 (]: On model.glramira.mart_revenue: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_revenue"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_revenue`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
  date_id,
  product_name,
  country,
  SUM(final_amount * exchange_rate) AS total_revenue,
  COUNT(DISTINCT order_id) AS total_orders
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product` a2
  ON a1.product_id = a2.product_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location` a3
  ON a1.location_id = a3.location_id
GROUP BY 1,2,3
    );
  
[0m17:16:05.671261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:07.069302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:e1d908c1-8c44-4c9f-99b0-b20d68180a70&page=queryresults
[0m17:16:12.994524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce38e514-0949-4e39-a994-1feb6c0f8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbb98a90>]}
[0m17:16:12.995751 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_glramira.mart_revenue .................... [[32mCREATE TABLE (22.8k rows, 8.9 GiB processed)[0m in 7.39s]
[0m17:16:12.996748 [debug] [Thread-1 (]: Finished running node model.glramira.mart_revenue
[0m17:16:12.999419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:13.001971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:13.002549 [debug] [MainThread]: Connection 'list_project-data-engineer-469310' was properly closed.
[0m17:16:13.003231 [debug] [MainThread]: Connection 'model.glramira.mart_revenue' was properly closed.
[0m17:16:13.003866 [info ] [MainThread]: 
[0m17:16:13.004577 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.50 seconds (8.50s).
[0m17:16:13.005622 [debug] [MainThread]: Command end result
[0m17:16:13.066866 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:16:13.069864 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:16:13.077939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:16:13.078541 [info ] [MainThread]: 
[0m17:16:13.079334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:13.079908 [info ] [MainThread]: 
[0m17:16:13.080567 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:16:13.081461 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:16:13.082910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.887344, "process_in_blocks": "0", "process_kernel_time": 0.761717, "process_mem_max_rss": "398124", "process_out_blocks": "3592", "process_user_time": 6.696916}
[0m17:16:13.083664 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:13.083499 after 12.89 seconds
[0m17:16:13.084260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5e4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b6d4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f7b7250>]}
[0m17:16:13.084955 [debug] [MainThread]: Flushing usage events
[0m17:16:13.303018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:07.745607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd4936d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd48067d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd49b6290>]}


============================== 17:17:07.750001 | 7a1bd5de-df85-4b1d-a4bf-b27ace85222f ==============================
[0m17:17:07.750001 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:17:07.750953 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -m mart_revenue', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'False'}
[0m17:17:07.751626 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:17:07.752319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd49b6450>]}
[0m17:17:11.177451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4d21b50>]}
[0m17:17:11.267747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd73f1450>]}
[0m17:17:11.268845 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:17:11.521507 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:17:11.740667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:11.741345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:11.806502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb47dcb90>]}
[0m17:17:11.960421 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:17:11.963480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:17:11.984137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4d7ae10>]}
[0m17:17:11.985055 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:17:11.985703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4b89490>]}
[0m17:17:11.988150 [info ] [MainThread]: 
[0m17:17:11.988735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:11.989312 [info ] [MainThread]: 
[0m17:17:11.990192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:11.991759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:17:11.992528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:12.466122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:17:12.467021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:12.907392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb49dda90>]}
[0m17:17:12.908318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:12.914664 [debug] [Thread-1 (]: Began running node model.glramira.mart_revenue
[0m17:17:12.915753 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_revenue ......................... [RUN]
[0m17:17:12.916604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_revenue)
[0m17:17:12.917216 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_revenue
[0m17:17:12.930517 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_revenue"
[0m17:17:12.931640 [debug] [Thread-1 (]: Began executing node model.glramira.mart_revenue
[0m17:17:12.951415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:13.425260 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_revenue"
[0m17:17:13.426580 [debug] [Thread-1 (]: On model.glramira.mart_revenue: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_revenue"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_revenue`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
  a2.product_name,
  a3.country,
  SUM(a1.final_amount * a1.exchange_rate) AS total_revenue,
  COUNT(DISTINCT a1.order_id) AS total_orders
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product` a2
  ON a1.product_id = a2.product_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location` a3
  ON a1.location_id = a3.location_id
GROUP BY 1,2,3
    );
  
[0m17:17:14.480214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1199594f-82c3-4600-89cd-59064da4e6b2&page=queryresults
[0m17:17:14.755011 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:1199594f-82c3-4600-89cd-59064da4e6b2&page=queryresults
[0m17:17:14.764803 [debug] [Thread-1 (]: Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Column 3 contains an aggregation function, which is not allowed in GROUP BY at [24:14]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql
[0m17:17:14.767292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a1bd5de-df85-4b1d-a4bf-b27ace85222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4b83b50>]}
[0m17:17:14.768403 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_revenue ................ [[31mERROR[0m in 1.85s]
[0m17:17:14.769388 [debug] [Thread-1 (]: Finished running node model.glramira.mart_revenue
[0m17:17:14.770221 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_revenue' to be skipped because of status 'error'.  Reason: Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Column 3 contains an aggregation function, which is not allowed in GROUP BY at [24:14]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql.
[0m17:17:14.773340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:14.775845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:14.776616 [debug] [MainThread]: Connection 'model.glramira.mart_revenue' was properly closed.
[0m17:17:14.777158 [info ] [MainThread]: 
[0m17:17:14.777697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m17:17:14.778725 [debug] [MainThread]: Command end result
[0m17:17:14.841280 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:17:14.844126 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:17:14.852322 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:17:14.852945 [info ] [MainThread]: 
[0m17:17:14.853630 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:14.854208 [info ] [MainThread]: 
[0m17:17:14.855011 [error] [MainThread]: [31mFailure in model mart_revenue (models/marts/mart_revenue.sql)[0m
[0m17:17:14.855680 [error] [MainThread]:   Database Error in model mart_revenue (models/marts/mart_revenue.sql)
  Column 3 contains an aggregation function, which is not allowed in GROUP BY at [24:14]
  compiled code at target/run/glramira/models/marts/mart_revenue.sql
[0m17:17:14.856160 [info ] [MainThread]: 
[0m17:17:14.856766 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_revenue.sql
[0m17:17:14.857271 [info ] [MainThread]: 
[0m17:17:14.857842 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:17:14.858663 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:17:14.860360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.190229, "process_in_blocks": "0", "process_kernel_time": 0.810437, "process_mem_max_rss": "393620", "process_out_blocks": "3600", "process_user_time": 6.397729}
[0m17:17:14.861090 [debug] [MainThread]: Command `dbt run` failed at 17:17:14.860901 after 7.19 seconds
[0m17:17:14.861852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd4807490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4d36490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd89d3190>]}
[0m17:17:14.862444 [debug] [MainThread]: Flushing usage events
[0m17:17:15.110955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:38.722699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da18e2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da18e32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da18e2d50>]}


============================== 17:18:38.727293 | 42e63303-328b-45b1-8b8a-760cb46fc668 ==============================
[0m17:18:38.727293 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:18:38.728288 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run -m mart_revenue', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/home/quakinh943/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'cache_selected_only': 'False'}
[0m17:18:38.728896 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:18:38.729595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da19164d0>]}
[0m17:18:42.142999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d821b9c10>]}
[0m17:18:42.228702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da45596d0>]}
[0m17:18:42.229832 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:18:42.477074 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:18:42.721322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:42.722245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:42.815188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d81d25450>]}
[0m17:18:42.966606 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:18:42.969760 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:18:42.989695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da18f8250>]}
[0m17:18:42.990618 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:18:42.991228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d81b6f650>]}
[0m17:18:42.993593 [info ] [MainThread]: 
[0m17:18:42.994167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:42.994685 [info ] [MainThread]: 
[0m17:18:42.995611 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:18:42.997735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:18:42.998575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:43.481445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:18:43.482490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:43.958434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da18e9e10>]}
[0m17:18:43.959347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:43.966698 [debug] [Thread-1 (]: Began running node model.glramira.mart_revenue
[0m17:18:43.967713 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_revenue ......................... [RUN]
[0m17:18:43.968597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_revenue)
[0m17:18:43.969303 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_revenue
[0m17:18:43.982680 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_revenue"
[0m17:18:43.983943 [debug] [Thread-1 (]: Began executing node model.glramira.mart_revenue
[0m17:18:44.003921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:44.485454 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_revenue"
[0m17:18:44.486729 [debug] [Thread-1 (]: On model.glramira.mart_revenue: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_revenue"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_revenue`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
  a2.product_name,
  a3.country,
  SUM(a1.final_amount * a1.exchange_rate) AS total_revenue,
  COUNT(DISTINCT a1.order_id) AS total_orders
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_product` a2
  ON a1.product_id = a2.product_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_location` a3
  ON a1.location_id = a3.location_id
GROUP BY 1,2
    );
  
[0m17:18:46.101951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:0831625b-6901-4be9-862f-3b6f3efd9ade&page=queryresults
[0m17:18:51.006631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42e63303-328b-45b1-8b8a-760cb46fc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d820a2650>]}
[0m17:18:51.007936 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_glramira.mart_revenue .................... [[32mCREATE TABLE (7.5k rows, 8.9 GiB processed)[0m in 7.04s]
[0m17:18:51.008922 [debug] [Thread-1 (]: Finished running node model.glramira.mart_revenue
[0m17:18:51.011627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:51.013939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:51.014553 [debug] [MainThread]: Connection 'model.glramira.mart_revenue' was properly closed.
[0m17:18:51.015128 [info ] [MainThread]: 
[0m17:18:51.015833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m17:18:51.016918 [debug] [MainThread]: Command end result
[0m17:18:51.079074 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:18:51.082739 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:18:51.093551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:18:51.094183 [info ] [MainThread]: 
[0m17:18:51.094890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:51.095442 [info ] [MainThread]: 
[0m17:18:51.096047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:18:51.096951 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:18:51.098429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.450387, "process_in_blocks": "0", "process_kernel_time": 0.873225, "process_mem_max_rss": "398032", "process_out_blocks": "3592", "process_user_time": 6.613672}
[0m17:18:51.099179 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:51.098973 after 12.45 seconds
[0m17:18:51.099800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da1a89d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da5c2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da5b6f250>]}
[0m17:18:51.100413 [debug] [MainThread]: Flushing usage events
[0m17:18:51.351489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:54.501043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6cdb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6e81bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6cdb310>]}


============================== 17:22:54.505460 | de9ac4c9-9f99-4c2e-a205-c06a180ac0e1 ==============================
[0m17:22:54.505460 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:22:54.506362 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'invocation_command': 'dbt run -m mart_user_activity', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m17:22:54.507085 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:22:54.507763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6dfc790>]}
[0m17:22:57.999699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea74f8810>]}
[0m17:22:58.084819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6cf11d0>]}
[0m17:22:58.085966 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:22:58.332145 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:22:58.521075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:58.521844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:58.587419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea709fb10>]}
[0m17:22:58.730512 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:22:58.733386 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:22:58.752402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec92aaad0>]}
[0m17:22:58.753251 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:22:58.753847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6d90ed0>]}
[0m17:22:58.756067 [info ] [MainThread]: 
[0m17:22:58.756635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:58.757142 [info ] [MainThread]: 
[0m17:22:58.757969 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:58.759444 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:22:58.760250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:59.254320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:22:59.255206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:59.700929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6dc6d50>]}
[0m17:22:59.701832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:59.709268 [debug] [Thread-1 (]: Began running node model.glramira.mart_user_activity
[0m17:22:59.710225 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_user_activity ................... [RUN]
[0m17:22:59.711115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_user_activity)
[0m17:22:59.711770 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_user_activity
[0m17:22:59.725651 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_user_activity"
[0m17:22:59.726687 [debug] [Thread-1 (]: Began executing node model.glramira.mart_user_activity
[0m17:22:59.781110 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_user_activity"
[0m17:22:59.782640 [debug] [Thread-1 (]: On model.glramira.mart_user_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_user_activity"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_user_activity`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
       a2.user_id,
       a2.email_address,
       a3.full_date,
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user` a2
  ON a1.user_id = a2.user_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date` a3
  ON a1.date_id = a3.date_id
GROUP BY 1,2
    );
  
[0m17:22:59.783587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:01.351835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:30163469-c846-4408-a9fe-a789328e793d&page=queryresults
[0m17:23:01.629835 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:30163469-c846-4408-a9fe-a789328e793d&page=queryresults
[0m17:23:01.639438 [debug] [Thread-1 (]: Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql
[0m17:23:01.641850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9ac4c9-9f99-4c2e-a205-c06a180ac0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6c69ed0>]}
[0m17:23:01.642920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_user_activity .......... [[31mERROR[0m in 1.93s]
[0m17:23:01.643919 [debug] [Thread-1 (]: Finished running node model.glramira.mart_user_activity
[0m17:23:01.644727 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_user_activity' to be skipped because of status 'error'.  Reason: Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql.
[0m17:23:01.647755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:01.650062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:01.650708 [debug] [MainThread]: Connection 'model.glramira.mart_user_activity' was properly closed.
[0m17:23:01.651289 [info ] [MainThread]: 
[0m17:23:01.651876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m17:23:01.652838 [debug] [MainThread]: Command end result
[0m17:23:01.715873 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:23:01.718880 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:23:01.727461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:23:01.728086 [info ] [MainThread]: 
[0m17:23:01.728816 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:23:01.729658 [info ] [MainThread]: 
[0m17:23:01.730442 [error] [MainThread]: [31mFailure in model mart_user_activity (models/marts/mart_user_activity.sql)[0m
[0m17:23:01.731167 [error] [MainThread]:   Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql
[0m17:23:01.731704 [info ] [MainThread]: 
[0m17:23:01.732313 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_user_activity.sql
[0m17:23:01.732788 [info ] [MainThread]: 
[0m17:23:01.733348 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:23:01.734222 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:23:01.735667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3089247, "process_in_blocks": "0", "process_kernel_time": 0.856378, "process_mem_max_rss": "393892", "process_out_blocks": "3608", "process_user_time": 6.429883}
[0m17:23:01.736457 [debug] [MainThread]: Command `dbt run` failed at 17:23:01.736270 after 7.31 seconds
[0m17:23:01.737281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6d35dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6d36d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ecae86f90>]}
[0m17:23:01.737890 [debug] [MainThread]: Flushing usage events
[0m17:23:01.983277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:59.234857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11cdab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11cd1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11cda3d0>]}


============================== 17:23:59.239589 | 5fe4bf37-ed5c-46b0-ae93-37ed06d40407 ==============================
[0m17:23:59.239589 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:23:59.240498 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/quakinh943/.dbt', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run -m mart_user_activity'}
[0m17:23:59.241196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:23:59.241857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11e86450>]}
[0m17:24:02.699601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11cf3fd0>]}
[0m17:24:02.785306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f14855350>]}
[0m17:24:02.786376 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:24:03.031005 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:24:03.219702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:03.220358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:03.283886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef1f37c10>]}
[0m17:24:03.431898 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:24:03.434822 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:24:03.454361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef214a690>]}
[0m17:24:03.455284 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:24:03.455961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef1d818d0>]}
[0m17:24:03.458330 [info ] [MainThread]: 
[0m17:24:03.458919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:03.459503 [info ] [MainThread]: 
[0m17:24:03.460365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:03.462571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:24:03.463429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:03.935894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:24:03.936818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:04.387943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef214ac90>]}
[0m17:24:04.388836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:04.396965 [debug] [Thread-1 (]: Began running node model.glramira.mart_user_activity
[0m17:24:04.397964 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_user_activity ................... [RUN]
[0m17:24:04.398881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_user_activity)
[0m17:24:04.399475 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_user_activity
[0m17:24:04.412716 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_user_activity"
[0m17:24:04.413780 [debug] [Thread-1 (]: Began executing node model.glramira.mart_user_activity
[0m17:24:04.466236 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_user_activity"
[0m17:24:04.467578 [debug] [Thread-1 (]: On model.glramira.mart_user_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_user_activity"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_user_activity`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
       a2.user_id,
       a2.email_address,
       a3.full_date
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user` a2
  ON a1.user_id = a2.user_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date` a3
  ON a1.date_id = a3.date_id
GROUP BY 1,2
    );
  
[0m17:24:04.468589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:05.856923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d1d50bfa-4f3f-49fb-a28d-9386f370a0dd&page=queryresults
[0m17:24:06.134702 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:d1d50bfa-4f3f-49fb-a28d-9386f370a0dd&page=queryresults
[0m17:24:06.144279 [debug] [Thread-1 (]: Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql
[0m17:24:06.146583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe4bf37-ed5c-46b0-ae93-37ed06d40407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef1a0bf90>]}
[0m17:24:06.147698 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_glramira.mart_user_activity .......... [[31mERROR[0m in 1.75s]
[0m17:24:06.148593 [debug] [Thread-1 (]: Finished running node model.glramira.mart_user_activity
[0m17:24:06.149500 [debug] [Thread-7 (]: Marking all children of 'model.glramira.mart_user_activity' to be skipped because of status 'error'.  Reason: Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql.
[0m17:24:06.152478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:06.154785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:06.155410 [debug] [MainThread]: Connection 'model.glramira.mart_user_activity' was properly closed.
[0m17:24:06.155960 [info ] [MainThread]: 
[0m17:24:06.156502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m17:24:06.157523 [debug] [MainThread]: Command end result
[0m17:24:06.219845 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:24:06.222703 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:24:06.231535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:24:06.232326 [info ] [MainThread]: 
[0m17:24:06.233094 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:24:06.233663 [info ] [MainThread]: 
[0m17:24:06.234336 [error] [MainThread]: [31mFailure in model mart_user_activity (models/marts/mart_user_activity.sql)[0m
[0m17:24:06.234934 [error] [MainThread]:   Database Error in model mart_user_activity (models/marts/mart_user_activity.sql)
  SELECT list expression references a3.full_date which is neither grouped nor aggregated at [17:8]
  compiled code at target/run/glramira/models/marts/mart_user_activity.sql
[0m17:24:06.235497 [info ] [MainThread]: 
[0m17:24:06.236113 [info ] [MainThread]:   compiled code at target/compiled/glramira/models/marts/mart_user_activity.sql
[0m17:24:06.236626 [info ] [MainThread]: 
[0m17:24:06.237182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:24:06.238100 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:24:06.239626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0793, "process_in_blocks": "0", "process_kernel_time": 0.891508, "process_mem_max_rss": "393964", "process_out_blocks": "3608", "process_user_time": 6.368597}
[0m17:24:06.240448 [debug] [MainThread]: Command `dbt run` failed at 17:24:06.240265 after 7.08 seconds
[0m17:24:06.241071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f15e9b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11d47350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f15fe4e50>]}
[0m17:24:06.241637 [debug] [MainThread]: Flushing usage events
[0m17:24:06.462797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:22.262110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed307050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed306810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed306cd0>]}


============================== 17:24:22.267129 | bcce2873-acf4-4e09-ae42-f868bfc9c8a4 ==============================
[0m17:24:22.267129 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:22.268401 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/home/quakinh943/.dbt', 'empty': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/quakinh943/dbt_glamira_prod/glramira/logs', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_user_activity', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m17:24:22.269707 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:24:22.270636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed163110>]}
[0m17:24:25.715278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ee2b4490>]}
[0m17:24:25.805316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9eff21dd0>]}
[0m17:24:25.806465 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:24:26.089175 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:24:26.300582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:26.301275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:26.365821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd790b10>]}
[0m17:24:26.520514 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:24:26.523423 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:24:26.543252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd7699d0>]}
[0m17:24:26.544122 [info ] [MainThread]: Found 10 models, 15 data tests, 4 sources, 762 macros
[0m17:24:26.544709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd362710>]}
[0m17:24:26.547204 [info ] [MainThread]: 
[0m17:24:26.547776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:26.548299 [info ] [MainThread]: 
[0m17:24:26.549437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:26.551533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_project-data-engineer-469310'
[0m17:24:26.552322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:27.032152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310, now list_project-data-engineer-469310_dbt_glramira)
[0m17:24:27.033094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:27.461643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed1dc6d0>]}
[0m17:24:27.462543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:27.471505 [debug] [Thread-1 (]: Began running node model.glramira.mart_user_activity
[0m17:24:27.472940 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_glramira.mart_user_activity ................... [RUN]
[0m17:24:27.474322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_project-data-engineer-469310_dbt_glramira, now model.glramira.mart_user_activity)
[0m17:24:27.475230 [debug] [Thread-1 (]: Began compiling node model.glramira.mart_user_activity
[0m17:24:27.491704 [debug] [Thread-1 (]: Writing injected SQL for node "model.glramira.mart_user_activity"
[0m17:24:27.492859 [debug] [Thread-1 (]: Began executing node model.glramira.mart_user_activity
[0m17:24:27.555183 [debug] [Thread-1 (]: Writing runtime sql for node "model.glramira.mart_user_activity"
[0m17:24:27.556520 [debug] [Thread-1 (]: On model.glramira.mart_user_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "glramira", "target_name": "dev", "node_id": "model.glramira.mart_user_activity"} */

  
    

    create or replace table `project-data-engineer-469310`.`dbt_glramira`.`mart_user_activity`
      
    
    

    
    OPTIONS()
    as (
      SELECT 
       a2.user_id,
       a2.email_address,
       a3.full_date
FROM `project-data-engineer-469310`.`dbt_glramira`.`stg_fact_orders` a1
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_user` a2
  ON a1.user_id = a2.user_id
LEFT JOIN `project-data-engineer-469310`.`dbt_glramira`.`stg_dim_date` a3
  ON a1.date_id = a3.date_id
    );
  
[0m17:24:27.557289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:28.756865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=project-data-engineer-469310&j=bq:africa-south1:00e86b1d-19c4-4182-a374-129ccc7d8fd1&page=queryresults
[0m17:24:34.130887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcce2873-acf4-4e09-ae42-f868bfc9c8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cdaca310>]}
[0m17:24:34.132090 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_glramira.mart_user_activity .............. [[32mCREATE TABLE (34.9k rows, 8.9 GiB processed)[0m in 6.65s]
[0m17:24:34.133130 [debug] [Thread-1 (]: Finished running node model.glramira.mart_user_activity
[0m17:24:34.135554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:34.137838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:34.138443 [debug] [MainThread]: Connection 'model.glramira.mart_user_activity' was properly closed.
[0m17:24:34.138975 [info ] [MainThread]: 
[0m17:24:34.139585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m17:24:34.140732 [debug] [MainThread]: Command end result
[0m17:24:34.198941 [debug] [MainThread]: Wrote artifact WritableManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/manifest.json
[0m17:24:34.201832 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/quakinh943/dbt_glamira_prod/glramira/target/semantic_manifest.json
[0m17:24:34.209588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/quakinh943/dbt_glamira_prod/glramira/target/run_results.json
[0m17:24:34.210155 [info ] [MainThread]: 
[0m17:24:34.210969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:34.211537 [info ] [MainThread]: 
[0m17:24:34.212113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:24:34.212955 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:24:34.214328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.026114, "process_in_blocks": "0", "process_kernel_time": 1.016145, "process_mem_max_rss": "397800", "process_out_blocks": "3600", "process_user_time": 6.414346}
[0m17:24:34.214981 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:34.214823 after 12.03 seconds
[0m17:24:34.215563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed1627d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ed30f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd93fed0>]}
[0m17:24:34.216107 [debug] [MainThread]: Flushing usage events
[0m17:24:34.410750 [debug] [MainThread]: An error was encountered while trying to flush usage events
